Opera Preferences version 2.1
; Do not edit this file while Opera is running
; This file is stored in UTF-8 encoding

[Version]
File Version=2

[Info]
Name=SimpleU+ Menu
Description=Opera SimpleU Standard Menu Setup
Author=KwokTree
Version=1

;--------------------官方菜单精简
;--------------------拼写菜单隐藏
[Document Popup Menu Spellcheck Disabled]
Include, Document Popup Menu
;Item, M_INTERNAL_SPELLCHECK_ENABLE=Spell check | Spell check

[Document Popup Menu Spellcheck Enabled]
Include, Document Popup Menu Spellcheck Disabled
;Submenu, M_INTERNAL_SPELLCHECK_LANGUAGE, Spellcheck Language

[Spellcheck Language]
;Include, Internal Spellcheck Language

[Edit Widget Popup Menu Spellcheck Enabled]
Include, Edit Widget Popup Menu
;Submenu, M_INTERNAL_SPELLCHECK_LANGUAGE, Spellcheck Language

[Gadget Edit Widget Popup Menu Spellcheck Enabled]
Include, Gadget Edit Widget Popup Menu
;Submenu, M_INTERNAL_SPELLCHECK_LANGUAGE, Spellcheck Language

;--------------------官方菜单完善

[Toolbar Popup Menu]
;工具栏右键菜单
Item, "删除"=Remove
Item, "外观"= Customize toolbars, -2
Item, "选项"= Show preferences
Item, "默认"= Restore to defaults, "selected toolbar"

[Browser Bookmarks Menu]
;书签菜单
Item, M_DOCUMENT_POPUP_MENU_BOOKMARK_PAGE= Add to bookmarks, 1
;Item, 添加全部到收藏="Add all to bookmarks,,,, "Panel bookmarks""
Item, 添加全部到收藏夹=Focus panel, "bookmarks",,, "Save" & Delay, 50 & View style, 0 & Focus previous widget & Focus previous widget & Activate hotlist window & Focus next widget & Clear & Insert, "Sessions" & Go & Clear & Focus next widget & New folder & Add all to bookmarks & Edit properties
Item, "显示/隐藏个人栏"="Set alignment, "Personalbar Inline", 6,,"view" | Set alignment, "Personalbar Inline", 0,,"view""
Item, SI_IDSTR_HL_SHOW_BOOKMARKS		= Manage bookmarks, "bookmarks",,,"Panel Bookmarks"
--------------------1
Include, Internal Bookmark Folder, 1

[Links Manager Open Menu]
;右键新建窗口菜单完善
Item, MI_IDM_MENU_PAGEBAR_LINK_IN_NEW_PAGE		= Open link in new page
Item, MI_IDM_MENU_PAGEBAR_LINK_IN_BG_PAGE		= Open link in background page
--------------------1
Item, MI_IDM_HLITEM_GET_IN_NEW_WINDOW		= Open link in new window
Item, M_OPEN_BACKGROUND_WINDOW		= Open link in background window
--------------------2
Include, Browser Session Menu, 1

[Speed Dial Popup Menu Plus]
;完善快速拨号右键菜单
Item, "锁定快速拨号" =Set preference, "user prefs|Speed Dial State=2" | Set preference, "user prefs|Speed Dial State=1"
--------------------0
Item, M_SPEEDDIAL_ADD_SPEEDDIAL=Configure thumbnail, 0
Item, M_SPEEDDIAL_GLOBAL_CONFIGURATION = Show speed dial global config
--------------------1
Item, M_BROWSER_TOOLS_MENU_APPEARANCE			= Customize toolbars, -1

[Speed Dial Popup Menu]
;完善快速拨号右键菜单
Include,Speed Dial Popup Menu Plus

[Delete Mail Menu]
;删除邮件菜单
Item, M_MAIL_REMOVE_FROM_VIEW				= Remove from view
Item, M_MAIL_MOVE_TO_TRASH				= Delete mail,,,,"Move to trash" | Undelete,,,DI_IDSTR_M2_MAILVIEWTOOLBAR_UNDELETE
Item, M_MAIL_DELETE_PERMANENTLY				= Delete permanently,,,,"Delete"
Item, "全部清空(&A)"=External action,,,,"none" | Focus Page & Focus address field & Select all & Delete

[Document Popup Menu]
;网页右键菜单:右键点击页面空白处的弹出菜单
Item, MI_IDM_Reload_PM,	= Reload
;Submenu, MI_IDM_AUTORELOAD_TOGGLE_PARENT, Full Reload Menu
Submenu, M_BROWSER_MENU_BAR_BOOKMARKS, Browser Bookmarks Menu, , "Menu Bookmarks"
--------------------1
Item,"清除Fixed定位"=Go to page, "javascript:(function(){var oAll=document.all,oElement,i=0,oCurrentStyle,oStyle;while(oElement=oAll[i++]){oCurrentStyle=oElement.currentStyle;oStyle=oElement.style;if(oCurrentStyle.position==='fixed'){oStyle.position='static'};if(oCurrentStyle.backgroundAttachment==='fixed'){oStyle.backgroundAttachment='scroll'}}})();",,,"Enable Mediumscreen Mode"
Item, "复制标题和网址" = External action,,,, "Mail Compose Outdent" | Go to page,"javascript:void prompt('',document.title + '\n' + location.href);" & Delay, 100 & Copy & Cancel
Item, "翻译工具栏"= Go to page, "javascript:{d=document;b=d.body;o=d.createElement('script');o.setAttribute('src','http://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit');o.setAttribute('type','text/javascript');b.appendChild(o);v=b.insertBefore(d.createElement('div'),b.firstChild);v.id='google_translate_element';v.style.display='none';p=d.createElement('script');p.text='function googleTranslateElementInit(){new google.translate.TranslateElement({pageLanguage:'+'\'\''+'},\'google_translate_element\');}';p.setAttribute('type','text/javascript');b.appendChild(p);}void(0);",,,"translation""
--------------------2
Submenu, "浏览辅助", SimpleU Menu , , "Main Menu Tools"
Submenu, "网页分析", Developer Menu , , "Search Settings"
Item, M_EDIT_SITE_PREFERENCES = Edit site preferences,,,,"News Read"
--------------------3
Include, Internal Frame
Include, Internal Document Background
--------------------4
Submenu, M_OPEN_WITH, Open in menu = Show popup menu, "Open in menu",,,"Mail Forwarded"
;Platform Windows, Item, 使用oGet下载全部="Go to Page, "javascript:(function(){var encodeBase64=function(a){var b,c,d,e='',f=[],i=0,j=0,g=0,h='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='.split('');while(g=a.charCodeAt(j++)){if(g<128){f[f.length]=g}else if(g<2048){f[f.length]=192|(g>>6);f[f.length]=128|(g&63)}else if(g<65536){f[f.length]=224|(g>>12);f[f.length]=128|((g>>6)&63);f[f.length]=128|(g&63)}else{f[f.length]=240|(g>>18);f[f.length]=128|((g>>12)&63);f[f.length]=128|((g>>6)&63);f[f.length]=128|(g&63)}};while(i<f.length){b=f[i++];c=f[i++];d=f[i++];e+=h[b>>2];e+=h[((b&3)<<4)|(c>>4)];e+=h[c===undefined?64:((c&15)<<2)|(d>>6)];e+=h[d===undefined?64:d&63]};return e};var getTLD=function(domain){if(!domain)return;if(/^(?:\d{1,3}\.){3}\d{1,3}$/.test(domain))return domain;var a=domain.split('.');var l=a.length;return(l<3)?domain:(a[l-2]+'.'+a[l-1])};var qualifyURL=function(w,url,onlyhost){var a=w.document.createElement('a');a.href=url;return onlyhost?((a.host.length<a.hostname.length)?a.host:a.hostname):(url?a.href:'')};var getCookie=function(w,link){return(w.document.cookie)?w.document.cookie+'; ':''};var getVideo=function(flashvars,src){var getLink=function(s){var a=s.match(/[^\s\x22=&?]+\.[^\s\x22=&?\/]*(flv|mp4)/i);return a?a[0]:''};var getQuery=function(s,q){var a=s.match(new RegExp('(^|[&?])'+q+'=([^&]+)'));return a?a[2]:''};var getJson=function(s,q){var a=s.match(new RegExp('\x22'+q+'\x22:\\s*(\x22.+?\x22)'));return a?eval(a[1]):''};var getXml=function(s,t){var x=new XMLHttpRequest();x.open('GET',s,false);x.send(null);return x.responseXML&&x.responseXML.getElementsByTagName(t)[0]};var getURL=function(f,s){return f.match(/^(\w+:\/\/|\/|$)/)?f:s.replace(/[#?].*$/,'').replace(/[^\/]*$/,f)};var decodeURL=function(s){try{return decodeURIComponent(s)}catch(e){return unescape(s)}};var q='',url=location.href,flv=decodeURL(flashvars);if(url.indexOf('youtube.com/watch?')!=-1&&(q=decodeURL(getQuery(flashvars,'fmt_url_map')).match(/\d{2}\|([^,]+)/)))return q[1];if(url.indexOf('video.google.com/videoplay?')!=-1&&(q=getQuery(src,'videoUrl')))return decodeURL(q);if(url.indexOf('metacafe.com/watch/')!=-1&&(q=getJson(flv,'mediaURL')))return q+'?__gda__='+getJson(flv,'key');if(url.indexOf('dailymotion.com/')!=-1&&(q=getJson(flv,'hqURL')||getJson(flv,'sdURL')))return q;if(url.indexOf('my-hit.ru/film/')!=-1&&(q=getLink(flv)))return q+'?start=0&id='+getQuery(flv,'id');if(url.indexOf('vd.reborn.ru/?a=watch')!=-1&&(q=getQuery(src,'filename')))return'http://flv.reborn.ru:81/'+q+'.flv';if(url.indexOf('vision.rambler.ru/')!=-1&&(q=getXml(url+'flash_basic_data.xml?where=video','flv')))return q.firstChild.nodeValue;if(url.indexOf('www.tvigle.ru/')!=-1&&(q=getXml('http://www.tvigle.ru/xml/single.php?obj='+getQuery(flv,'obj'),'video')))return q.getAttribute('bigmp4')||q.getAttribute('file')||q.getAttribute('low_file');if(url.indexOf('www.break.com/')!=-1&&(q=getQuery(flv,'videoPath')))return q+'?'+getQuery(flv,'icon');return getURL(getLink(flv)||decodeURL(getLink(src)),src)};var getParam=function(e,n){var v='',r=new RegExp('^('+n+')$','i');var param=e.getElementsByTagName('param');for(var i=0,p;p=param[i];i++){if(r.test(p.getAttribute('name'))){v=p.getAttribute('value');break}};return v};var trimStr=function(s){return s.replace(/\s+/g,' ').replace(/^\s+|\s+$/g,'')};var links='',n=0,rn='\r\n';var downloadAll=function(w){if(w)try{var src,video,title=w.document.getElementsByTagName('title').length?trimStr(w.document.getElementsByTagName('title')[0].text):'';var obj=w.document.getElementsByTagName('object');for(var i=0,oi;oi=obj[i];i++){src=oi.getAttribute('data')||oi.getAttribute('src')||getParam(oi,'movie|data|src|code|filename|url')||(oi.getElementsByTagName('embed').length&&oi.getElementsByTagName('embed')[0].getAttribute('src'));if(src){video=qualifyURL(w,getVideo(getParam(oi,'flashvars'),src));if(video){links+=video+rn+'[Video] '+title+rn+getCookie(w,video)+rn+rn;n++};src=qualifyURL(w,src);links+=src+rn+'[Object] '+title+rn+getCookie(w,src)+rn+rn;n++}};var em=w.document.getElementsByTagName('embed');for(var i=0,ei;ei=em[i];i++){if(ei.parentNode.tagName.toLowerCase()!='object'){src=ei.getAttribute('src');if(src){video=qualifyURL(w,getVideo(ei.getAttribute('flashvars'),src));if(video){links+=video+rn+'[Video] '+title+rn+getCookie(w,video)+rn+rn;n++};src=qualifyURL(w,src);links+=src+rn+'[Embed] '+title+rn+getCookie(w,src)+rn+rn;n++}}};var l=w.document.getElementsByTagName('a');for(var i=0,li;li=l[i];i++){if(li.protocol!='javascript:'&&li.protocol!='mailto:'){links+=li.href+rn+trimStr(li.innerText)+rn+getCookie(w,li.href)+rn+rn;n++}};for(var j=0,f;f=w.frames[j];j++){downloadAll(f)}}catch(e){}};downloadAll(window);var src='data:text/ogt;charset=UTF-8;base64,'+encodeBase64(n+';My_Download_Manager;2;;'+rn+location.href+rn+links);if(top==self){var f=document.createElement('iframe');f.width=0;f.height=0;f.frameBorder='no';f.scrolling='no';document.documentElement.appendChild(f);f.src=src;setTimeout(function(){f.parentNode.removeChild(f)},1)}else{location.href=src}})()",,,"Save" "
Include,eDown All Menu
--------------------5
Item, MI_IDM_FULLSCREENTOGGLE			= Enter fullscreen | Leave fullscreen

[Gadget Edit Widget Popup Menu]
;图标修改
Item, MI_IDM_EDIT_UNDO=Undo
Item, M_REDO=Redo
--------------------1
Item, MI_IDM_EDIT_CUT=Cut,,,,"Mail Compose HTML"
Item, MI_IDM_Copy= Copy
Item, MI_IDM_Paste= Paste
Item, MI_IDM_EDIT_DELETE=Delete
--------------------2
Item, M_CLEAR_ALL=Clear
Item, MI_IDM_EDIT_SELECTALL=Select all

[Edit Go Widget Popup Menu]
;地址栏右键菜单
Item, 粘贴并转到=Paste and go,,,,"Mail Forwarded"
Item, MI_IDM_POPUP_ADDRESS= Copy document address
--------------------0
Item, MI_IDM_EDIT_CUT=Cut,,,,"Mail Compose HTML"
Item, MI_IDM_Copy= Copy
Item, MI_IDM_Paste= Paste
Item, MI_IDM_SelectAll				= Select all
Item, MI_IDM_EDIT_DELETE=Delete
--------------------1
Item, M_COPY_TO_NOTE				= Copy to note,,,,"Note"
Item, 添加到书签=Add to bookmarks
Item, "复制标题和地址" = "Go to page, "javascript:(function(){var urlstr='copytitleurl\n'+document.title+'\n'+document.location.href;var fr=document.createElement('iframe'); fr.setAttribute('id', 'tr_dummy');fr.setAttribute('frameborder', '0');fr.setAttribute('style', 'width:0px;height:0px;visibility:hidden;position:absolute;left:-999em;');fr.setAttribute('src', 'data:text/opshell;charset=UTF-8,'+encodeURIComponent(urlstr));document.documentElement.appendChild(fr); var tr=document.getElementById('tr_dummy');setTimeout('tr.parentNode.removeChild(tr)',1000);})();",,,"pwb""
--------------------2
Item, "用IE访问此地址"=Execute program, "iexplore.exe","%u",,"ie"

[Open in menu]
;完善View IN 打开菜单
Platform Windows, Item, "以兼容模式浏览"="Go to page, "javascript:(function(){var h=location.href;if(!h||/^(javascript|about|opera):/i.test(h)){return}window.open().document.write('<html>'+'<head>'+'<title>'+(document.title?document.title:location.href).replace(/</g,'&lt;')+' - view in ie</title>'+'<style type=\x22text/css\x22>body{margin:0;padding:0;}embed{width:100\x25;height:100\x25;}</style>'+'</head>'+'<body>'+'<script type=\x22text/javascript\x22'+'src=\x22data:text/javascript,'+encodeURIComponent('document.write(\'<embed type=\x22application/viewinie\x22 param-location=\x22'+location.href+'\x22></embed>\');')+'\x22>'+'</script>'+'</body>'+'</html>')})();", , , "Menu Info""
Include, Internal OpenIn Menu
Item, "用TheWorld打开"="Execute program,"optools\TheWorld.exe","%u","", "ie""
Feature !Private, Item, "用隐身标签打开"=External action,,,,"New Private Page Menu" | Copy document address & new private page & go to page, "%c"
--------------------1
Item, "网站使用IE内核编辑"="Execute program, "notepad.exe", "profile\script\ieopera.js", , "Widget""
Item, "查看域名信息"="Go to page, "http://alexa.chinaz.com/?domain=%u" & New page & Go to page, "http://whois.domaintools.com/%u",,"Alexa""

[Transfers Item Popup Menu]
;下载右键菜单修改
Item, 	M_TRANSFERS_NOTIFY_POPUP_MENU_OPEN		= Open transfer
Submenu, M_OPEN_WITH, Open in menu
Item, 	M_TRANSFERS_NOTIFY_POPUP_MENU_OPEN_FOLDER	= Open transfer folder
--------------------1
Item, 	SI_IDM_TRANSFER_RESUME				= Resume transfer | Restart transfer, , , M_TRANSFER_ITEM_POPUP_MENU_RESTART_TRANSF
Item, 	SI_IDM_TRANSFER_STOP				= Stop transfer
--------------------2
Item, 	M_TRANSFER_ITEM_POPUP_MENU_REMOVE_TRANSF	= Delete
Platform Windows, Item, "彻底删除文件"=Stop transfer,,,, "Delete" & Copy transfer info,,,, "Delete" & Execute program,"profile\DelFile.vbs", "delet" & Delete
Item, 	M_REMOVE_ALL_FINISHED_TRANSFERS			= Remove all finished transfers
--------------------3
Platform Windows, Item, "查看文件HASH值"="Copy transfer info, , , , "hash" & Execute program, "optools\hash.bat", , , "hash""
Platform Windows, Item, "将此解压文件"="Copy transfer info, , , , "Attachment Archives" & Execute program, "optools\Extract.exe", , , "Attachment Archives""
Item, 	SI_IDSTR_TRANSWIN_MENU_COPYTEXTINFO		= Copy transfer info
Platform Windows, --------------------4
Platform Windows, Submenu, M_TRANSFER_ITEM_POPUP_MENU_ADVANCED, Internal Shell

[Transfers View Popup Menu]
;下载设置菜单完善
Include, Simple Download Menu
--------------------1
Item, M_TRANSFERVIEW_POPUP_MENU_SHOW_TRWINDOW_ON_TRANSF	= Set show transferwindow, 1
Item, M_TRANSFERS_VIEW_POPUP_MENU_SHOW			= Set show transferwindow, 2
Item, M_TRANSFERS_VIEW_POPUP_NEVER_SHOW			= Set show transferwindow, 0
--------------------2
Item, MI_IDM_TRANSFER_SHOW_DETAILS			= Show transfer details | Hide transfer details
Item, MI_IDM_TRANSFER_SHOW_NEW_ON_TOP			= Show new transferitems on top | Show new transferitems on bottom

[Closed Pages Menu]
;关闭列表功能补充
Item, MI_IDM_HistoryWindow= Manage, "history",,,"Menu History"
Item, "隐藏到托盘"="Hide opera, , , "隐藏到托盘", "Cascade""
Item, "被阻止的弹出窗口"=Show popup menu
Include, Internal Blocked Popup List
--------------------1
Item, M_CLOSED_MENU_EMPTY_TRASH = Empty page trash
Include, Internal Closed Window List

[Full Reload Menu]
;刷新菜单完善
Item, MI_IDM_RELOAD_ALL = Reload all pages
Item, "停止所有标签(&S)"=External action,,,,"none" | Manage, "windows" & Focus next widget & Open item & Select all & Stop & Close item & Close clicked page & Minimize page, 1
Item, "刷新所有图像"		= Load all images
--------------------0
Include, Reload Menu

[Images And Style Menu]
;样式菜单完善
Item, MI_IDM_MENU_STATUS_BAR_TOP_PARENT = Set alignment, "status toolbar", 6 | Set alignment, "status toolbar", 0
Item, "刷新JS和CSS文件"  = External action,,,,"News Unread" | Refresh display & delay,1 & Reload stylesheets
Item, "UserStyles"="Execute program, "profile\styles",,,"Target Folder""
--------------------0
;Include, Style Menu
Include, Internal Style List
--------------------1
Item, M_BROWSER_VIEW_MENU_STYLE_AUTHOR_MODE			= Select author mode
Item, M_BROWSER_VIEW_MENU_STYLE_USER_MODE			= Select user mode
Item, M_MANAGE_PRESENTATION_MODES = Manage modes,1


[Note Item Popup Menu]
;笔记右键菜单
Item, MI_IDM_SELMAIL	= Send text in mail
--------------------1
Item, MI_IDM_HLITEM_CUT				= Cut
Item, MI_IDM_HLITEM_COPY			= Copy
Item, MI_IDM_HLITEM_PASTE			= Paste
Item, MI_IDM_HLITEM_DELETE			= Delete
--------------------2
Item, "还原"=External action,,,, "Cut" > Cut & Paste to note
Item, "合并笔记"= Copy & Delete & Paste to Note
--------------------3
Item, MI_IDM_HLITEM_SELECTALL			= Select all
--------------------4
Item, M_BOOKM_PANEL_VIEW_MENU_SORT_BY_MY_ORDER	= Sort by column, -1
Item, M_BOOKM_PANEL_VIEW_MENU_SORT_BY_NAME	= Sort by column, 0
--------------------5
Item, M_NEW_NOTE	= New note
Item, SI_NEW_FOLDER_BUTTON_TEXT	= New folder
Item, M_NEW_SEPARATOR 	= New Seperator

[Pagebar Item Popup Menu]
;标签上右键弹出菜单
Item, "隐私模式"="Copy document address & New private page & Paste and go,,,"Window Private Icon""
Item, M_LOCK_TAB = Lock page,,,, "High Security Simple" | Unlock page,,,, "No Security"
Item, MI_IDM_CLONE_WINDOW = Duplicate page,,,, "Mail Labels"
Item, M_DETACH_PAGE  = Detach page,,,, "New Window"
Item, MI_IDM_POPUP_ADDRESS = Copy document address,,,, "News Read"
Item, "用IE打开"=Execute program, "iexplore.exe","%u",,"ie"
Platform Windows, Item, "Z-小窗口(&Z)"=External action,,,,"Widget Manager 16" | Duplicate page & Switch to previous page & delay,1 & delay,100 & Detach page & delay,1 & delay,100 & Execute program,"optools\wndmask.exe"
--------------------1
Item, M_PAGEBAR_POPUP_MENU_CLOSE_ALL	= Close all,,,, "Caption close"
Item, M_PAGEBAR_POPUP_MENU_CLOSE_ALL_BUT_ACTIVE     = Close other,,,, "Caption close"
Item, M_PAGEBAR_POPUP_MENU_CLOSE_ALL_PRIVATE = Close private tabs,,,, "Caption close"
--------------------2
Item, MI_IDM_SaveAs			= Save document
Item, M_DOCUMENT_POPUP_MENU_BOOKMARK_PAGE		= Add to bookmarks, 1
Item, 添加全部页面到收藏=Focus panel, "bookmarks",,, "Save" & Delay, 50 & View style, 0 & Focus previous widget & Focus previous widget & Activate hotlist window & Focus next widget & Clear & Insert, "Sessions" & Go & Clear & Focus next widget & New folder & Add all to bookmarks & Edit properties
--------------------3
Submenu, M_TABBAR_PLACEMENT, Pagebar Placement Menu, -2, "Window Hotlist Icon"
Submenu, M_MENU_ITEM_ARRANGE, Pagebar Arrange Menu, -2, "Menu Window"
;Submenu, D_CUSTOMIZE_TOOLBAR_DIALOG_HEADER, Pagebar Customize Menu
Item, "标签页选项"= Show preferences, 10

[Pagebar Inactive Item Popup Menu]
;标签右键菜单,同上
Include, Pagebar Item Popup Menu

[Image Link Popup Menu]
;带链接图片上右键菜单
Include,Image Popup Menu
--------------------1
Item, MI_IDM_POPUP_LINK_ADDRESS				= Copy link, -2, "urlinfo"
Item, MI_IDM_MENU_PAGEBAR_LINK_IN_NEW_PAGE		= Open link in new page, -2, "urlinfo"
Item, MI_IDM_SAVELINKDOCAS				= Save link, -2, "urlinfo"
Item, M_LINKS_PANEL_BOOKMARK_LINK			= Add link to bookmarks, -2, "urlinfo"
Item, M_SAVE_LINK_TO_DOWNLOAD_FOLDER			= Download url, -2, "urlinfo"
;Platform Windows, Item, 使用oGet下载="Go to Page, "javascript:void(inivar='%l')" & Go to Page, "javascript:(function(){var encodeBase64=function(a){var b,c,d,e='',f=[],i=0,j=0,g=0,h='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='.split('');while(g=a.charCodeAt(j++)){if(g<128){f[f.length]=g}else if(g<2048){f[f.length]=192|(g>>6);f[f.length]=128|(g&63)}else if(g<65536){f[f.length]=224|(g>>12);f[f.length]=128|((g>>6)&63);f[f.length]=128|(g&63)}else{f[f.length]=240|(g>>18);f[f.length]=128|((g>>12)&63);f[f.length]=128|((g>>6)&63);f[f.length]=128|(g&63)}};while(i<f.length){b=f[i++];c=f[i++];d=f[i++];e+=h[b>>2];e+=h[((b&3)<<4)|(c>>4)];e+=h[c===undefined?64:((c&15)<<2)|(d>>6)];e+=h[d===undefined?64:d&63]};return e};var getTLD=function(domain){if(!domain)return;if(/^(?:\d{1,3}\.){3}\d{1,3}$/.test(domain))return domain;var a=domain.split('.');var l=a.length;return(l<3)?domain:(a[l-2]+'.'+a[l-1])};var hostName=function(link){var a=document.createElement('a');a.href=link;return(a.host.length<a.hostname.length)?a.host:a.hostname};var rn='\r\n',ele=document.activeElement;var link=ele&&ele.href;var txt=document.getSelection()||(link?ele.innerText:'');if(!link)link=window.inivar;window.inivar=null;if(txt)txt=txt.replace(/\s/g,' ').replace(/^\s+|\s+$/g,'').replace(/\x22/g,'\x27');var cookie=(document.cookie)?document.cookie+'; ':'';var src='data:text/ogt;charset=UTF-8;base64,'+encodeBase64('1;My_Download_Manager;0;;'+rn+location.href+rn+link+rn+txt+rn+cookie+rn+rn+rn);if(top==self){var f=document.createElement('iframe');f.width=0;f.height=0;f.frameBorder='no';f.scrolling='no';document.documentElement.appendChild(f);f.src=src;setTimeout(function(){f.parentNode.removeChild(f)},1)}else{location.href=src}})()",,,"Save" "
Include,eDown Link Menu

[Image Popup Menu]
;图像右键菜单:右键点击图片的弹出菜单
Item, M_MENU_RELOAD_IMAGE				= Load image
Item, M_OPEN_IMAGE				        = Open image
Item, MI_IDM_SAVE_FIGURE				= Save image
Item, "屏蔽图片"="Copy image address,-2,,, "Content block image" & Go to Page, "javascript:(function(w){if(w)try{var c=decodeURIComponent('%c');var e=w.document.selectNodes('//img[@src]');for(var i=0,ele;ele=e[i];i++){if(decodeURIComponent(ele.src)==c)ele.style.display='none !important'};for(var j=0,f;f=w.frames[j];j++){arguments.callee(f)}}catch(e){}})(window)" & Execute program, "optools\opshell.exe", "blockpic %c" & Content block details, 1"
--------------------0
Include, Simple ImageLike Menu
--------------------1
Item, M_DOCUMENT_BACKGROUND_MENU_COPY_TO_CLIPBOARD	= Copy image
Item, MI_IDM_COPY_FIG_ADDRESS				= Copy image address
Item, 复制图片地址到笔记="External action,,,, "New Note" > Copy image address & Paste to note"
--------------------2
Platform Windows-Mac, Item, M_DOCUMENT_BACKGROUND_MENU_USE_ON_DESKTOP = Use image as desktop background
Item, M_IMAGE_MENU_USE_ON_SPEEDDIAL		= Use image as speed dial background
--------------------3
GhostItem, M_FOLLOW_LONGDESC = Follow Image Description URL
Item, MI_IDM_SHOW_FIGURE_PROPERTIES			= Show image properties

[Turbo Image Popup Menu]
;开启Turbo后图片上的右键菜单
Include,Quick Link Menu
--------------------0
Item, M_OPEN_IMAGE		= Open image
Item, M_MENU_TURBO_RELOAD_IMAGE		= Load image in full quality
Item, MI_IDM_SAVE_FIGURE		= Save image
--------------------0
Include, Simple ImageLike Menu
--------------------1
Item, M_DOCUMENT_BACKGROUND_MENU_COPY_TO_CLIPBOARD	= Copy image
Item, MI_IDM_COPY_FIG_ADDRESS		= Copy image address
--------------------2
GhostItem, M_FOLLOW_LONGDESC = Follow Image Description URL
Item, MI_IDM_SHOW_FIGURE_PROPERTIES	= Show image properties

[Links Panel Item Menu]
;链接上的右键菜单
Item, SI_OPEN_BUTTON_TEXT		= Open link
Item, MI_IDM_MENU_PAGEBAR_LINK_IN_NEW_PAGE	= Open link in new page
Item, MI_IDM_MENU_PAGEBAR_LINK_IN_BG_PAGE	= Open link in background page
--------------------1
Item, MI_IDM_HLITEM_GET_IN_NEW_WINDOW	= Open link in new window
Item, M_OPEN_BACKGROUND_WINDOW		= Open link in background window
--------------------2
Item, M_LINKS_PANEL_BOOKMARK_LINK	= Add link to bookmarks
Item, MI_IDM_POPUP_LINK_ADDRESS		= Copy
Item, MI_IDM_SAVELINKDOCAS		= Download url as
Item, M_SAVE_LINK_TO_DOWNLOAD_FOLDER	= Download url
--------------------3
;Platform Windows, Item, 使用oGet下载="Go to Page, "javascript:void(inivar='%l')" & Go to Page, "javascript:(function(){var encodeBase64=function(a){var b,c,d,e='',f=[],i=0,j=0,g=0,h='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='.split('');while(g=a.charCodeAt(j++)){if(g<128){f[f.length]=g}else if(g<2048){f[f.length]=192|(g>>6);f[f.length]=128|(g&63)}else if(g<65536){f[f.length]=224|(g>>12);f[f.length]=128|((g>>6)&63);f[f.length]=128|(g&63)}else{f[f.length]=240|(g>>18);f[f.length]=128|((g>>12)&63);f[f.length]=128|((g>>6)&63);f[f.length]=128|(g&63)}};while(i<f.length){b=f[i++];c=f[i++];d=f[i++];e+=h[b>>2];e+=h[((b&3)<<4)|(c>>4)];e+=h[c===undefined?64:((c&15)<<2)|(d>>6)];e+=h[d===undefined?64:d&63]};return e};var getTLD=function(domain){if(!domain)return;if(/^(?:\d{1,3}\.){3}\d{1,3}$/.test(domain))return domain;var a=domain.split('.');var l=a.length;return(l<3)?domain:(a[l-2]+'.'+a[l-1])};var hostName=function(link){var a=document.createElement('a');a.href=link;return(a.host.length<a.hostname.length)?a.host:a.hostname};var rn='\r\n',ele=document.activeElement;var link=ele&&ele.href;var txt=document.getSelection()||(link?ele.innerText:'');if(!link)link=window.inivar;window.inivar=null;if(txt)txt=txt.replace(/\s/g,' ').replace(/^\s+|\s+$/g,'').replace(/\x22/g,'\x27');var cookie=(document.cookie)?document.cookie+'; ':'';var src='data:text/ogt;charset=UTF-8;base64,'+encodeBase64('1;My_Download_Manager;0;;'+rn+location.href+rn+link+rn+txt+rn+cookie+rn+rn+rn);if(top==self){var f=document.createElement('iframe');f.width=0;f.height=0;f.frameBorder='no';f.scrolling='no';document.documentElement.appendChild(f);f.src=src;setTimeout(function(){f.parentNode.removeChild(f)},1)}else{location.href=src}})()",,,"save" "
Include,eDown Link Menu
--------------------4
Item, M_PANEL_LOCK		= Lock panel | Unlock panel

[Browser Edit Menu]
;菜单栏的编辑的菜单
Item, "撤销"=Undo
Item, "重做"=Redo
--------------------1
Item, "剪切"=Cut
Item, "复制"=Copy
Item, "复制到笔记"=Copy to note
Item, "粘贴"=Paste
--------------------2
Item, "全选"=Select all
--------------------5
Item, "查找"=Find
Item, "查找下一个"=Find next


[Browser Button Menu Bar]
;左上角Opera菜单
Submenu, MI_IDM_TABS_AND_WINDOWS, Tabs O Menu, , "Menu Main Menu"
Submenu, MI_IDM_HELP_COPY_PARENT, Browser Edit Menu, , "Menu Edit"
;Submenu, MI_IDM_PAGE_TOOLS, Page Tools O Menu
Submenu, MI_IDM_ENCODING_AUTOMATIC_PARENT, Encoding Menu, , "Window Document Icon"
Submenu, SI_PRINT_BUTTON_TEXT, Print Menu,, "Print document"	= Show popup menu, "Print Menu"
--------------------1
Include, Internal Sync Menu
Item, M_VIEW_HOTLIST_MENU_NOTES			= Manage, "notes",,,"Menu Notes"
Feature Mail-Chat, --------------------2
Item, M_TOOLS_MAIL_AND_CHAT			= Manage accounts
Feature Mail, Submenu, M_BROWSER_MENU_BAR_MAIL, Browser Mail Menu, , "Menu Mail"
Feature Chat, Submenu, M_BROWSER_MENU_BAR_CHAT, Browser Chat Menu, , "Menu Chat"
Feature Mail-Chat, Item, M_VIEW_HOTLIST_MENU_CONTACTS	= Manage, "contacts",,,"Menu Contacts"
;Feature Feeds, --------------------3
Feature Feeds, Submenu, M_MENU_BAR_FEEDS_SUBMENU, Browser Feeds Menu, , "Menu Feeds"
Item, MI_IDM_CLEAR_PERSONAL_INFORMATION		= Delete private data
--------------------4
Item, M_MENU_SHOW_MENU_BAR = Enable menu bar,,,, | Disable Menu Bar, , , M_MENU_HIDE_MENU_BAR,
Submenu, M_BROWSER_VIEW_MENU_TOOLBARS, View Toolbars Menu
Item, M_BROWSER_TOOLS_MENU_APPEARANCE		= Customize toolbars, -1
--------------------5
Item, MI_IDM_Preferences=Show preferences, -1
Item, "Opera:Config"=Go to page, "opera:config", , "Config", "Menu info"
--------------------6
Item, "重启Opera"=Exit, , , , "Close" & Execute program, "opera.exe"
Item, 退出!= Execute program,"cmd.exe","/c taskkill /im opera.exe  /f /t" ,,"none"
BreakItem
Item, 51099	= Work offline | Work online
Submenu, MI_IDM_ZOOM_50_PARENT, Zoom Menu
Submenu, DI_IDSTR_M2_FOLDER_IDX_IMAGES, Images Menu
Submenu, M_BROWSER_VIEW_MENU_STYLE, Style Menu
Submenu, M_DEVELOPER_TOOLS, Developer Menu	= Show popup menu, "Developer Menu" 
Submenu, MI_IDM_CONTROL_MENU_ACCEPT_POPUPS_PARENT, Quick Preferences Menu="Show popup menu, "Quick Preferences Menu""
Submenu, M_FILE_MENU_IMPORT_AND_EXPORT, Browser ImportExport Menu
Submenu, M_BROWSER_MENU_BAR_BOOKMARKS, Browser Bookmarks Menu, , "Menu Bookmarks"
Item, MI_IDM_HistoryWindow= Manage, "history",,,"Menu History"
Item, M_VIEW_HOTLIST_MENU_NOTES	= Manage, "notes",,,"Menu Notes"
Item, MI_IDM_DownloadWindow	= Manage, "transfers",,,"Menu Transfers"
Item, M_VIEW_HOTLIST_MENU_LINKS = Manage, "links",,,"Panel Links"
Item, S_EXTENSIONS_MANAGE = Manage, "extensions",,, "Menu Extensions"
;Feature Mail, Submenu, M_BROWSER_MENU_BAR_MAIL, Mail Standard View Menu
Platform Windows-Unix, Item, MI_IDM_FULLSCREENTOGGLE			= Enter fullscreen | Leave fullscreen
Platform Mac, Item, M_PRESENTATION_MODE_TOGGLE			= Enter fullscreen | Leave fullscreen
Platform Mac, Item, MI_IDM_FULLSCREENTOGGLE			= Toggle system fullscreen
Item, M_BROWSER_VIEW_MENU_MEDIUM_SCREEN		= Enable mediumscreen mode | Disable mediumscreen mode
Platform Windows, Item, "使用说明"="Execute program, "locale\en\license.txt", , , "note""
Item, MI_IDM_WWW_SUPPORT = Open URL in new page, "http://bbs.operachina.com/viewtopic.php?f=15&t=88316",,,"Window Browser Icon"
Submenu, M_BROWSER_MENU_BAR_HELP, Browser Help Menu,,"Window Browser Icon"

[Browser Help Menu]
Item, M_OPERA_HELP = Open URL in new page, "opera:/help/index.html",,,"Menu Info"
;--------------------1
Item, MI_IDM_WWW_MYOPERA = Open URL in new page, "http://bbs.operachina.com/",,,"Window Browser Icon"
--------------------2
Feature Autoupdate, Item, M_NEW_VERSION_CHECK = Check for upgrade
;Platform Windows, Item,"更新SimpleU" = Execute program,"HostsTool.bat","opup","", "Window Browser Icon"
Item, M_BROWSER_HELP_MENU_REPORT = Report site problem
;--------------------3
Item, MI_IDM_About = Open URL in new page, "opera:about",,,"Blank"

[Tabs O Menu]
Item, MI_IDM_Open				= Open document
Item, MI_IDM_SaveAs				= Save document
--------------------0
Include, Browser Tabs Menu
--------------------1
Include, Browser Session Menu

[Edit Widget Popup Menu]
;编辑框右键菜单:右键点击回复框以及记事本空白处的弹出菜单
Item, MI_IDM_EDIT_CUT=Cut,,,,"Mail Compose HTML"
Item, MI_IDM_EDIT_COPY=Copy
Item, MI_IDM_EDIT_PASTE=Paste,,,,"Mail Compose Bullet List"
Item, MI_IDM_EDIT_DELETE=Delete
--------------------1
Item, 全选并复制=Select all&copy
Platform Windows, Item,"粘贴并回车"=External action,,,,"none" | paste & Execute program,"profile\enter.vbs"
--------------------2
Item, M_COPY_TO_NOTE=Copy to note,,,,"Note"
Submenu, M_INSERT_PERSONAL, Edit Widget Insert Menu
Submenu, M_INSERT_NOTE, Internal Note List, 0
--------------------3
Item, "字数统计"=Go to page, "javascript:(function(){var D=document,i,f,j,e;for(i=0;f=D.forms[i];++i)for(j=0;e=f[j];++j)if(e.type=='text'||e.type=='password'||e.tagName.toLowerCase()=='textarea')S(e);function S(e){if(!e.N){var x=D.createElement('span'),s=x.style;s.color='green';s.background='white';s.font='bold 10pt sans-serif';s.verticalAlign='top';e.parentNode.insertBefore(x,e.nextSibling);function u(){x.innerHTML=e.value.length;}u();e.onchange=u;e.onkeyup=u;e.oninput=u;e.N=x;}else{e.parentNode.removeChild(e.N);e.N=0;}}})()",,,"null" & Go to page, "javascript:document.selectSingleNode('//textarea[last()]').focus();"
Submenu, "输入工具", Simple BBSWaterTool Menu, , "Smiley Wink""
Submenu, "快速回复", Simple BBSWater Menu, , "Label Funny""
--------------------4
Item, M_CREATE_SEARCH		= Create search|Manage Search Engines,,,M_MANAGE_SEARCH_ENGINES

[Hotclick Popup Menu]
;文字右键菜单:右键点击已拖选文本的弹出菜单
Item, MI_IDM_DOCCOPY			= Copy
Item, M_COPY_TO_NOTE			= Copy to note,,,,"note"
Item, "复制(带格式)"=External action,,,,"Mail Compose Center" | Go to page, "javascript:(function(){remHiddenChars('span');remHiddenChars('font');function remHiddenChars(tag){var s= document.getElementsByTagName(tag);for(i=0;i<s.length;i++){var z = s[i].style.fontSize.charAt(0);var c = '';try{c=s[i].style.color.toLowerCase();if(c==''){c = s[i].color.toLowerCase();}}catch(e){}n = s[i].className;d = s[i].style.display.toLowerCase();if(z=='0' || d=='none' || n.indexOf('Random_Color')!=-1 || c=='#eefaee' || c=='#fff' || c=='#ffffff' || c=='#eff0eb' || c=='white'){try{s[i].parentNode.removeChild(s[i]);i--;}catch(e){}}}}})();" & delay,1 & delay,100 & Go to page, "javascript:(function(){var oLinks=document.selectNodes('//a[not(contains(@href, \u0022:\u0022))]');var oImgs=document.selectNodes('//img[not(contains(@src, \u0022:\u0022))]');for(var i=0,oA;oA=oLinks[i];i++){oA.href=oA.href;}for(var i=0,oImg;oImg=oImgs[i];i++){oImg.src=oImg.src;}document.designMode='on';})();" & Delay, 300 & Copy & Delay, 300 & Go to page, "javascript:void(document.designMode='off')"
;Platform Windows, Item, "带格式复制"="Go to Page, "javascript:(function(){var encodeBase64=function(a){var b='';var c=0;var i=0;var d='';var e=a.length;var f=[];var g='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';while(c=a.charCodeAt(i++)){if(c<0x80){f[f.length]=c}else if(c<0x800){f[f.length]=0xc0|(c>>6);f[f.length]=0x80|(c&0x3f)}else if(c<0x10000){f[f.length]=0xe0|(c>>12);f[f.length]=0x80|((c>>6)&0x3f);f[f.length]=0x80|(c&0x3f)}else{f[f.length]=0xf0|(c>>18);f[f.length]=0x80|((c>>12)&0x3f);f[f.length]=0x80|((c>>6)&0x3f);f[f.length]=0x80|(c&0x3f)}if(i==e){while(f.length%%3){f[f.length]=0;d+='='}}if(f.length>2){b+=g[f[0]>>2];b+=g[((f.shift()&3)<<4)|(f[0]>>4)];b+=g[((f.shift()&0xf)<<2)|(f[0]>>6)];b+=g[f.shift()&0x3f]}}return(b+d)};var selWin=function(w){if(w.getSelection()!='')return w;for(var i=0,f,r;f=w.frames[i];i++){try{if(r=arguments.callee(f))return r}catch(e){}}};var win=selWin(window);if(win){var doc=win.document;var link=win.location.href;if(win.location.protocol=='file:')link=link.replace('localhost','');var sel=doc.createDocumentFragment();var range=win.getSelection().getRangeAt(0);sel.appendChild(doc.createComment('StartFragment'));sel.appendChild(range.cloneContents());sel.appendChild(doc.createComment('EndFragment'));var ele=range.commonAncestorContainer;while(ele){if(ele.nodeType==1){var clone=ele.cloneNode(false);clone.appendChild(sel);sel=clone};ele=ele.parentNode};var h=sel.insertBefore(doc.createElement('head'),sel.firstChild);var title=doc.getElementsByTagName('title')[0];if(title)h.appendChild(title.cloneNode(true));var meta=doc.createElement('meta');meta.httpEquiv='content-type';meta.content='text/html; charset=utf-8';h.appendChild(meta);var base=doc.getElementsByTagName('base')[0];var b=base?base.cloneNode(false):doc.createElement('base');if(!b.href)b.href=link;h.appendChild(b);var styles=doc.styleSheets;for(var i=0,si;si=styles[i];i++){var style=doc.createElement('style');style.type='text/css';if(si.media.mediaText)style.media=si.media.mediaText;try{for(var j=0,rule;rule=si.cssRules[j];j++){style.appendChild(doc.createTextNode(rule.cssText+'\n'))}}catch(e){if(si.ownerNode)style=si.ownerNode.cloneNode(false)};h.appendChild(style)};var all=sel.getElementsByTagName('*');for(var i=all.length;i--;){var el=all[i];switch(el.nodeName.toLowerCase()){case'frame':case'iframe':case'embed':case'img':el.src=el.src;break;case'link':case'area':case'a':el.href=el.href;break;case'script':el.parentNode.removeChild(el);break}};var doctype='';var dt=doc.doctype;if(dt&&dt.name){doctype+='<!DOCTYPE '+dt.name;if(dt.publicId)doctype+=' PUBLIC \x22'+dt.publicId+'\x22';if(dt.systemId)doctype+=' \x22'+dt.systemId+'\x22';doctype+='>\n'};var f=doc.createElement('iframe');f.width=0;f.height=0;f.frameBorder='no';f.scrolling='no';f.src='data:text/cwf;charset=UTF-8;base64,'+encodeBase64('SourceURL:'+link+'\r\n\r\n'+doctype+sel.outerHTML);doc.documentElement.appendChild(f);f.parentNode.removeChild(f)}})();",,,"Copy" "
Platform Windows, Item,"快速保存选定文本"=Execute program,"optools\SaveTXT.exe","%u", ,"Note Web""
Item, "保存富文本.doc"=Go to page, "javascript:(function(){var oLinks=document.selectNodes('//a[not(contains(@href, \u0022:\u0022))]');var oImgs=document.selectNodes('//img[not(contains(@src, \u0022:\u0022))]');for(var i=0,oA;oA=oLinks[i];i++){oA.href=oA.href;}for(var i=0,oImg;oImg=oImgs[i];i++){oImg.src=oImg.src;}document.designMode='on';})();", , , "Blank" & Delay, 300 & Copy & Delay, 300 & Go to page, "javascript:void(document.designMode='off')" & Delay, 300 & Execute program, "profile\SaveAsFormats.vbs", "@savedoc~%u"
;Platform Win2000-Unix-Mac, Feature Voice, Item, M_HOTCLICK_MENU_ITEM_SPEAK = Speak selection
Item,"提取所选电驴链接(&U)="Go to page, "javascript:(function(){ var i,l;var urlstr='';var sel=document.createElement('div'); sel.appendChild(window.getSelection().getRangeAt(0).cloneContents());var dl=sel.getElementsByTagName('a');for(i=0;i<dl.length;i++){l=dl[i];if(l.protocol!='javascript:'&&l.protocol!='mailto:'){if(l.href.match(/^ed2k/i))urlstr=urlstr+'\n'+l.href+'\n';}};var t=document.createElement('textarea');t.style='position:fixed;opacity:0; left:0;top:0; z-index:-999;';t.value=urlstr;document.documentElement.appendChild(t);t.focus();t.setSelectionRange(0, t.value.length); setTimeout(function(){document.documentElement.removeChild(t)},200)})();", , , "none" & delay,1 & delay,100 & copy"
--------------------1
Item, MI_IDM_SELSEARCH			= Hotclick search, 200,,, "Search Web"
Submenu, "选择搜索引擎", Simple Search With, , "Search""
;Submenu, MI_IDM_SEARCH_DUMMY_PARENT, Internal Search With
Submenu, MI_IDM_SELTRANSLATE_EN_FR_PARENT, Translate menu
--------------------2
Item,"统计字数"=External action,,,,"News Unread" | Go to Page, "javascript:void(inivar='%t')" & Go to page, "javascript: (function(){var str = document.getSelection() || window.inivar;if(str){function strlen(str){return str.length;}function strchlen(str){var counter;var i;counter=0;for(i=0;i<str.length;i++){if(str.charCodeAt(i)>255){counter++;}}return counter;}function strenlen(str){var counter;var i;counter=0;for(i=0;i<str.length;i++){while(str.charAt(i)==' '||str.charCodeAt(i)>255) i++;if(str.charAt(i+1)==' '||str.charCodeAt(i+1)>255||i==str.length-1) counter++;}  return counter;}function count(){var txt=window.getSelection().toString();var lenall=strlen(txt);var lench=strchlen(txt);var lenen=strenlen(txt);var msg='字数统计\n\n字符总数: '+lenall+'\n中文字符: '+lench+'\n英文（数字）词组: '+lenen;alert(msg);}count();}else{var str=prompt('划选文字后使用统计字数；输入数字+px改变本页字体大小；非数字进行EncodeURL编码；输入的字符串后面加空格再加r，会将字符串倒过来；清空输入框会提取SkyDrive永久链。','13px');if(str.match(/(\sr$)/i)){str=str.substring(0,(str.length-2));prompt('result', str.split('').reverse().join(''))}else if(str.match(/(^\s*\d+(p(x||t)){0,1}$)/i)){for(i=0;i<document.getElementsByTagName('*').length;i++)void(document.getElementsByTagName('*')[i].style.fontSize=str);}else if(str != null && str != ''){prompt('result',encodeURI(str))}else{try{prompt('skydrive永久链', 'http://storage.live.com/items/' + (location.hash ? location.hash : selfPageData.currentItemHash).replace('#resId/', '') + '?filename=' + encodeURI(selfPageData.currentItem.fileName));}catch(err){alert('获取错误')}};}})();",,,"none"
Item, "显示所选源代码(&S)"=Go to page, "javascript:(function(){var k='  ';var l={img:1,br:1,link:1,input:1,hr:1,meta:1};var m=false;var n=0;var o=1;var p=window;var q='resizable=yes,scrollbars=yes,location=no';var r=function(a){return'<span class=\'tag\'>&lt;'+a+''};var s=function(a){return(a?'/':'')+'&gt;</span>'};var t=function(a,b){if(b||l[a.toLowerCase()])return'';return'<span class=\'tag\'>&lt;/'+a+'&gt;</span>'};var u=function(){var a=document.doctype,code='';if(a){code=z()+r('!DOCTYPE')+' <span class=\'attrDoc\'>'+a.nodeName+(a.publicId?' PUBLIC \''+a.publicId+'\'':'')+(a.systemId?'</span></span></span></li>'+z()+'<span class=\'tag\'><span class=\'attrDoc\'>'+k+'\''+a.systemId+'\'':'')+'</span>'+s()+'</span></li>'}return code};var v=function(a){var b=a.attributes,attr=null,realAttr=null,ret='',i=0;for(;attr=b[i];i++){realAttr=a.getAttribute(attr.name)||attr.value;if(realAttr&&!(a.nodeName.toLowerCase()=='a'&&attr.name=='SHAPE'&&realAttr=='rect')){realAttr=realAttr.replace(/</g,'&lt;').replace(/</g,'&lt;').replace(/\t/g,k);ret+=' <span class=\'attrTitle\'>'+attr.name+'</span>'+'='+'<span class=\'attrValue\'>\x22'+realAttr+'\x22</span> '}}return ret};var x=function(a){return text=a.nodeValue.replace(/[\n\t\r\u00A0]+ */g,'').replace(/ +/g,' ').replace(/</g,'&lt;').replace(/>/g,'&gt;')};var y=function(a){var i=0,ret='';while(i<a){ret+=k;i++}return ret};var z=function(){var a=n.toString();while(a.length<3)a='0'+a;return'<li class=\'line'+(o&&((n++)&1)?' dark\'':'\'')+'><span>'};var A=function(a,b,c){var d=y(b++);var e='';switch(a.nodeType){case 1:{var f=a.childNodes,child=null,i=0;var g=(f.length==0)||(f.length==1&&f[0].nodeType==3);var h=m&&f.length==0;var j=z()+d+r(a.nodeName)+v(a)+s(h);if(!g)j+='</span></li>';for(;child=f[i];i++){j+=A(child,b,!g&&child.nodeType==3)}if(g){j+=(/textarea/i.test(a.nodeName)?a.value:'')+t(a.nodeName,h)+'</span></li>'}else{j+=z()+d+t(a.nodeName,h)+'</span></li>'}return j}case 3:{if((e=x(a))&&c){return z()+d+e+'</span></li>'}else{return e}}case 8:{e=x(a);return z()+d+'<span class=\'comment\'>&lt;!--'+e+'--&gt;</span></span></li>'}case 4:{e=x(a);return z()+d+'<span class=\'cdata\'>&lt;![CDATA[</span>'+e+'<span class=\'cdata\'>]]&gt;</span></span></li>'}}return a.nodeType};var B=function(w){var a='';if(!w||!w.getSelection)return a;if(w.getSelection()!=''){a=w.getSelection();p=w;q+=',width=800,height=500,left=100,top=100'}else{for(var i=0,f;f=w.frames[i];i++){try{if(a=arguments.callee(f))break}catch(e){}}}return a};var C=function(a){var b,F='';if(a){var c=a.getRangeAt(0);var d=c.commonAncestorContainer;if(d.nodeType==3||d.nodeType==4)d=d.parentNode;b=d.cloneNode(false);b.appendChild(c.cloneContents());var e=c.startContainer;var f=c.endContainer;if(e!=d.firstChild||(e.nodeType==3&&c.startOffset!=0))b.insertBefore(document.createTextNode('\u2026'),b.firstChild);if(f!=d.lastChild||(f.nodeType==3&&c.endOffset!=f.nodeValue.length))b.appendChild(document.createTextNode('\u2026'))}else{F=u();b=document.documentElement};F+=A(b,0);return F};var D=B(window);m=/[a-z]/.test(p.document.documentElement.nodeName);var E=(p.document.getElementsByTagName('title')[0]&&p.document.getElementsByTagName('title')[0].text.replace(/</g,'&lt;').replace(/>/g,'&gt;'))||(p.location.protocol+'//'+p.location.host+p.location.pathname);var F='<!DOCTYPE html PUBLIC><html><head><title>Snapshot: '+E+'</title>'+'<style type=\'text/css\'>'+'body{padding:0 5px;margin:0;font-family:sans-serif;font-size:.7em;background-color:#FFF;color:#000;}#content{white-space:pre-wrap}ol{color:#999;}span{color:#000}.tag{color:#05F}.attrTitle{color:#E00}.attrValue{color:#C0C}.attrDoc{color:#800080}.comment{color:green}.line{margin:0;padding:0}.dark{background-color:#FAFAFA}'+'</style></head><body>'+'<ol id=\'content\'>'+C(D)+'</ol></body></html>';var G=window.open('about:blank','_blank',q);var H=G.document;H.write(F);H.close();G.addEventListener('keypress',function(e){if(e.keyCode==27)G.close()},false)})()",,, "News No Body"
Item, "引用到快速回复"="Go to Page, "javascript:{ta=document.getElementsByTagName('textarea');ta[ta.length-1].value+='\n[quote]\n'+document.getSelection()+'\n[/quote]\n';ta[ta.length-1].focus();}",,,"Mail Thread""
;Item, M_HOTCLICK_POPUP_MENU_GOTO_URL	= Go to page, "%t" & Switch to previous page
;Item, " 访问网址(&F) " = Go to Page,"javascript:(function(){var txt=document.getSelection();var txt0=txt.replace(/\s+/g,'').replace(/^[_(]|[,.)]$/g,'').replace(/^[hх]..[pп]:\/\//i,'http://').replace(/^[fф].[pп]:\/\//i,'ftp://').replace(/^ftp\./i,'ftp://ftp.');if(txt0.length>0){if(txt0.match(/^opera:.+/i)){window.open(txt0);return};var temp=txt0.match(/(https?:\/\/)?(.+\.(?:ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|me|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sk|sl|sm|sn|sr|st|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|za|zm|zw|bl|eh|mf|bv|gb|pm|sj|so|um|yt|com|edu|gov|int|mil|net|org|biz|info|pro|name|museum|coop|aero|idv).*)/i);if(temp){temp[1]=temp[1]?temp[1]:'http://';window.open(temp[1]+temp[2])}else{window.open('http://www.baidu.com/baidu?wd='+encodeURIComponent(txt)+'&tn=cnopera&ie=utf-8').focus()}}})();",,,"search"
Item, " 搜索访问(&F) " = Go to Page,"javascript:(function(){var txt=document.getSelection();var txt0=txt.replace(/\s+/g,'').replace(/[(\r\n)|\r|\n]+/g,'').replace(/^[_(]|[,.)]$/g,'').replace(/^[hх]..[pп]:\/\//i,'http://').replace(/^[fф].[pп]:\/\//i,'ftp://').replace(/^ftp\./i,'ftp://ftp.');if(txt0.length>0){if(txt0.match(/^opera:.+/i)){window.open(txt);return};var temp=txt0.match(/(https?:\/\/)?(.+\.(?:cc|cn|hk|um|yt|com|edu|gov|int|mil|net|org|biz|info|pro|name|museum|coop|aero|idv).*)/i);if(temp){temp[1]=temp[1]?temp[1]:'http://';window.open(temp[1]+temp[2])}else{window.open('http://www.baidu.com/baidu?wd='+encodeURIComponent(txt)+'&tn=cnopera&ie=utf-8').focus()}}})();",,,"search"

[Link Selection Popup Menu]
;链接右键菜单
Include,Hotclick Popup Menu

[Link Popup Menu]
;链接右键菜单:右键点击链接的弹出菜单
Item, "移除重定向(&R)"=External action,,,,"none" | Go to Page, "javascript:void(inivar='%l')" & Go to page, "javascript:(function(){var t,i,j,p;t=window.inivar;if(!t){return};if(/rdrct\.com/.test(t)){t=t.replace(/(\/\/)rdrct\.com\/(http:\/\/)?/i,'$1');var tt=document.createElement('textarea');tt.style='position:fixed;opacity:0; left:0;top:0; z-index:-999;';tt.value=t;document.documentElement.appendChild(tt);tt.focus();tt.setSelectionRange(0, tt.value.length); setTimeout(function(){document.documentElement.removeChild(tt)},200);setTimeout(function(){window.open()},50);}else{t=unescape(t);i=t.lastIndexOf('http');if(i>0){t=t.substring(i);j=t.indexOf('&');if(j>0)t=t.substring(0,j);p=/https?\:\/\/[^\s]*[^.,;'x22>\s\)\]]/.exec(unescape(t));};w=window.open(t);}})();",-2,"Remove Redirects","none" & delay,1 & copy & delay,1 & delay,100 & Go to page,"javascript:(function(){if(location.hostname!=''){return;}else{location.href='%c';}})()"
Item, "后台打开内嵌URL"="Go to Page,"javascript:(function(){var l,i;l='%l';i=l.lastIndexOf('http');if(i>0)l=l.substr(i);var w=window.open('');w.location.href=l;})()""
;Item, M_BOOKM_ITEM_POPUP_MENU_OPEN		= Open link, -2, "urlinfo"
;Item, MI_IDM_MENU_PAGEBAR_LINK_IN_NEW_PAGE	= Open link in new page, -2, "urlinfo"
Item, MI_IDM_MENU_PAGEBAR_LINK_IN_BG_PAGE	= Open link in background page, -2, "urlinfo"
Item, MI_IDM_HLITEM_GET_IN_NEW_WINDOW		= Open link in new window, -2, "urlinfo"
;Item, M_OPEN_BACKGROUND_WINDOW		        = Open link in background window, -2, "urlinfo"
Item, 在隐身标签中打开=new private page,,,,"Window Private Icon" & go to page, "%l"
;Item, 在隐身窗口中打开=new private browser window,,,,"Window Private Icon" & go to page, "%l"
--------------------1
Platform Windows, item, "IE打开"=Execute program, "iexplore.exe","%l",,"Trust Information"
;Platform Windows, item, "世界之窗打开"="Execute program, "optools\TheWorld.exe", "%l",,"tw""
--------------------2
Item, M_LINKS_PANEL_BOOKMARK_LINK	= Add link to bookmarks, -2, "urlinfo"
Item, MI_IDM_POPUP_LINK_ADDRESS		= Copy link, -2, "urlinfo"
Item, MI_IDM_SAVELINKDOCAS		= Save link, -2, "urlinfo"
Item, M_SAVE_LINK_TO_DOWNLOAD_FOLDER	= Download url, -2, "urlinfo"
;Platform Windows, Item, 使用oGet下载="Go to Page, "javascript:void(inivar='%l')" & Go to Page, "javascript:(function(){var encodeBase64=function(a){var b,c,d,e='',f=[],i=0,j=0,g=0,h='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='.split('');while(g=a.charCodeAt(j++)){if(g<128){f[f.length]=g}else if(g<2048){f[f.length]=192|(g>>6);f[f.length]=128|(g&63)}else if(g<65536){f[f.length]=224|(g>>12);f[f.length]=128|((g>>6)&63);f[f.length]=128|(g&63)}else{f[f.length]=240|(g>>18);f[f.length]=128|((g>>12)&63);f[f.length]=128|((g>>6)&63);f[f.length]=128|(g&63)}};while(i<f.length){b=f[i++];c=f[i++];d=f[i++];e+=h[b>>2];e+=h[((b&3)<<4)|(c>>4)];e+=h[c===undefined?64:((c&15)<<2)|(d>>6)];e+=h[d===undefined?64:d&63]};return e};var getTLD=function(domain){if(!domain)return;if(/^(?:\d{1,3}\.){3}\d{1,3}$/.test(domain))return domain;var a=domain.split('.');var l=a.length;return(l<3)?domain:(a[l-2]+'.'+a[l-1])};var hostName=function(link){var a=document.createElement('a');a.href=link;return(a.host.length<a.hostname.length)?a.host:a.hostname};var rn='\r\n',ele=document.activeElement;var link=ele&&ele.href;var txt=document.getSelection()||(link?ele.innerText:'');if(!link)link=window.inivar;window.inivar=null;if(txt)txt=txt.replace(/\s/g,' ').replace(/^\s+|\s+$/g,'').replace(/\x22/g,'\x27');var cookie=(document.cookie)?document.cookie+'; ':'';var src='data:text/ogt;charset=UTF-8;base64,'+encodeBase64('1;My_Download_Manager;0;;'+rn+location.href+rn+link+rn+txt+rn+cookie+rn+rn+rn);if(top==self){var f=document.createElement('iframe');f.width=0;f.height=0;f.frameBorder='no';f.scrolling='no';document.documentElement.appendChild(f);f.src=src;setTimeout(function(){f.parentNode.removeChild(f)},1)}else{location.href=src}})()",,,"Save" "
Include,eDown Link Menu
--------------------3
GhostItem, M_INSPECT_ELEMENT = Inspect element

[Print Menu]
;打印菜单完善
Item, MI_IDM_Print				= Print document,,,,"Menu Print"
Platform Windows, Item, MI_IDM_PRINT_SCALEMARGINS	= Show print options
Platform Windows-Unix, Item, MI_IDM_PRINT_PREVIEW_MODE			= Show print preview as screen | Show print preview one frame per sheet | Show print preview active frame | Leave print preview
--------------------1
Item, "PrintWhatULike"=Go to page, "javascript:(function(){if(window['ppw']&&ppw['bookmarklet']){ppw.bookmarklet.toggle();}else{window._pwyl_home='http://www.printwhatyoulike.com/';window._pwyl_pro_id=null;window._pwyl_bmkl=document.createElement('script');window._pwyl_bmkl.setAttribute('type','text/javascript');window._pwyl_bmkl.setAttribute('src',window._pwyl_home+'static/compressed/pwyl_bookmarklet_10.js');window._pwyl_bmkl.setAttribute('pwyl','true');document.getElementsByTagName('head')[0].appendChild(window._pwyl_bmkl);}})();", 1, , "printwhatyoulike""
Item, "Print Friendly"=Go to page, "javascript:(function(){if(window['priFri']){window.print()}else{pfstyle='nbk';_pnicer_script=document.createElement('SCRIPT');_pnicer_script.type='text/javascript';_pnicer_script.src='http://cdn.printfriendly.com/printfriendly.js?x='+(Math.random());document.getElementsByTagName('head')[0].appendChild(_pnicer_script);}})();", 1, , "Menu Print""
--------------------2
item, "Save PDF"="External action, , , "download as pdf", "Mail Attachment" | Go to page, "javascript:(function(){location.href='http://jude.im/tl/html2pdf.php?api=true&format=pdf&url='+encodeURIComponent('%u');})();", , "download as pdf", "Mail Attachment""
item, Save PNG=go to page,"javascript:(function(){location.href='http://jude.im/tl/html2pdf.php?api=true&qlt=50&format=png&url='+encodeURIComponent('%u');})();",,download as png,Right Arrow
item, Save JPG=go to page,"javascript:(function(){location.href='http://jude.im/tl/html2pdf.php?api=true&qlt=50&format=jpg&url='+encodeURIComponent('%u');})();",,download as jpg,Right Arrow

;--------------------SimpleU右键菜单
[SimpleU Menu]
Include,AdBlock Menu
Item, 字符小工具(&K)=External action,,,,"News Unread" | Go to Page, "javascript:void(inivar='%t')" & Go to page, "javascript: (function(){var str = document.getSelection() || window.inivar;if(str){function strlen(str){return str.length;}function strchlen(str){var counter;var i;counter=0;for(i=0;i<str.length;i++){if(str.charCodeAt(i)>255){counter++;}}return counter;}function strenlen(str){var counter;var i;counter=0;for(i=0;i<str.length;i++){while(str.charAt(i)==' '||str.charCodeAt(i)>255) i++;if(str.charAt(i+1)==' '||str.charCodeAt(i+1)>255||i==str.length-1) counter++;}  return counter;}function count(){var txt=window.getSelection().toString();var lenall=strlen(txt);var lench=strchlen(txt);var lenen=strenlen(txt);var msg='字数统计\n\n字符总数: '+lenall+'\n中文字符: '+lench+'\n英文（数字）词组: '+lenen;alert(msg);}count();}else{var str=prompt('划选文字后使用统计字数；输入数字+px改变本页字体大小；非数字进行EncodeURL编码；输入的字符串后面加空格再加r，会将字符串倒过来；清空输入框会提取SkyDrive永久链。','13px');if(str.match(/(\sr$)/i)){str=str.substring(0,(str.length-2));prompt('result', str.split('').reverse().join(''))}else if(str.match(/(^\s*\d+(p(x||t)){0,1}$)/i)){for(i=0;i<document.getElementsByTagName('*').length;i++)void(document.getElementsByTagName('*')[i].style.fontSize=str);}else if(str != null && str != ''){prompt('result',encodeURI(str))}else{try{prompt('skydrive永久链', 'http://storage.live.com/items/' + (location.hash ? location.hash : selfPageData.currentItemHash).replace('#resId/', '') + '?filename=' + encodeURI(selfPageData.currentItem.fileName));}catch(err){alert('获取错误')}};}})();",,,"none"
;编码（base64编码与解码不支持中文，如果解码后是颠倒的网址，会自动修正）、进制转换；反向输出字符；临时调整页面字体大小；颜色代码互换；提取skydrive永久链、转换图标为base64代码
Item, "抽出图片"=go to page,"javascript:(function(){var images=document.images;if(images.length==0){alert('本页没有图片的说');return;};var limit=prompt('请输入图片大小限制\n0为不限制大小\n否则输入 宽度 高度\n如:500 200(请用半角空格分隔)','0');if(limit==null){return;};if(limit==0){var iwidth=iheight=0;}else{var ab=limit.split(' ');var iwidth=ab[0],iheight=ab[1]};var t='';for(var i=0; i<images.length;i++){if(images[i].width>=iwidth && images[i].height>=iheight){t+='<tr><td><img '+'src='+images[i].src+' /></td><td>'+images[i].width+'</td><td>'+images[i].height+'</td><td>'+images[i].src+'</td</tr>'}};if(t.length==0){alert('没有符合条件的图片');retrun;};var np=window.open('','','width=1024,height=600');np.document.open('text/html','replace');np.document.write('<html><head><style type='+'text/css'+'>th{border:2px solid red;}td{border:1px solid #ccc;}</style></head><body><table>'+'<tr><th>图片</th><th>宽</th><th>高</th><th>URL</th></tr>'+t+'</table></body></html>');np.document.close();})()",,,"Mail Compose Images"
Item, "Google快照" ="Go to page,"https://webcache.googleusercontent.com/search?client=opera&rls=zh-cn&sourceid=opera&q=cache:%u",,,"google""
Item,"移除重定向(&R)"=External action,,,,"none" | Go to page, "javascript:(function(){var q=document.getSelection();if(!q){var k,x,t,i,j,p; for(k=0;x=document.links[k];k++){t=x.href.replace(/[%]3A/ig,':').replace(/[%]2f/ig,'/');t = unescape(t);i=t.lastIndexOf('http');if(i>0){ t=t.substring(i); j=t.indexOf('&'); if(j>0)t=t.substring(0,j); p=/https?\:\/\/[^\s]*[^.,;'x22>\s\)\]]/.exec(unescape(t)); if(p) x.href=p[0]; } else if (x.onmouseover&&x.onmouseout){x.onmouseover(); if (window.status && window.status.indexOf('://')!=-1)x.href=window.status; x.onmouseout(); } x.onmouseover=null; x.onmouseout=null; }}else{var i,l;var urlstr='';var sel=document.createElement('div'); sel.appendChild(window.getSelection().getRangeAt(0).cloneContents());var dl=sel.getElementsByTagName('a');var dp=sel.getElementsByTagName('IMG');for(i=0;i<dl.length;i++){l=dl[i];if(l.href.match(/^http:\/\/(vod\.)?lixian\.vip\.xunlei\.com/i)){if(/&cid=/i.test(l.href)){l.href=l.href.replace(/^h.*furl=/g,'').replace(/&cid=.+$/g,'');urlstr=urlstr+'\n'+decodeURI(l.href)+'\n'}else if(/^h.*(&f|down_)url=thunder/.test(l.href)){l.href=decodeURIComponent(l.href);l.href=l.href.replace(/^h.*(&f|down_)url=/g,'').replace(/(==?).*$/i,'$1');urlstr=urlstr+'\n'+l.href+'\n'}else{l.href=l.href.replace(/^h.*&furl=/g,'').replace(/&s=.+$/g,'').replace(/[%]3A/ig,':').replace(/[%]2f/ig,'/').replace(/[%]25/ig,'%');urlstr=urlstr+'\n'+l.href+'\n'}}else if(l.href.match(/^(ed2k|magnet|thunder):|\.(rm|rmvb|avi|vob|mpeg|dat|wmv|asf|mov|qt|mkv|flv|mp3|mp4|3gp|f4v|zip|rar|7z|iso|torrent)$/i)){l.href=l.href.replace(/.*((http|ftp):)/i,'$1');urlstr=urlstr+'\n'+l.href+'\n'};};if(!urlstr){for(i=0;i<dp.length;i++){p=dp[i].src;ph=dp[i].height;if(p.match(location.hostname)&&p.match(/\.gif$/i)&&ph<100){p=''};if(p){urlstr=urlstr+'\n'+p+'\n'}}};q=q.replace(/\s/g,'').replace(/([^=])(http|ftp|ed2k|magnet|thunder)/g,'$1\n$2');if(!urlstr){urlstr=q};var t=document.createElement('textarea');t.style='position:fixed;opacity:0; left:0;top:0; z-index:-999;';t.value=urlstr;document.documentElement.appendChild(t);t.focus();t.setSelectionRange(0, t.value.length); setTimeout(function(){document.documentElement.removeChild(t)},200)}})();",1,"Remove Redirects", "none" & delay,1 & delay,100 & copy
;将页面内的重定向链接还原；将选中的可下载链接复制到剪切板；如果没有可下载链接，把选中的图片网址复制到剪切板；如果没有图片网址，把选中部分去掉所有空格后复制到剪切板。
Item,"高亮关键字(&H)"=Go to page, "javascript:(function(){var count=0,text,dv;text=document.getSelection();if(!text)text=prompt('关键字:','');if(text==null || text.length==0)return;dv=document.defaultView;function searchWithinNode(node,te,len){var pos,skip,spannode,middlebit,endbit,middleclone;skip=0;if(node.nodeType==3){pos=node.data.toUpperCase().indexOf(te);if(pos>=0){spannode=document.createElement('SPAN');spannode.style.backgroundColor='yellow';spannode.style.color='black';middlebit=node.splitText(pos);endbit=middlebit.splitText(len);middleclone=middlebit.cloneNode(true);spannode.appendChild(middleclone);middlebit.parentNode.replaceChild(spannode,middlebit);++count;skip=1;}}else if(node.nodeType==1&& node.childNodes && node.tagName.toUpperCase()!='SCRIPT' && node.tagName.toUpperCase!='STYLE'){for (var child=0;child<node.childNodes.length;++child){child=child+searchWithinNode(node.childNodes[child],te,len);}}return skip;};searchWithinNode(document.body,text.toUpperCase(),text.length);})();", , , "none"
Item,"后台打开链接(&L)"=Go to page, "javascript:(function(){if(!document.getSelection()){function tn(e){e=e?e:window.event; open(this.href); focus(); return false;} var dl=document.links, i; for (i=0;i<dl.length;++i) dl[i].onclick=tn;}else{var sel=document.createElement('div');sel.appendChild(window.getSelection().getRangeAt(0).cloneContents());var dl=sel.getElementsByTagName('a');var dp=sel.getElementsByTagName('IMG');var timer = null;timer = setInterval(open_ext, 100);function open_ext(){clearInterval(timer);if(dl.length>=dp.length){for(i=0;i<dl.length;i++){l=dl[i];if(l.protocol!='javascript:'&&l.protocol!='mailto:'){window.open(l,l).blur();}};return;}else{for(i=0;i<dp.length;i++){p=dp[i].src;ph=dp[i].height;if(p.match(location.hostname)&&p.match(/\.gif$/i)&&ph<100){p=''};if(p){window.open(p,p).blur();};};}}}})();",,,"none"
;页面上所有链接点击均在后台打开；将所选链接或图片单独在后台打开
Item, ">> 简体中文"="Go to page, "javascript:location='http://translate.google.com/translate?u=' + encodeURIComponent(location);",,,"translation""
;Item, "自动检测 > 中文..."="Go to Page,"javascript:(function(){var s=encodeURIComponent('%u');if(s.length>0){s='http://translate.google.com/translate?u='+s+'&langpair=auto'+encodeURIComponent('|')+'zh-CN&hl=zh-CN&ie=UTF8';void open(s,'');}})()",,,"translation""
Item, ">> 英语"="Go to Page,"javascript:(function(){var s=encodeURIComponent('%u');if(s.length>0){s='http://translate.google.com/translate?u='+s+'&langpair=auto'+encodeURIComponent('|')+'en&hl=en&ie=UTF8';void open(s,'');}})()",,,"translation""

[Page Elements Menu]
Item, "列出当前页图片元素"="Go to Page,"javascript:(function(){var el_title=' Images';var t_top='<div style=\'font:bold 8pt Tahoma;padding:3px;margin:0 0 3px;border-bottom:1px solid #eee;background:yellow;cursor:hand;\' onclick=\'document.getElementById(\u0022iSpace\u0022).style.display=(document.getElementById(\u0022iSpace\u0022).style.display==\u0022none\u0022)?\u0022block\u0022:\u0022none\u0022;this.innerText=(this.innerText.charCodeAt(0)==45)?this.innerText.replace(\u0022-\u0022,\u0022+\u0022):this.innerText.replace(\u0022+\u0022,\u0022-\u0022);this.scrollIntoView();\'>';var t_row='<table style=\'width: 100%%\'><tr><td style=\'font-size:8pt;\'><a href=\'iSpace\' style=\'padding:8px 0 2px;font:8pt;font-family:Tahoma;\' target=\'_blank\'>iSpace</a></td><td style=\'width: 450px;text-align:right;\'><div style=\'overflow:hidden\'><img src=\'iSpace\' style=\'max-height:200px;max-width:450px;\' /></div></td></tr></table><div style=\'height:1px;background-color:#eee;margin:0 0 5px;\'></div>';var es_linked='';var i_linked=0;try{var es=document.getElementsByTagName('IMG');for(var i=0;i<es.length;i++) {if(es[i].src.length>1 && es_linked.indexOf(es[i].src)==-1) {es_linked+=t_row.replace(/iSpace/g,es[i].src);i_linked++;}}}catch(e){} es_linked=((es_linked!='')?('<div id=\'es_linked\'>'+es_linked+'</div>'):'');es_linked=((es_linked!='')?(t_top.replace(/iSpace/g,'es_linked')+'- Foreground'+el_title+' ('+i_linked+'): </div>'):'')+es_linked; var es_anchored='';var i_anchored=0;try{var es=document.getElementsByTagName('A');for(var i=0;i<es.length;i++) {if(es[i].href && es[i].href.search(/javascript:/i)<0 && es[i].innerHTML.indexOf('UserJS ExtraLinks')<0 && es[i].href.match(/\.(jpg|gif|jpeg|png|bmp|tif)/) && es_anchored.indexOf(es[i].href)<0) {es_anchored+=t_row.replace(/iSpace/g,es[i].href);i_anchored++;}}}catch(e){} es_anchored=((es_anchored!='')?('<div id=\'es_anchored\'>'+es_anchored+'</div>'):'');es_anchored=((es_anchored!='')?(t_top.replace(/iSpace/g,'es_anchored')+'- Anchored'+el_title+' ('+i_anchored+'): </div>'):'')+es_anchored; var es_bground='';var i_bground=0;try{es=document.getElementsByTagName('*');for (var i=0;i<es.length;i++) {if(es[i].style && es[i].style.background){var rule=es[i].style.background;var i_start=rule.search(/url\(/i);if(i_start>-1){i_start=i_start+4;var i_end=rule.indexOf(')',i_start);var i_url=((i_end>i_start)?rule.substring(i_start,i_end):'');i_url=i_url.replace(/\u0022/g, '').replace(/\u0027/g, '');if(es_bground.indexOf(i_url)<0 && i_url.indexOf('base64')<0 && i_url!=''){i_bground++;es_bground+=t_row.replace(/iSpace/g,i_url);}}}}}catch(e){}try{es=document.getElementsByTagName('*');for (var i=0;i<es.length;i++) {if(es[i].getAttribute('background')){var i_url=es[i].getAttribute('background');if(es_bground.indexOf(i_url)<0 && i_url!=''){i_bground++;es_bground+=t_row.replace(/iSpace/g,i_url);}}}}catch(e){}try{es=document.getElementsByTagName('input');for (var i=0;i<es.length;i++) {if(es[i].getAttribute('type').toLowerCase()=='image'){var i_url=es[i].getAttribute('src');if(es_bground.indexOf(i_url)<0 && i_url!=''){i_bground++;es_bground+=t_row.replace(/iSpace/g,i_url);}}}}catch(e){}try{es=(document.styleSheets)?document.styleSheets:'';for (i=0;i<es.length;i++){for (j=0;j<es[i].cssRules.length;j++){if(!es[i].cssRules[j].selectorText) {try{var ses=es[i].cssRules[j].styleSheet;for (k=0;k<ses.cssRules.length;k++){var rule=ses.cssRules[k].cssText;var i_start=rule.search(/url\(/i);if(i_start>-1){i_start=i_start+4;var i_end=rule.indexOf(')',i_start);var i_url=((i_end>i_start)?rule.substring(i_start,i_end):'');i_url=i_url.replace(/\u0022/g, '').replace(/\u0027/g, '');if(es_bground.indexOf(i_url)<0 && i_url.indexOf('base64')<0 && i_url!=''){i_bground++;es_bground+=t_row.replace(/iSpace/g,i_url);}}}}catch(e){}}else {var rule=es[i].cssRules[j].cssText;var i_start=rule.search(/url\(/i);if(i_start>-1){i_start=i_start+4;var i_end=rule.indexOf(')',i_start);var i_url=((i_end>i_start)?rule.substring(i_start,i_end):'');i_url=i_url.replace(/\u0022/g, '').replace(/\u0027/g, '');if(es_bground.indexOf(i_url)<0 && i_url.indexOf('base64')<0 && i_url!=''){i_bground++;es_bground+=t_row.replace(/iSpace/g,i_url);}}}}}}catch(e){}es_bground=((es_bground!='')?('<div id=\'es_bground\'>'+es_bground+'</div>'):'');es_bground=((es_bground!='')?(t_top.replace(/iSpace/g,'es_bground')+'- Background'+el_title+' ('+i_bground+'): </div>'):'')+es_bground;if(es_linked=='' && es_bground=='' && es_anchored==''){return;}var w=window.open('');var doc=w.document.body;doc.outerHTML='<head><meta http-equiv=\'Content-Type\' content=\'text/html;charset=utf-8\' /><title>'+document.title+' - '+el_title+'</title></head><body style=\'padding:0;margin:0 10%%;background:#dfdfdf;font:8pt Tahoma;\'><div style=\'border:1px solid silver;\'><div style=\'height:5px;background:#900;\'></div><div style=\'height:12px;padding:16px;border-bottom:1px solid silver;background:#f5f5f5;\'><div style=\'width:80%%;font-size:10.5pt;font-weight:bold;float:left;white-space:nowrap;overflow:hidden;\'>'+document.title+'</div><div style=\'font: normal 8pt tahoma;float:right;\'>'+el_title+'</div></div><div style=\'background-color:white;padding:8px;\'>'+es_anchored+es_linked+es_bground+'</div></div></body>';})()",,,"Enable Display Images""
Item, "显示Javascript脚本"="Go to Page,"javascript:(function(){var es=document.getElementsByTagName('SCRIPT');if(es.length==0){return};var es_inline='';var es_linked='';var i_linked=0;var i_inline=0;var el_title='Client-side Scripts';var s='';for(var i=0;i<es.length;i++){if(es[i].src.length>1 && es_linked.indexOf(es[i].src)==-1){es_linked+='<a href=\''+es[i].src+'\' style=\'display:block;white-space:nowrap;overflow:hidden;padding:8px 0 2px;font-size:9pt;\' target=\'_blank\'>'+es[i].src+'</a><iframe src=\''+es[i].src+'\' style=\'border:1px solid #ccc;width:100%%;\'></iframe><br />';i_linked++;}else{s=es[i].outerHTML;s=s.replace(/^\s*\n|\s*$/g, ''); if(s!=''){s=s.replace( /</g, '&lt;' ).replace( />/g, '&gt;' ).replace( /\[/g, '&#91;' ).replace( /\]/g, '&#93;' ).replace( /\r\n/g, '<br />' ).replace( /\n/g, '<br />' );es_inline+='<div style=\'border:1px solid #ccc;background:#fcfcfc;font:9pt ,Curier !important;white-space:nowrap;overflow:auto;margin:0 0 8pt;color:green;padding:3px;\'>'+s+'</div>';i_inline++;}}}es_inline=((es_inline!='')?('<div id=\'es_inline\'>'+es_inline+'</div>'):'');es_inline=((es_inline!='')?('<div style=\'font:bold 8pt Tahoma;padding:3px;margin:0 0 3px;border-bottom:1px solid #eee;background:yellow;cursor:hand;\' onclick=\'document.getElementById(\u0022es_inline\u0022).style.display=(document.getElementById(\u0022es_inline\u0022).style.display==\u0022none\u0022)?\u0022block\u0022:\u0022none\u0022;this.innerText=(this.innerText.charCodeAt(0)==45)?this.innerText.replace(\u0022-\u0022,\u0022+\u0022):this.innerText.replace(\u0022+\u0022,\u0022-\u0022);this.scrollIntoView();\'>- Inline Scripts'+' ('+i_inline+'): </div>'):'')+es_inline;es_linked=((es_linked!='')?('<div id=\'es_linked\'>'+es_linked+'</div>'):'');es_linked=((es_linked!='')?('<div style=\'font:bold 8pt Tahoma;padding:3px;margin-top:3px;border-bottom:1px solid #eee;background:yellow;cursor:hand;\' onclick=\'document.getElementById(\u0022es_linked\u0022).style.display=(document.getElementById(\u0022es_linked\u0022).style.display==\u0022none\u0022)?\u0022block\u0022:\u0022none\u0022;this.innerText=(this.innerText.charCodeAt(0)==45)?this.innerText.replace(\u0022-\u0022,\u0022+\u0022):this.innerText.replace(\u0022+\u0022,\u0022-\u0022);this.scrollIntoView();\'>- External Scripts'+' ('+i_linked+'): </div>'):'')+es_linked;var w=window.open('');var doc=w.document.body;doc.outerHTML='<head><meta http-equiv=\'Content-Type\' content=\'text/html; charset=utf-8\' /><title>'+document.title+' - '+el_title+'</title></head><body style=\'padding:0;margin:0 10%%;background:#dfdfdf;font:8pt Tahoma;\'><div style=\'border:1px solid silver;\'><div style=\'height:5px;background:#900;\'></div><div style=\'height:12px;padding:16px;border-bottom:1px solid silver;background:#f5f5f5;\'><div style=\'width:80%%;font-size:10.5pt;font-weight:bold;float:left;white-space:nowrap;overflow:hidden;\'>'+document.title+'</div><div style=\'font: normal 8pt tahoma;float:right;\'>'+el_title+'</div></div><div style=\'background-color:white;padding:8px;\'>'+es_inline+es_linked+'</div></div></body>';})()",,,"Set label""
Item, "Javascript变量函数"="Go to Page,"javascript:(function(){var%20x,d,i,v,st;%20x=open();%20d=x.document;%20d.open();%20function%20hE(s){s=s.replace(/&/g,%22&amp;%22);s=s.replace(/>/g,%22&gt;%22);s=s.replace(/</g,%22&lt;%22);return%20s;}%20d.write(%22<style>td{vertical-align:top;%20white-space:pre;%20}%20table,td,th%20{%20border:%201px%20solid%20#ccc;%20}%20div.er%20{%20color:red%20}</style><table%20border=1><thead><tr><th>Variable</th><th>Type</th><th>Value%20as%20string</th></tr></thead>%22);%20for%20(i%20in%20window)%20{%20if%20(!(i%20in%20x)%20)%20{%20v=window%5Bi%5D;%20d.write(%22<tr><td>%22%20+%20hE(i)%20+%20%22</td><td>%22%20+%20hE(typeof(window%5Bi%5D))%20+%20%22</td><td>%22);%20if%20(v===null)%20d.write(%22null%22);%20else%20if%20(v===undefined)%20d.write(%22undefined%22);%20else%20try{st=v.toString();%20if%20(st.length)d.write(hE(v.toString()));%20else%20d.write(%22 %22)}catch(er){d.write(%22<div%20class=er>%22+hE(er.toString())+%22</div>%22)};%20d.write(%22</pre></td></tr>%22);%20}%20}%20d.write(%22</table>%22);%20d.close();%20})();",,,"News No Body""
Item, "UserCss网页样式表"="Go to Page,"javascript:(function() {var es_inline='';var es_linked='';var i_linked=0;var i_inline=0;var el_title='Style Sheets';var es=document.getElementsByTagName('LINK');for(var i=0;i<es.length;i++) {if(es[i].rel.toLowerCase()=='stylesheet' && es_linked.indexOf(es[i].href)==-1) {es_linked+='<a href=\''+es[i].href+'\' style=\'display:block;white-space:nowrap;overflow:hidden;padding:8px 0 2px;font-size:8pt;\' target=\'_blank\'>'+es[i].href+'</a><iframe src=\''+es[i].href+'\' style=\'border:1px solid #ccc;width:100%%;\'></iframe><br />';i_linked++;}}es=document.getElementsByTagName('STYLE');var s='';for(var i=0;i<es.length;i++) {s=es[i].innerHTML;s=s.replace(/^\s*\n|\s*$/g, '').replace(/\r/g, '');if(s!='') {s=s.replace( /</g, '&lt;' ).replace( />/g, '&gt;' ).replace( /\[/g, '&#91;' ).replace( /\]/g, '&#93;' );if(s.indexOf('@import')>-1){var m=s.split('\n');for(var j=0;j<m.length;j++) {var u=(m[j].indexOf('@import')>-1 && m[j].indexOf('url(')>-1)?m[j].replace(/.*@import.*url\(/,'').replace(/\).*/,''):((m[j].indexOf('@import')>-1)?m[j].replace(/.*@import\s*/,'').replace(/\s*;.*|\r|\n/,''):'');u=u.replace(/\u0022/g, '').replace(/\u0027/g, '');if(u!=''){s=s.replace(u,'<a style=\'font:8pt;font-family:Tahoma;\' target=\'_blank\' href=\''+u+'\'>'+u+'</a>');}}}s=s.replace( /\}/g, '}\n' );while(s!=s.replace( /\n\n/g, '\n' )){s=s.replace( /\n\n/g, '\n' );}s=s.replace( /\n/g, '<br />' ).replace( /\n/g, '<br />' );es_inline+='<div style=\'border:1px solid #ccc;background:#fcfcfc;font:9pt ;white-space:nowrap;overflow:auto;margin:0 0 8pt;color:green;padding:3px;\'>'+s+'</div>';i_inline++;}}if(i_linked==0&&i_inline==0) {return}es_inline=((es_inline!='')?('<div id=\'es_inline\'>'+es_inline+'</div>'):'');es_inline=((es_inline!='')?('<div style=\'font:bold 8pt Tahoma;padding:3px;margin:0 0 3px;border-bottom:1px solid #eee;background:yellow;cursor:hand;\' onclick=\'document.getElementById(\u0022es_inline\u0022).style.display=(document.getElementById(\u0022es_inline\u0022).style.display==\u0022none\u0022)?\u0022block\u0022:\u0022none\u0022;this.innerText=(this.innerText.charCodeAt(0)==45)?this.innerText.replace(\u0022-\u0022,\u0022+\u0022):this.innerText.replace(\u0022+\u0022,\u0022-\u0022);this.scrollIntoView();\'>- Inline Styles'+' ('+i_inline+'): </div>'):'')+es_inline;es_linked=((es_linked!='')?('<div id=\'es_linked\'>'+es_linked+'</div>'):'');es_linked=((es_linked!='')?('<div style=\'font:bold 8pt Tahoma;padding:3px;margin-top:3px;border-bottom:1px solid #eee;background:yellow;cursor:hand;\' onclick=\'document.getElementById(\u0022es_linked\u0022).style.display=(document.getElementById(\u0022es_linked\u0022).style.display==\u0022none\u0022)?\u0022block\u0022:\u0022none\u0022;this.innerText=(this.innerText.charCodeAt(0)==45)?this.innerText.replace(\u0022-\u0022,\u0022+\u0022):this.innerText.replace(\u0022+\u0022,\u0022-\u0022);this.scrollIntoView();\'>- External Styles'+' ('+i_linked+'): </div>'):'')+es_linked;var w=window.open('');var doc=w.document.body;doc.outerHTML='<head><meta http-equiv=\'Content-Type\' content=\'text/html; charset=utf-8\' /><title>'+document.title+' - '+el_title+'</title></head><body style=\'padding:0;margin:0 10%%;background:#dfdfdf;font:8pt Tahoma;\'><div style=\'border:1px solid silver;\'><div style=\'height:5px;background:#900;\'></div><div style=\'height:12px;padding:16px;border-bottom:1px solid silver;background:#f5f5f5;\'><div style=\'width:80%%;font-size:10.5pt;font-weight:bold;float:left;white-space:nowrap;overflow:hidden;\'>'+document.title+'</div><div style=\'font: normal 8pt tahoma;float:right;\'>'+el_title+'</div></div><div style=\'background-color:white;padding:8px;\'>'+es_inline+es_linked+'</div></div></body>';}())()",,,"Attachment Documents""
Item, "显示iframe内嵌框架"="Go to Page,"javascript:(function(){var es=document.getElementsByTagName('IFRAME');if(es.length==0){return};var es_linked='';var i_linked=0;;var el_title='Inline Frames';for(var i=0;i<es.length;i++){if(es[i].src.length>1 && es_linked.indexOf(es[i].src)==-1){es_linked+='<a href=\''+es[i].src+'\' style=\'display:block;white-space:nowrap;overflow:hidden;padding:8px 0 2px;font-size:8pt;\' target=\'_blank\'>'+es[i].src+'</a><iframe src=\''+es[i].src+'\' style=\'border:1px solid #ccc;width:100%%;\'></iframe><br />';i_linked++;}}if(es_linked!=''){es_linked='<div style=\'font:bold 8pt Tahoma;padding:3px;margin:0 0 3px;border-bottom:1px solid #eee;background:yellow;\'>'+el_title+' ('+i_linked+'): </div>'+es_linked};var w=window.open('');var doc=w.document.body;doc.outerHTML='<head><meta http-equiv=\'Content-Type\' content=\'text/html; charset=utf-8\' /><title>'+document.title+' - '+el_title+'</title></head><body style=\'padding:0;margin:0 10%%;background:#dfdfdf;font:8pt Tahoma;\'><div style=\'border:1px solid silver;\'><div style=\'height:5px;background:#900;\'></div><div style=\'height:12px;padding:16px;border-bottom:1px solid silver;background:#f5f5f5;\'><div style=\'width:80%%;font-size:10.5pt;font-weight:bold;float:left;white-space:nowrap;overflow:hidden;\'>'+document.title+'</div><div style=\'font: normal 8pt tahoma;float:right;\'>'+el_title+'</div></div><div style=\'background-color:white;padding:8px;\'>'+es_linked+'</div></div></body>';})()", , ,"Window Speed Dial Icon""
Item, "查找Flash 嵌入对象"="Go to Page,"javascript:(function(){var es_object='';var i_object=0;var el_title='Embedded Objects';var src='';try{var es=document.selectNodes('//object');var ns='urlmoviefilenamesrc';var n;for(var i=0, o; o=es[i]; i++){var ps=o.selectNodes('param');src='';for(var j=0, p; p=ps[j]; j++){n=p.getAttribute('name')?p.getAttribute('name').toLowerCase():'';if(n!=''&&ns.indexOf(n)>-1){src=p.getAttribute('value');break;}if(src.length>1){break;}}if (src==''){src=o.getAttribute('data')?o.getAttribute('data'):'';}if(src.length>1 && es_object.indexOf(src)<0){es_object+='<a href=\''+src+'\' style=\'display:block;white-space:nowrap;overflow:hidden;padding:8px 0 2px;font-size:8pt;\' target=\'_blank\'>'+src+'</a><div style=\'height:1px;background-color:#eee;margin:0 0 5px;\'></div>';var s=es[i].outerHTML;s=s.replace(/^\s*\n|\s*$/g, '').replace( />\s*</g, '&gt;\n&lt;' ).replace( /</g, '&lt;' ).replace( />/g, '&gt;' ).replace( /\[/g, '&#91;' ).replace( /\]/g, '&#93;' ).replace( /\r\n/g, '<br />' ).replace( /\n/g, '<br />' );es_object+='<div style=\'border:1px solid #ccc;background:#fcfcfc;font:9pt ;white-space:nowrap;overflow:auto;margin:0 0 8pt;color:green;padding:3px;\'>'+s+'</div>';i_object++;}}}catch(e){}try{es=document.selectNodes('//embed');for(var i=0, o; o=es[i]; i++){src=o.getAttribute('src')?o.getAttribute('src'):o.getAttribute('movie')?o.getAttribute('movie'):'';var fvs=o.getAttribute('flashvars')?o.getAttribute('flashvars'):'';if(src!=''&&fvs!=''){src+=src.indexOf('?')>1?('&'+fvs):(fvs!='')?('?'+fvs):'';}if(src.length>1 && es_object.indexOf(src)<0){es_object+='<a href=\''+src+'\' style=\'display:block;white-space:nowrap;overflow:hidden;padding:8px 0 2px;font-size:8pt;\' target=\'_blank\'>'+src+'</a><div style=\'height:1px;background-color:#eee;margin:0 0 5px;\'></div>';var s=es[i].outerHTML;s=s.replace(/^\s*\n|\s*$/g, '').replace( /\s+/g, '\ \n' ).replace( /</g, '&lt;' ).replace( />/g, '&gt;' ).replace( /\[/g, '&#91;' ).replace( /\]/g, '&#93;' ).replace( /\r\n/g, '<br />' ).replace( /\n/g, '<br />' );es_object+='<div style=\'border:1px solid #ccc;background:#fcfcfc;font:9pt ;white-space:nowrap;overflow:auto;margin:0 0 8pt;color:green;padding:3px;\'>'+s+'</div>';i_object++;}}}catch(e){}if(es_object!=''){es_object='<div style=\'font:bold 8pt Tahoma;padding:3px;margin:0 0 3px;border-bottom:1px solid #eee;background:yellow;\'>'+el_title+' ('+i_object+'): </div>'+es_object}else{return;}var w=window.open('');var doc=w.document.body;doc.outerHTML='<head><meta http-equiv=\'Content-Type\' content=\'text/html; charset=utf-8\' /><title>'+document.title+' - '+el_title+'</title></head><body style=\'padding:0;margin:0 10%%;background:#dfdfdf;font-size:9pt;\'><div style=\'border:1px solid silver;\'><div style=\'height:5px;background:#900;\'></div><div style=\'height:12px;padding:16px;border-bottom:1px solid silver;background:#f5f5f5;\'><div style=\'width:80%%;font-size:10.5pt;font-weight:bold;float:left;white-space:nowrap;overflow:hidden;\'>'+document.title+'</div><div style=\'font: normal 8pt tahoma;float:right;\'>'+el_title+'</div></div><div style=\'background-color:white;padding:8px;\'>'+es_object+'</div></div></body>';})()",,,"Mail Attachments""

[Developer Menu]
include,Page Elements Menu
--------------------1
Item, "ViewPage"="Go to Page,"javascript:(function(){var pageinfo='';var alinks='';var simg='';var sbg='';var js_inline='';var js_linked='';var css_inline='';var css_linked='';var if_linked='';var objebd='';var getinfo=function(){var cook='';pageinfo='<table>';var li='</td></tr><tr><td nowrap>';pageinfo+='<tr><td nowrap><b>网站域名:</b></td><td><a href=\'http://'+document.domain+'\'>'+document.domain+'</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=\'http://'+document.domain+'/robots.txt\'>打开站点 Robots.txt (如果存在)</a>'+li;pageinfo+='<b>页面地址:</b></td><td>'+document.location+li;pageinfo+='<b>标题:</b></td><td>'+document.title+li;pageinfo+='<b>编码:</b></td><td>'+document.charset+li;document.charset=document.charset;var metaKey='';var metaDescription='';var t=document.getElementsByTagName('meta');for(var i=0;i<t.length;i++){if(t[i].name.toString().toLowerCase()=='keywords')metaKey+=t[i].content+'<BR>';if(t[i].name.toString().toLowerCase()=='description')metaDescription+=t[i].content+'<BR>';}pageinfo+='<b>关键字:</b></td><td>'+metaKey+li;pageinfo+='<b>描述:</b></td><td>'+metaDescription+li;pageinfo+='<b>网页来源:</b></td><td>';if(!document.referrer){pageinfo+='直接进入'+li}else{pageinfo+='<a href=\''+document.referrer+'\'>'+document.referrer+'</a>'+li};try{pageinfo+='<b>修改日期:</b></td><td>'+document.lastModified+li;}catch(e){pageinfo+='<b>修改日期:</b></td><td>不可用'+li;}cook=document.cookie.replace(/;/g,'<BR>');cook=cook.replace(/\r/g,'<BR>');cook=cook.replace(/\n/g,'<br>');cook=cook.replace(/\&/g,'&amp;');pageinfo+='<b>Cookies:</b><BR></td><td>'+cook+'</td></tr></table>';};var getlinks=function(){var dl=document.links;var i_link=0;for(i=0;i<dl.length;i++){l=dl[i];if(l.protocol!='javascript:'&&l.protocol!='mailto:')alinks += '<br><br>'+l.innerText.replace(/\s/g,' ')+'<br><a href=\''+l.href+'\'>'+l.href+'</a>';i_link++;};alinks='<div class=fdiv0>('+i_link+'): </div>'+alinks;};var getpic=function(){var iimg=0;var t_1='<tr><td><a href=\'';var t_2='\'>';var t_3='</a></td><td style=\'width: 450px;text-align:right;\'><img src=\'';var t_4='\' style=\'max-height:200px;max-width:450px;\' /></td></tr>';try{var o=document.getElementsByTagName('IMG');for(var i=0;i<o.length;i++){if(o[i].src.length>1&&simg.indexOf(o[i].src)==-1){simg+=t_1+o[i].src+t_2+o[i].src+t_3+o[i].src+t_4;iimg++;}}}catch(e){}simg=((simg!='')?('<div id=\'simg\'><table style=\'width: 100%%\'>'+simg+'</table></div>'):'');simg=((simg!='')?('<div class=fdiv0 style=\'cursor:hand;\' onclick=\'document.getElementById(\u0022simg\u0022).style.display=(document.getElementById(\u0022simg\u0022).style.display==\u0022none\u0022)?\u0022block\u0022:\u0022none\u0022;this.innerText=(this.innerText.charCodeAt(0)==45)?this.innerText.replace(\u0022-\u0022,\u0022+\u0022):this.innerText.replace(\u0022+\u0022,\u0022-\u0022);this.scrollIntoView();\'>- 图片 ('+iimg+'): </div>'):'')+simg;var ibg=0;try{o=document.getElementsByTagName('*');for(var i=0;i<o.length;i++){if(o[i].style&&o[i].style.background){var rule=o[i].style.background.toLowerCase();var i_start=rule.indexOf('url(');if(i_start>-1){i_start=i_start+4;var i_end=rule.indexOf(')',i_start);var i_url=((i_end>i_start)?rule.substring(i_start,i_end):'');i_url=i_url.replace(/\u0022/g,'').replace(/\u0027/g,'');if(sbg.indexOf(i_url)<0&&i_url.indexOf('base64')<0&&i_url!=''){ibg++;sbg+=t_1+i_url+t_2+i_url+t_3+i_url+t_4;}}}}}catch(e){}try{o=document.getElementsByTagName('*');for(var i=0;i<o.length;i++){if(o[i].getAttribute('background')){var i_url=o[i].getAttribute('background').toLowerCase();if(sbg.indexOf(i_url)<0&&i_url!=''){ibg++;sbg+=t_1+i_url+t_2+i_url+t_3+i_url+t_4;}}}}catch(e){}try{o=document.getElementsByTagName('input');for(var i=0;i<o.length;i++){if(o[i].getAttribute('type').toLowerCase()=='image'){var i_url=o[i].getAttribute('src').toLowerCase();if(sbg.indexOf(i_url)<0&&i_url!=''){ibg++;sbg+=t_1+i_url+t_2+i_url+t_3+i_url+t_4;}}}}catch(e){}try{o=(document.styleSheets)?document.styleSheets:'';for(i=0;i<o.length;i++){for(j=0;j<o[i].cssRules.length;j++){var rule=o[i].cssRules[j].cssText.toLowerCase();var i_start=rule.indexOf('url(');if(i_start>-1){i_start=i_start+4;var i_end=rule.indexOf(')',i_start);var i_url=((i_end>i_start)?rule.substring(i_start,i_end):'');i_url=i_url.replace(/\u0022/g,'').replace(/\u0027/g,'');if(sbg.indexOf(i_url)<0&&i_url.indexOf('base64')<0&&i_url!=''){ibg++;sbg+=t_1+i_url+t_2+i_url+t_3+i_url+t_4;}}}}}catch(e){}sbg=((sbg!='')?('<div id=\'sbg\'><table sty\'width: 100%%\'>'+sbg+'</table></div>'):'');sbg=((sbg!='')?('<div class=fdiv0 style=\'cursor:hand;\' onclick=\'document.getElementById(\u0022sbg\u0022).style.display=(document.getElementById(\u0022sbg\u0022).style.display==\u0022none\u0022)?\u0022block\u0022:\u0022none\u0022;this.innerText=(this.innerText.charCodeAt(0)==45)?this.innerText.replace(\u0022-\u0022,\u0022+\u0022):this.innerText.replace(\u0022+\u0022,\u0022-\u0022);this.scrollIntoView();\'>- 背景图片 ('+ibg+'): </div>'):'')+sbg;};var getjs=function(){var o=document.getElementsByTagName('SCRIPT');if(o.length==0){return};var i_linked=0;var i_inline=0;var s='';for(var i=0;i<o.length;i++){if(o[i].src.length>1&&js_linked.indexOf(o[i].src)==-1){js_linked+='<a href=\''+o[i].src+'\'>'+o[i].src+'</a><iframe src=\''+o[i].src+'\'></iframe><br />';i_linked++;}else {s=o[i].outerHTML;s=s.replace(/^\s*\n/,'').replace(/\s*$/,'');if(s!=''){s=s.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\[/g,'&#91;').replace(/\]/g,'&#93;').replace(/\r\n/g,'<br />').replace(/\n/g,'<br />');js_inline+='<div class=fdiv5>'+s+'</div>';i_inline++;}}}js_inline=((js_inline!='')?('<div id=\'js_inline\'>'+js_inline+'</div>'):'');js_inline=((js_inline!='')?('<div class=fdiv0 style=\'cursor:hand;\' onclick=\'document.getElementById(\u0022js_inline\u0022).style.display=(document.getElementById(\u0022js_inline\u0022).style.display==\u0022none\u0022)?\u0022block\u0022:\u0022none\u0022;this.innerText=(this.innerText.charCodeAt(0)==45)?this.innerText.replace(\u0022-\u0022,\u0022+\u0022):this.innerText.replace(\u0022+\u0022,\u0022-\u0022);this.scrollIntoView();\'>- 内嵌脚本'+' ('+i_inline+'): </div>'):'')+js_inline;js_linked=((js_linked!='')?('<div id=\'js_linked\'>'+js_linked+'</div>'):'');js_linked=((js_linked!='')?('<div class=fdiv0 style=\'cursor:hand;\' onclick=\'document.getElementById(\u0022js_linked\u0022).style.display=(document.getElementById(\u0022js_linked\u0022).style.display==\u0022none\u0022)?\u0022block\u0022:\u0022none\u0022;this.innerText=(this.innerText.charCodeAt(0)==45)?this.innerText.replace(\u0022-\u0022,\u0022+\u0022):this.innerText.replace(\u0022+\u0022,\u0022-\u0022);this.scrollIntoView();\'>- 外部脚本'+' ('+i_linked+'): </div>'):'')+js_linked;};var getcss=function(){var i_linked=0;var i_inline=0;var o=document.getElementsByTagName('LINK');for(var i=0;i<o.length;i++){if(o[i].rel.toLowerCase()=='stylesheet'&&css_linked.indexOf(o[i].href)==-1){css_linked+='<a href=\''+o[i].href+'\'>'+o[i].href+'</a><iframe src=\''+o[i].href+'\'></iframe><br />';i_linked++;}}o=document.getElementsByTagName('STYLE');var s='';for(var i=0;i<o.length;i++){s=o[i].innerHTML;s=s.replace(/^\s*\n/,'').replace(/\s*$/,'').replace(/\r/g,'');if(s!=''){s=s.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\[/g,'&#91;').replace(/\]/g,'&#93;');if(s.indexOf('@import')>-1){var m=s.split('\n');for(var j=0;j<m.length;j++){var u=(m[j].indexOf('@import')>-1&&m[j].indexOf('url(')>-1)?m[j].replace(/.*@import.*url\(/,'').replace(/\)./,''):((m[j].indexOf('@import')>-1)?m[j].replace(/.*@import\s/,'').replace(/\s*;|\r|\n/,''):'');u=u.replace(/\u0022/g,'').replace(/\u0027/g,'');if(u!=''){s=s.replace(u,'<a style=\'font:8pt;font-family:Tahoma;\' target=\'_blank\' href=\''+u+'\'>'+u+'</a>');}}}s=s.replace(/\}/g,'}\n');while(s!=s.replace(/\n\n/g,'\n')){s=s.replace(/\n\n/g,'\n');}s=s.replace(/\n/g,'<br />').replace(/\n/g,'<br />');css_inline+='<div style=\'border:1px solid #ccc;background-color:#fcfcfc;font:9pt 宋体;white-space:nowrap;overflow:auto;margin-bottom:8pt;color:green;padding:3px;\'>'+s+'</div>';i_inline++;}}if(i_linked==0&&i_inline==0){return}css_inline=((css_inline!='')?('<div id=\'css_inline\'>'+css_inline+'</div>'):'');css_inline=((css_inline!='')?('<div class=fdiv0 style=\'cursor:hand;\' onclick=\'document.getElementById(\u0022css_inline\u0022).style.display=(document.getElementById(\u0022css_inline\u0022).style.display==\u0022none\u0022)?\u0022block\u0022:\u0022none\u0022;this.innerText=(this.innerText.charCodeAt(0)==45)?this.innerText.replace(\u0022-\u0022,\u0022+\u0022):this.innerText.replace(\u0022+\u0022,\u0022-\u0022);ti.crollIntoView();\'>- 内嵌样式'+' ('+i_inline+'): </div>'):'')+css_inline;css_linked=((css_linked!='')?('<div id=\'css_linked\'>'+css_linked+'</div>'):'');css_linked=((css_linked!='')?('<div class=fdiv0 style=\'cursor:hand;\' onclick=\'document.getElementById(\u0022css_linked\u0022).style.display=(document.getElementById(\u0022css_linked\u0022).style.display==\u0022none\u0022)?\u0022block\u0022:\u0022none\u0022;this.innerText=(this.innerText.charCodeAt(0)==45)?this.innerText.replace(\u0022-\u0022,\u0022+\u0022):this.innerText.replace(\u0022+\u0022,\u0022-\u0022);this.scrollIntoView();\'>- 外部样式表'+' ('+i_linked+'): </div>'):'')+css_linked;};var getobjebd=function(){var i_object=0;var src='';try{var o=document.getElementsByTagName('OBJECT');for(var i=0;i<o.length;i++){var params=o[i].getElementsByTagName('PARAM');src='';for(var p=0;p<params.length;p++){para=params[p].getAttribute('name').toLowerCase();value=params[p].getAttribute('value');if(!para||!value)continue;switch(para){case 'src':case 'filename':case 'url':case 'movie':src=value;break;}if(src.length>1){break;}}if(src==''){src=((o[i].getAttribute('data'))?o[i].getAttribute('data'):'');}if(src.length>1&&objebd.indexOf(src)<0){objebd+='<a href=\''+src+'\'>'+src+'</a><div style=\'height:1px;background-color:#eee;margin-bottom:5px;\'></div>';var s=o[i].outerHTML;s=s.replace(/^\s*\n/,'').replace(/\s*$/,'').replace(/>\s*</g,'&gt;\n&lt;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\[/g,'&#91;').replace(/\]/g,'&#93;').replace(/\r\n/g,'<br />').replace(/\n/g,'<br />');objebd+='<div class=fdiv5>'+s+'</div>';i_object++;}}}catch(e){}try{o=document.getElementsByTagName('EMBED');for(i=0;i<o.length;i++){src=((o[i].getAttribute('src'))?o[i].getAttribute('src'):((o[i].getAttribute('movie'))?o[i].getAttribute('movie'):''));var fvs=((o[i].getAttribute('flashvars'))?o[i].getAttribute('flashvars'):'');if(fvs!=''){src=src+((src.indexOf('?')>1)?('&'+fvs):(fvs!='')?('?'+fvs):'');}if(src.length>1&&objebd.indexOf(src)<0){objebd+='<a href=\''+src+'\'>'+src+'</a><div class=fdiv5></div>';var s=o[i].outerHTML;s=s.replace(/^\s*\n/,'').replace(/\s*$/,'').replace(/\s+/g,'\ \n').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\[/g,'&#91;').replace(/\]/g,'&#93;').replace(/\r\n/g,'<br />').replace(/\n/g,'<br />');objebd+='<div class=fdiv5>'+s+'</div>';i_object++;}}}catch(e){}if(objebd!=''){objebd='<div class=fdiv0>('+i_object+'): </div>'+objebd;}};var getiframe=function(){var o=document.getElementsByTagName('IFRAME');if(o.length==0){return};var i_linked=0;for(var i=0;i<o.length;i++){if(o[i].src.length>1&&if_linked.indexOf(o[i].src)==-1){if_linked+='<a href=\''+o[i].src+'\'>'+o[i].src+'</a><iframe src=\''+o[i].src+'\'></iframe><br />';i_linked++;}}if(if_linked!=''){if_linked='<div class=fdiv0>('+i_linked+'): </div>'+if_linked};};getinfo();getlinks();getpic();getjs();getcss();getobjebd();getiframe();var w=window.open('');w.document.open();w.document.write('<html><head><title></title><meta http-equiv=\'Content-Type\' content=\'text/html; charset=utf-8\' /><style type=\'text/css\'>html, body{background:ThreeDFace;}body{margin:10px;width:auto;height:auto;}iframe{border:1px solid #ccc;width:100%%}.fdiv0{border:1px solid #5E86D7;background-color:#D8E1F5;}.fdiv1{border:1px solid #628118;background-color:#EDFFB5;}.fdiv2{border:1px solid #F9007C;background-color:#FFDEEF;}.fdiv3{border:1px solid #FF7D26;background-color:#FEF1DA;}.fdiv4{border:1px solid #8CBB00;background-color:#F5FFD9;}.fdiv5{border:1px solid #ccc;background-color:#fcfcfc;white-space:nowrap;overflow:auto;margin-bottom:8pt;color:green;padding:3px;}h2{text-align:center;width:150px;}h2 a{display:inline;width:auto;}.tab-pane{position:relative;width:100%%;}.tab-row .tab {cursor:Default;display:inline;margin:1px -2px 1px 2px;float:left;padding:2px 3px 3px 3px;background:ThreeDFace;border:1px solid;border-color:ThreeDHighlight ThreeDDarkShadow ThreeDDarkShadow ThreeDHighlight;border-bottom:0;z-index:1;position:relative;top:0;}.tab-row .tab.selected {border-bottom:0;z-index:3;padding:2px 3px 5px 3px;margin:1px -3px -2px 0px;top:-2px;}.tab-row .tab a {font:12pt;color:WindowText;text-decoration:none;cursor:default;}.tab-row .hover a {color:blue;}.tab-page {height:200px;clear:both;border:1px solid;border-color:ThreeDHighlight ThreeDDarkShadow ThreeDDarkShadow ThreeDHighlight;background:ThreeDFace;z-index:2;position:relative;top:-2px;color:WindowText;padding:10px;}.tab-row {z-index:1;white-space:nowrap;}</style></head><body><base target=_blank><DIV class=\'tab-pane\' id=tabPane1><DIV id=tabrow class=tab-row><H2 name=tabr id=t1 class=\'tab selected\'><A href=\'#\' onClick=\'st(this)\' target=\'_self\'>prop属性</A></H2><H2 name=tabr id=t2 class=tab><A href=\'#\' onClick=\'st(this)\' target=\'_self\'>link链接</A></H2><H2 name=tabr id=t3 class=tab><A href=\'#\' onClick=\'st(this)\' target=\'_self\'>pic图片</A></H2><H2 name=tabr id=t4 class=tab><A href=\'#\' onClick=\'st(this)\' target=\'_self\'>js脚本</A></H2><H2 name=tabr id=t5 class=tab><A href=\'#\' onClick=\'st(this)\' target=\'_self\'>css样式表</A></H2><H2 name=tabr id=t6 class=tab><A href=\'#\' onClick=\'st(this)\' target=\'_self\'>ObjectEmbed对象</A></H2><H2 name=tabr id=t7 class=tab><A href=\'#\' onClick=\'st(this)\' target=\'_self\'>iframe框架</A></H2></DIV><div id=contenttab><DIV name=ct class=tab-page id=ct1 style=\'DISPLAY: block\'>');w.document.write(pageinfo+'</DIV><DIV name=ct class=tab-page id=ct2 style=\'DISPLAY: none\'>'+alinks+'</DIV><DIV name=ct class=tab-page id=ct3 style=\'DISPLAY: none\'>'+simg+sbg+'</DIV><DIV name=ct class=tab-page id=ct4 style=\'DISPLAY: none\'>'+js_inline+js_linked+'</DIV><DIV name=ct class=tab-page id=ct5 style=\'DISPLAY: none\'>'+css_inline+css_linked+'</DIV><DIV name=ct class=tab-page id=ct6 style=\'DISPLAY: none\'>'+objebd+'</DIV><DIV name=ct class=tab-page id=ct7 style=\'DISPLAY: none\'>'+if_linked+'</DIV></div></DIV></body></html><script>function $(id){return document.getElementById(id);}function st(o){var len=7;var pn=o.parentNode;var n=pn.id;for(var i=1;i<len+1;i++){$(\'t\'+i).className=\'tab\';$(\'ct\'+i).style.display=($(\'ct\'+i).id==\'c\'+n)?\'block\':\'none\';}pn.className=\'tab selected\';}</script>');w.document.close();})()",,,"News No Body""
Item, "页面信息"=Go to page, "javascript:(function(){var meta='',scripts='',embed='',iframes='',cookies='';var corrUrl=function(url){if(!url)return'';var q=url.indexOf('?')+1;return((q&&url.length>50)?url.slice(0,q>50?q:50)+'\u2026':url)+'\n'};var fullUrl=function(url){var a=document.createElement('a');a.href=url;return url?corrUrl(a.href):''};var m=document.getElementsByTagName('meta');for(var i=0,mi;mi=m[i];i++){meta+=(mi.name?mi.name+': ':(mi.httpEquiv?mi.httpEquiv+': ':''))+mi.content+'\n'};var s=document.getElementsByTagName('script');for(var i=0,si;si=s[i];i++){if(si.src)scripts+=corrUrl(si.src)};var e=document.getElementsByTagName('embed');var o=document.getElementsByTagName('object');for(var i=0,ei;ei=e[i];i++){embed+=fullUrl(ei.getAttribute('src'))};for(var i=0,oi;oi=o[i];i++){var src=oi.getAttribute('data')||oi.getAttribute('src')||oi.getAttribute('source');if(!src){var params=oi.getElementsByTagName('param');for(var j=0,p;p=params[j];j++){if(p.hasAttribute('name')&&p.getAttribute('name').match(/^(movie|data|src|code|filename|url|source)$/i)){src=p.getAttribute('value');break}}};var lnk=fullUrl(src);if(embed.indexOf(lnk)==-1)embed+=lnk};var f=document.getElementsByTagName('iframe');for(var i=0,fi;fi=f[i];i++){if(fi.src)iframes+=corrUrl(fi.src)};var c=document.cookie.split(';');for(var i=0,ci;ci=c[i];i++){while(ci.charAt(0)==' ')ci=ci.slice(1);if(ci.length>40)ci=ci.slice(0,40)+'\u2026';cookies+=ci+'\n'};var lastmod=(Date.parse(document.lastModified)==0)?'':document.lastModified;var mode=document.getElementsByTagName('HTmL').length==0?'Really strict':(document.compatMode=='CSS1Compat'?'Normal strict':'Quirks');var title=document.title||(document.getElementsByTagName('title')[0]&&document.getElementsByTagName('title')[0].text)||'';if(meta)meta='\nMeta-data:\n'+meta;if(scripts)scripts='\nScripts:\n'+scripts;if(embed)embed='\nEmbed objects:\n'+embed;if(iframes)iframes='\nIframes:\n'+iframes;if(cookies)cookies='\nCookies:\n'+cookies;alert('User-Agent: '+navigator.userAgent+'\n\nTitle: '+title+'\n\nAddress: '+location.href+'\n\nReferrer: '+document.referrer+'\n\nLast Modified: '+lastmod+'\n\nView Mode: '+mode+' mode\n'+meta+scripts+embed+iframes+cookies)})()",,,"News Read"
;Item, "元素边框"="Go to Page,"javascript:(function(){var css='table { border: 1px solid blue ! important; } \n table td { border: 1px solid lightblue ! important; } \n table table { border: 1px solid green ! important; } \n table table td { border: 1px solid lightgreen ! important; } \n table table table { border: 1px solid red ! important; } \n table table table td { border: 1px solid orange ! important; } \n div { border: 1px solid ! important; } \n p { border: 1px dotted ! important; } \n body { background: white ! important; color: black ! important; } \n * { padding: 2px; }\n dl, ol, ul {outline: 1px solid #3366CC !important;} \n dt, dd, li {outline: 1px dashed #7295DC !important;} \n address {outline: 1px dashed #010101 !important;} \n span {outline: 1px dotted #CC0000 !important;} \n thead, tfoot, tbody {outline: 1px dashed #99CC00 !important;} \n tr, th, td {outline: 1px dotted #99CC00 !important;} \n img, object, area {outline: 1px dashed #9966FF !important;} \n form {outline: 1px dotted green !important;}';var heads = document.getElementsByTagName('head');	if (heads.length > 0) {var node = document.createElement('style');node.type = 'text/css';	node.appendChild(document.createTextNode(css));heads[0].appendChild(node); }})();",,,"Mail Attachments""
Item, "Http标头"=Go to page, "javascript:(function(){var req=new XMLHttpRequest();req.open('HEAD',location.href+'?',true);req.onreadystatechange=function(){if(this.readyState==4){alert('Status: '+this.status+' '+this.statusText+'\n'+this.getAllResponseHeaders())}};req.send(null)})()",,,"News Read"
Item, "MODI DOM"="Go to Page,"javascript:prefFile='';void(z=document.body.appendChild(document.createElement('script')));void(z.language='javascript');void(z.type='text/javascript');void(z.src='http://slayeroffice.com/tools/modi/v2.0/modi_v2.0.js');void(z.id='modi');",,,"Menu Info""
Platform Windows, Item, "Test.js" =Execute program,"notepad.exe","profile\script\test.js",,"Set label""
--------------------2
Item, MI_IDM_Kilde				= View document source
GhostItem, MI_IDM_FRAME_SOURCE			= View frame source
Item, M_DOCUMENT_POPUP_MENU_VALIDATE		= Validate frame source
Item, M_JAVASCRIPTCONSOLE			= Show Message console
Item, M_OPERA_DRAGONFLY				= Open Developer Tools Window | Close Developer Tools Window
--------------------3
Item, MI_IDM_PluginsWindow			= Go to page, "opera:plugins",,,"Blank"
Item, MI_IDM_CacheWindow			= Go to page, "javascript:void(window.open('opera:cache?domain='+(function(h){var h=location.hostname;var s=h.split('.');var l=s.length;if(/^(?:\d{1,3}\.){3}\d{1,3}$/.test(h))return h;if(/\.(co|com|net|org|edu|gov|mil|int)\.[^\.]+$/.test(h)){h=s[l-3]+'.'+s[l-2]+'.'+s[l-1]}else{h=s[l-2]+'.'+s[l-1]};return h})(location.hostname)+'&validation=&list=preview&min_size=&max_size='));",,,"search"

[Translate menu]
Item, "Bing词典"="go to page,"javascript:(function(a,b){a.getElementById('bing_cw')||(b=a.createElement('script'),b.id='bing_cw',b.onload=function(){BingCW.Init({MachineTranslation:true,WebDefinition:true})},b.src='http://dict.bing.com.cn/cloudwidget/Scripts/Generated/BingTranslate_Hover_Phrase_Selection_ShowIcon.js',a.head.appendChild(b))}(document))",,,"bing"
Item, "尚译"="Go to page, "javascript:void((function(){if(window.Como&&window.Como.someyi){Como.someyi.open()}else{var a=document.createElement('script');a.setAttribute('type','text/javascript');var b=document.charset?document.charset:document.characterSet;var c=b.toLowerCase()=='gb2312'?'pack-gb2312.js':'pack-utf8.js';a.setAttribute('src','http://yi.comsome.com/'+c);document.getElementsByTagName('head').item(0).appendChild(a);Text.prototype.tagName='#text'}})())",,,"someyi"
Item, "QQ云翻译"=Go to page, "javascript:void((function(d){if(!!d){d.toggle();return;};var src='http://dict.qq.com/cloudgetjs';var e=document.createElement('script');e.setAttribute('src',src);document.getElementsByTagName('head')[0].appendChild(e);})(window.QQCloudDict))", 1, , "qqdict""
Item, "海词翻译"="Go to page, "javascript:(function (){_zdicShow = function(){return false};scriptObj = document.createElement('script');scriptObj.setAttribute('type','text/javascript');scriptObj.setAttribute('src','http://dict.cn/hc/');document.body.appendChild(scriptObj);})()", , ,"dict""
Item, "沪江翻译"=Go to page, "javascript:void((function(){hjelm=document.createElement('script');hjelm.setAttribute('src','http://dict.hjenglish.com/js/dict.js');document.body.appendChild(hjelm);})())",,,"hujiang"

[Simple Search With]
include,Internal Search With
--------------------1
include,Simple Search Menu

[Simple Search Menu]
Item, 多引擎搜索="Go to page, "javascript:void(inivar='%t')",,, "find" & Go to page, "javascript:var lng=window.navigator.language;void(window.open('http://google.'+(lng=='cn'?'cn':'com')+'/search?q='+inivar));" & Go to page, "javascript:void(window.open('http://'+(lng=='cn'?'yandex.ru/yandsearch?rpt=rad&text=':'search.yahoo.com/search?p=')+inivar));" & Go to Page,"javascript:(function(){var h=location.hostname;var site=(h.length>0&&h!='localhost')?' site:'+h.replace(/^(?:www|bbs)\./i, ''):'';var s=encodeURIComponent(window.getSelection().toString().replace(/^\s*|\s*$/g, '')).replace(/^|$/g,'\u0022')+site;if(s.length>3){s='http://www.baidu.com/s?wd='+'+'+s+'&sourceid=opera';void open(s,'');}})()",,,"baidu" & Delay,1 & Switch to previous page""
Item, "Google站内搜索"=External action,,,,"Google" | Go to Page, "javascript:void(inivar='%c')" & Go to Page, "javascript:void(inivar2='%t')" & Go to page, "javascript:(function(){var d=window.inivar;if(!d){d=''};var getText=function(w){var u=w.document,v=u.getSelection(),t=u.querySelectorAll('textarea,input');if(!v)for(var i=0,e;e=t[i];i++){if(v=e.value.substring(e.selectionStart,e.selectionEnd))break}return v};var getSel=function(w){var rez=w?getText(w):'';if(rez==''){for(var i=0,f;f=w.frames[i];i++){try{if(rez=arguments.callee(f))break}catch(e){}}};return rez};var w=window;var q=getSel(w)||window.inivar2;var h=window.location.hostname;if(!q){q=prompt('d:domain',' ')};if(q){if(q.match(/\sd$/i)){x=q.substring(0,(q.length-2));}else if(q.match(/^(d|\s+)$/i)){x=d}else{x=q};if(x.match(/^(\s+)?$/i)){x=d};x=x.replace(/^\s+|\s+$/g,'');if(!x){return};if(q.match(/(\s|^)d$/i)){if(/^(?:\d{1,3}\.){3}\d{1,3}$/.test(h)){}else{var s=h.split('.');h=(s.length<3)?h:h.replace(/[^\.]*\./i,'');}};if(location.hostname!=''){}else{window.close()};window.open('http://www.google.com/search?as_q='+encodeURIComponent(x).replace(/ /g,'+')+'&sitesearch='+h);}})()", 1,"站内","Search Web"
Item, "百度站内搜索"=go to page,"javascript:var ax=prompt('百度站内搜索\n请输入搜索关键字','');if(ax.length>0){window.open('http://www.baidu.com/s?wd=site:'+encodeURIComponent(location.hostname)+' '+encodeURIComponent(ax)+'&tn=cnopera&cl=3&ie=utf-8')};void(0);",,,"baidu"

[Simple BBSWater Menu]
Item,"(づ￣ 3￣)づ"= "Insert,"(づ￣ 3￣)づ，(～￣▽￣)～，ˋ( 〞▽〝)ˊ，╮(￣▽￣'')╭，O(∩_∩)O~，Q口Q，%>_<%，^^b，→_→，—_—""
Item,"占个楼先，一会儿再发表意见"= "Insert,"[img]http://comic.qq.com/images/comic/2008/01/03/april/yct/037.gif[/img]占个楼先，一会儿再发表意见,哼哼哼哼～[img]http://www.2259.com/pic/20105/2010526222819.gif[/img]""
Item,"马克一下,等养肥了在看~~"= "Insert,"马克一下,等养肥了在看~~潜力贴留名.字数补丁.字数补丁..,拿分走人~~[img]http://img2.zol.com.cn/face/mulu/linglei/726595152005.gif[/img]""
Item,"我来数数,字数够了没有,恩,看样子差不多了."= "Insert,"我来数数,字数够了没有,恩,看样子差不多了.[img]http://comic.qq.com/images/comic/2008/01/03/april/yct/042.gif[/img]""
Item,"经鉴定....此贴值得挖坟,你们谁也拦不住我..."= "Insert,"[b][color=red]你们觉得我像是在灌水?经鉴定....此贴值得挖坟,你们谁也拦不住我...[/color][/b][img]http://comic.qq.com/images/comic/2008/01/03/april/yct/050.gif[/img]""
Item,"路过,不明真相的路过..!"= "Insert,"拿分走人~~路过,不明真相的路过..![img]http://img2.zol.com.cn/product/29/270/ceo0ESxHTUTh2.gif[/img]""
Item,"祥瑞御免，家宅平安"= "Insert,"[img]http://comic.qq.com/images/comic/2008/01/03/april/yct/001.gif[/img]，祥瑞御免，家宅平安，阿弥陀佛""
Item,"一个人的马甲!"= "Insert,"LZ，你太年轻， 你太天真了，其实整个论坛只有我一个人，自己一个不停的换着马甲，不停的灌水，制造问题，解决问题，发贴，顶帖....不信的话我换个马甲再给你回个帖子""
Item,"好东西啊，多谢楼主分享\(^o^)/~(&Z)"= "Insert,"好东西啊，多谢楼主分享\(^o^)/~0A，[img]http://www.qqjia.com/learn/b521q/bq16/kaixin_9.gif[/img]顶一下，楼主再接再厉啊d(^o^)b~0A""
Item,"非常感谢分享!"= "Insert,"这个看起来不错哦,呵呵~非常感谢分享!支持一下![img]http://www.qqbase.com/uploads/allimg/080426/0325042.jpg[/img]""

[Simple BBSWaterTool Menu]
Item, "字数统计"=Go to page, "javascript:(function(){var D=document,i,f,j,e;for(i=0;f=D.forms[i];++i)for(j=0;e=f[j];++j)if(e.type=='text'||e.type=='password'||e.tagName.toLowerCase()=='textarea')S(e);function S(e){if(!e.N){var x=D.createElement('span'),s=x.style;s.color='green';s.background='white';s.font='bold 10pt sans-serif';s.verticalAlign='top';e.parentNode.insertBefore(x,e.nextSibling);function u(){x.innerHTML=e.value.length;}u();e.onchange=u;e.onkeyup=u;e.oninput=u;e.N=x;}else{e.parentNode.removeChild(e.N);e.N=0;}}})()",,,"Mail Compose Outdent" & Go to page, "javascript:document.selectSingleNode('//textarea[last()]').focus();"
Item, "统计分析"=Go to page, "javascript:(function(){var T=%7B%7D,W=%5B%5D,C=0,s,i; function F(n)%7Bvar i,x,a,w,t=n.tagName;if(n.nodeType==3)%7Ba=n.data.toLowerCase().split(/%5B\s\(\)\:\,\.;\<\>\&\'\%22%5D/),i;for(i in a)if(w=a%5Bi%5D)%7Bw=%22 %22+w;T%5Bw%5D=T%5Bw%5D?T%5Bw%5D+1:1;++C;%7D%7Dif(t!=%22SCRIPT%22&&t!=%22STYLE%22)for(i=0;x=n.childNodes%5Bi%5D;++i)F(x)%7DF(document);for(i in T)W.push(%5BT%5Bi%5D,i%5D);W.sort(function(a,b)%7Bvar x=b%5B0%5D-a%5B0%5D;return x?x:((b%5B1%5D<a%5B1%5D)?1:-1)%7D); s=%22<h3>%22+C+%22 words</h3>%22;for(i in W)s+=W%5Bi%5D%5B0%5D+%22:%22+W%5Bi%5D%5B1%5D+%22<br>%22;with(open().document)%7Bwrite(s);close()%7D})()", 1, , "Mail Compose Strikethrough""
Item, "QQ拼音"=Go to page, "javascript:(function(q){!!q?q.toggle():(function(d,j){j=d.createElement('script');j.src='http://ime.qq.com/fcgi-bin/getjs';j.setAttribute('ime-cfg','lt=2');d.getElementsByTagName('head')[0].appendChild(j)})(document)})(window.QQWebIME)", , "QQWeb输入法", "Menu Edit" & Go to page, "javascript:document.selectSingleNode('//textarea[last()]').focus();"
Item, "搜狗云输入"=go to page,"javascript:void((function(){var e=document.createElement('script');e.setAttribute('src','http://web.pinyin.sogou.com/web_ime/init.js');document.body.appendChild(e);})())",,,"sogou"
Item, "菊花体文字"="Go to page, "javascript:{tmp = document.getSelection();code=String.fromCharCode(1161);outStr = '';for(var i=0,l=tmp.length; i<l; i++){outStr += tmp.charAt(i) + code;}  alert(outStr);}", 1, "菊花体", "Window Hotlist Icon""
Platform Windows, Item, "屏幕键盘" =Execute program, "osk.exe",,屏幕键盘,"osk"
Platform Windows, Item, 字符影射表="Execute program, "charmap.exe",,,"Mail Compose Bullet List""
--------------------1
Item, "悠嘻猴" = Go to page, "javascript: max=28; totalNum=150; begin=1; bit=3; url='http://comic.qq.com/images/tj/2007/20070129/emote/a'; format='.gif'; footPos='bottom'; bdColor='#FFFEE4'; bdBorder='1px solid black'; bodyWidth='400px'; bodyRight='5px'; bodyBottom='5px'; imgWidth='50px'; imgHeight='50px'; imgBorder='1px solid darkgray'; imgHoverBd='1px solid red'; imgOpacity = '1'; btnColor='#FFFEE4'; clBtnColor='#FFFEE4'; btnHover='#ffff99'; clsBtnHover='#ffff99'; btnSelected='#ffff00'; btnBorder='1px solid black'; clBtnBorder='1px solid black'; btnWidth='48px'; btnPadding='1px'; fontSize='12px'; fontColor='black'; clfontColor='black'; idx=0; pages=0; imageList = ''; imgLinks = new Array(); footPages = new Array(); temp = document.getElementById('faceDialog'); if(temp) temp.parentNode.removeChild(temp); faceDialog = document.createElement('div'); faceDialog.id = 'faceDialog'; faceDialog.setAttribute('style', 'position:fixed;right:'+bodyRight+';top:'+bodyBottom+';width:'+bodyWidth+';background:'+bdColor+';border:'+bdBorder+';z-index:999;'); for(i=0;i<totalNum;i++){ imgLinks[idx++]=url+getPageNumWitchZero((begin+i), bit)+format; } pages = imgLinks.length/max|0; if(imgLinks.length%max != 0) pages++; if(imgLinks.length >= max) first = max; else first = imgLinks.length; for(j=0;j<first;j++){ imageList += '<div style=\x22border:'+imgBorder+';opacity:'+imgOpacity+';margin:2px;cursor:pointer;width:'+imgWidth+';height:'+imgHeight+';float:left\x22 onmouseover=\x22imgOver(this);\x22 onmouseout=\x22imgOut(this)\x22><table style=\x22width:100%;height:100%\x22><tr><td valign=\x22center\x22 align=\x22center\x22><img style=\x22width:100%\x22 src=\x22' + imgLinks[j] + '\x22 onclick=\x22addFace(this);\x22/></td></tr></table></div>'; } faceBody = document.createElement('div'); faceBody.id = 'faceBody'; faceBody.setAttribute('style','clear:both;margin-left:1px;margin-top:1px;'); faceBody.innerHTML = imageList; footDiv = document.createElement('div'); footDiv.setAttribute('style','clear:both;margin-left:3px;'); for(i=1;i<=pages;i++){ footPages[i] = document.createElement('div'); footPages[i].name = 'foot'; footPages[i].setAttribute('style','background:'+btnColor+';border:'+btnBorder+';cursor:pointer;float:left;margin-right:6px;margin-top:3px;margin-bottom:3px;width:'+btnWidth+';font-size:'+fontSize+';color:'+fontColor+';padding-top:'+btnPadding+';padding-bottom:'+btnPadding+';text-align:center;'); footPages[i].innerHTML = '第' + i + '页'; footPages[i].addEventListener('click',function(){changePage(this);},false); footPages[i].addEventListener('mouseover',function(){btnMouseOver(this);},false); footPages[i].addEventListener('mouseout',function(){btnMouseOut(this);},false); footDiv.appendChild(footPages[i]); } footPages[1].style.background=btnSelected; closeBtn = document.createElement('div'); closeBtn.setAttribute('style','background:'+clBtnColor+';border:'+clBtnBorder+';cursor:pointer;float:left;margin-right:6px;margin-top:3px;margin-bottom:3px;width:'+btnWidth+';font-size:'+fontSize+';color:'+clfontColor+';padding-top:'+btnPadding+';padding-bottom:'+btnPadding+';text-align:center;'); closeBtn.innerHTML = '关闭'; closeBtn.onclick = 'this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode)'; closeBtn.addEventListener('mouseover',function(){btnMouseOver(this);},false); closeBtn.addEventListener('mouseout',function(){btnMouseOut(this);},false); footDiv.appendChild(closeBtn); if(footPos == 'bottom'){ faceDialog.appendChild(faceBody); faceDialog.appendChild(footDiv); } else if(footPos == 'top'){ faceDialog.appendChild(footDiv); faceDialog.appendChild(faceBody); } document.body.appendChild(faceDialog); dialogX = faceDialog.offsetLeft; dialogY = faceDialog.offsetTop; if(footPos == 'top'){ faceDialog.setAttribute('style','position:fixed;width:428px;background:'+bdColor+';border:'+bdBorder+';z-index:999;left:'+dialogX+'px;top:'+dialogY+'px;'); } function imgOver(obj){ obj.style.border = imgHoverBd; obj.style.opacity = 1; } function imgOut(obj){ obj.style.border = imgBorder; obj.style.opacity = imgOpacity; } function btnMouseOver(obj){ if(obj.style.background == btnSelected.toLowerCase()) return true; else{ oldColor = obj.style.background; obj.style.background = btnHover; } } function btnMouseOut(obj){ if(obj.style.background == btnSelected.toLowerCase()) return true; obj.style.background = oldColor; } function changePage(obj){ for(i=1;i<footPages.length;i++) footPages[i].style.background = btnColor; obj.style.background = btnSelected; imageList = ''; pageNum = obj.innerHTML.match(/\d+/); if(pageNum != pages){ begin = (pageNum-1)*max; end = pageNum*max - 1; } else{ begin = (pageNum-1)*max; end = imgLinks.length-1; } for(i=begin;i<=end;i++){ imageList += '<div style=\x22border:'+imgBorder+';opacity:'+imgOpacity+';margin:2px;cursor:pointer;width:'+imgWidth+';height:'+imgHeight+';float:left\x22 onmouseover=\x22imgOver(this);\x22 onmouseout=\x22imgOut(this)\x22><table style=\x22width:100%;height:100%\x22><tr><td valign=\x22center\x22 align=\x22center\x22><img style=\x22width:100%\x22 src=\x22' + imgLinks[i] + '\x22 onclick=\x22addFace(this);\x22/></td></tr></table></div>'; } oldDiv = document.getElementById('faceBody'); newDiv = document.createElement('div'); newDiv.id = 'faceBody'; newDiv.setAttribute('style','clear:both;margin-left:1px;margin-top:1px;'); newDiv.innerHTML = imageList; oldDiv.parentNode.replaceChild(newDiv,oldDiv); } function addFace(imgObj){ imgLink = imgObj.src; imgTag = '[img]' + imgLink + '[/img]'; textArea = document.getElementById('message');/*phpbb*/ if(textArea == null || textArea.tagName.toLowerCase() != 'textarea')/*dz7.0.0*/ textArea = document.getElementById('e_textarea'); if(textArea == null || textArea.tagName.toLowerCase() != 'textarea'){/*others*/ textArea = document.getElementsByTagName('textarea'); textArea = textArea[textArea.length-1]; } cursorStart = textArea.selectionStart; cursorEnd = textArea.selectionEnd; textArea.value = textArea.value.slice(0,cursorStart) + imgTag + textArea.value.slice(cursorEnd); textArea.focus(); textArea.selectionStart = cursorStart + imgTag.length; textArea.selectionEnd = cursorEnd + imgTag.length; } function getPageNumWitchZero(num, bit){ var num = '' + num; var zero = '', i = 0; if(num.length >= bit) return num; for(i = 0; i < (bit - num.length); i++){ zero += '0'; } return (zero + num); } window.addEventListener( 'click', function(e){ obj = e.target; while(obj){ if(obj.id && obj.id == 'faceDialog' || obj.nodeName.toLowerCase() == 'textarea') return false; else obj = obj.parentNode; } temp = document.getElementById('faceDialog'); if(temp) temp.parentNode.removeChild(temp); },false ); void(0);",1,,"Smiley Wink"
Item, "洋葱头" = Go to page, "javascript: max=28; totalNum=66; begin=1; bit=3; url='http://comic.qq.com/images/comic/2008/01/03/april/yct/'; format='.gif'; footPos='bottom'; bdColor='#FFFEE4'; bdBorder='1px solid black'; bodyWidth='400px'; bodyRight='5px'; bodyBottom='5px'; imgWidth='50px'; imgHeight='50px'; imgBorder='1px solid darkgray'; imgHoverBd='1px solid red'; imgOpacity = '1'; btnColor='#FFFEE4'; clBtnColor='#FFFEE4'; btnHover='#ffff99'; clsBtnHover='#ffff99'; btnSelected='#ffff00'; btnBorder='1px solid black'; clBtnBorder='1px solid black'; btnWidth='48px'; btnPadding='1px'; fontSize='12px'; fontColor='black'; clfontColor='black'; idx=0; pages=0; imageList = ''; imgLinks = new Array(); footPages = new Array(); temp = document.getElementById('faceDialog'); if(temp) temp.parentNode.removeChild(temp); faceDialog = document.createElement('div'); faceDialog.id = 'faceDialog'; faceDialog.setAttribute('style', 'position:fixed;right:'+bodyRight+';top:'+bodyBottom+';width:'+bodyWidth+';background:'+bdColor+';border:'+bdBorder+';z-index:999;'); for(i=0;i<totalNum;i++){ imgLinks[idx++]=url+getPageNumWitchZero((begin+i), bit)+format; } pages = imgLinks.length/max|0; if(imgLinks.length%max != 0) pages++; if(imgLinks.length >= max) first = max; else first = imgLinks.length; for(j=0;j<first;j++){ imageList += '<div style=\x22border:'+imgBorder+';opacity:'+imgOpacity+';margin:2px;cursor:pointer;width:'+imgWidth+';height:'+imgHeight+';float:left\x22 onmouseover=\x22imgOver(this);\x22 onmouseout=\x22imgOut(this)\x22><table style=\x22width:100%;height:100%\x22><tr><td valign=\x22center\x22 align=\x22center\x22><img style=\x22width:100%\x22 src=\x22' + imgLinks[j] + '\x22 onclick=\x22addFace(this);\x22/></td></tr></table></div>'; } faceBody = document.createElement('div'); faceBody.id = 'faceBody'; faceBody.setAttribute('style','clear:both;margin-left:1px;margin-top:1px;'); faceBody.innerHTML = imageList; footDiv = document.createElement('div'); footDiv.setAttribute('style','clear:both;margin-left:3px;'); for(i=1;i<=pages;i++){ footPages[i] = document.createElement('div'); footPages[i].name = 'foot'; footPages[i].setAttribute('style','background:'+btnColor+';border:'+btnBorder+';cursor:pointer;float:left;margin-right:6px;margin-top:3px;margin-bottom:3px;width:'+btnWidth+';font-size:'+fontSize+';color:'+fontColor+';padding-top:'+btnPadding+';padding-bottom:'+btnPadding+';text-align:center;'); footPages[i].innerHTML = '第' + i + '页'; footPages[i].addEventListener('click',function(){changePage(this);},false); footPages[i].addEventListener('mouseover',function(){btnMouseOver(this);},false); footPages[i].addEventListener('mouseout',function(){btnMouseOut(this);},false); footDiv.appendChild(footPages[i]); } footPages[1].style.background=btnSelected; closeBtn = document.createElement('div'); closeBtn.setAttribute('style','background:'+clBtnColor+';border:'+clBtnBorder+';cursor:pointer;float:left;margin-right:6px;margin-top:3px;margin-bottom:3px;width:'+btnWidth+';font-size:'+fontSize+';color:'+clfontColor+';padding-top:'+btnPadding+';padding-bottom:'+btnPadding+';text-align:center;'); closeBtn.innerHTML = '关闭'; closeBtn.onclick = 'this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode)'; closeBtn.addEventListener('mouseover',function(){btnMouseOver(this);},false); closeBtn.addEventListener('mouseout',function(){btnMouseOut(this);},false); footDiv.appendChild(closeBtn); if(footPos == 'bottom'){ faceDialog.appendChild(faceBody); faceDialog.appendChild(footDiv); } else if(footPos == 'top'){ faceDialog.appendChild(footDiv); faceDialog.appendChild(faceBody); } document.body.appendChild(faceDialog); dialogX = faceDialog.offsetLeft; dialogY = faceDialog.offsetTop; if(footPos == 'top'){ faceDialog.setAttribute('style','position:fixed;width:428px;background:'+bdColor+';border:'+bdBorder+';z-index:999;left:'+dialogX+'px;top:'+dialogY+'px;'); } function imgOver(obj){ obj.style.border = imgHoverBd; obj.style.opacity = 1; } function imgOut(obj){ obj.style.border = imgBorder; obj.style.opacity = imgOpacity; } function btnMouseOver(obj){ if(obj.style.background == btnSelected.toLowerCase()) return true; else{ oldColor = obj.style.background; obj.style.background = btnHover; } } function btnMouseOut(obj){ if(obj.style.background == btnSelected.toLowerCase()) return true; obj.style.background = oldColor; } function changePage(obj){ for(i=1;i<footPages.length;i++) footPages[i].style.background = btnColor; obj.style.background = btnSelected; imageList = ''; pageNum = obj.innerHTML.match(/\d+/); if(pageNum != pages){ begin = (pageNum-1)*max; end = pageNum*max - 1; } else{ begin = (pageNum-1)*max; end = imgLinks.length-1; } for(i=begin;i<=end;i++){ imageList += '<div style=\x22border:'+imgBorder+';opacity:'+imgOpacity+';margin:2px;cursor:pointer;width:'+imgWidth+';height:'+imgHeight+';float:left\x22 onmouseover=\x22imgOver(this);\x22 onmouseout=\x22imgOut(this)\x22><table style=\x22width:100%;height:100%\x22><tr><td valign=\x22center\x22 align=\x22center\x22><img style=\x22width:100%\x22 src=\x22' + imgLinks[i] + '\x22 onclick=\x22addFace(this);\x22/></td></tr></table></div>'; } oldDiv = document.getElementById('faceBody'); newDiv = document.createElement('div'); newDiv.id = 'faceBody'; newDiv.setAttribute('style','clear:both;margin-left:1px;margin-top:1px;'); newDiv.innerHTML = imageList; oldDiv.parentNode.replaceChild(newDiv,oldDiv); } function addFace(imgObj){ imgLink = imgObj.src; imgTag = '[img]' + imgLink + '[/img]'; textArea = document.getElementById('message');/*phpbb*/ if(textArea == null || textArea.tagName.toLowerCase() != 'textarea')/*dz7.0.0*/ textArea = document.getElementById('e_textarea'); if(textArea == null || textArea.tagName.toLowerCase() != 'textarea'){/*others*/ textArea = document.getElementsByTagName('textarea'); textArea = textArea[textArea.length-1]; } cursorStart = textArea.selectionStart; cursorEnd = textArea.selectionEnd; textArea.value = textArea.value.slice(0,cursorStart) + imgTag + textArea.value.slice(cursorEnd); textArea.focus(); textArea.selectionStart = cursorStart + imgTag.length; textArea.selectionEnd = cursorEnd + imgTag.length; } function getPageNumWitchZero(num, bit){ var num = '' + num; var zero = '', i = 0; if(num.length >= bit) return num; for(i = 0; i < (bit - num.length); i++){ zero += '0'; } return (zero + num); } window.addEventListener( 'click', function(e){ obj = e.target; while(obj){ if(obj.id && obj.id == 'faceDialog' || obj.nodeName.toLowerCase() == 'textarea') return false; else obj = obj.parentNode; } temp = document.getElementById('faceDialog'); if(temp) temp.parentNode.removeChild(temp); },false ); void(0);",1,,"Smiley Wink"
Item, "兔斯基" = Go to page, "javascript: max=28; totalNum=36; begin=1; bit=2; url='http://comic.qq.com/images/comic/2007/04/17/tz/'; format='.gif'; footPos='bottom'; bdColor='#FFFEE4'; bdBorder='1px solid black'; bodyWidth='400px'; bodyRight='5px'; bodyBottom='5px'; imgWidth='50px'; imgHeight='50px'; imgBorder='1px solid darkgray'; imgHoverBd='1px solid red'; imgOpacity = '1'; btnColor='#FFFEE4'; clBtnColor='#FFFEE4'; btnHover='#ffff99'; clsBtnHover='#ffff99'; btnSelected='#ffff00'; btnBorder='1px solid black'; clBtnBorder='1px solid black'; btnWidth='48px'; btnPadding='1px'; fontSize='12px'; fontColor='black'; clfontColor='black'; idx=0; pages=0; imageList = ''; imgLinks = new Array(); footPages = new Array(); temp = document.getElementById('faceDialog'); if(temp) temp.parentNode.removeChild(temp); faceDialog = document.createElement('div'); faceDialog.id = 'faceDialog'; faceDialog.setAttribute('style', 'position:fixed;right:'+bodyRight+';top:'+bodyBottom+';width:'+bodyWidth+';background:'+bdColor+';border:'+bdBorder+';z-index:999;'); for(i=0;i<totalNum;i++){ imgLinks[idx++]=url+getPageNumWitchZero((begin+i), bit)+format; } pages = imgLinks.length/max|0; if(imgLinks.length%max != 0) pages++; if(imgLinks.length >= max) first = max; else first = imgLinks.length; for(j=0;j<first;j++){ imageList += '<div style=\x22border:'+imgBorder+';opacity:'+imgOpacity+';margin:2px;cursor:pointer;width:'+imgWidth+';height:'+imgHeight+';float:left\x22 onmouseover=\x22imgOver(this);\x22 onmouseout=\x22imgOut(this)\x22><table style=\x22width:100%;height:100%\x22><tr><td valign=\x22center\x22 align=\x22center\x22><img style=\x22width:100%\x22 src=\x22' + imgLinks[j] + '\x22 onclick=\x22addFace(this);\x22/></td></tr></table></div>'; } faceBody = document.createElement('div'); faceBody.id = 'faceBody'; faceBody.setAttribute('style','clear:both;margin-left:1px;margin-top:1px;'); faceBody.innerHTML = imageList; footDiv = document.createElement('div'); footDiv.setAttribute('style','clear:both;margin-left:3px;'); for(i=1;i<=pages;i++){ footPages[i] = document.createElement('div'); footPages[i].name = 'foot'; footPages[i].setAttribute('style','background:'+btnColor+';border:'+btnBorder+';cursor:pointer;float:left;margin-right:6px;margin-top:3px;margin-bottom:3px;width:'+btnWidth+';font-size:'+fontSize+';color:'+fontColor+';padding-top:'+btnPadding+';padding-bottom:'+btnPadding+';text-align:center;'); footPages[i].innerHTML = '第' + i + '页'; footPages[i].addEventListener('click',function(){changePage(this);},false); footPages[i].addEventListener('mouseover',function(){btnMouseOver(this);},false); footPages[i].addEventListener('mouseout',function(){btnMouseOut(this);},false); footDiv.appendChild(footPages[i]); } footPages[1].style.background=btnSelected; closeBtn = document.createElement('div'); closeBtn.setAttribute('style','background:'+clBtnColor+';border:'+clBtnBorder+';cursor:pointer;float:left;margin-right:6px;margin-top:3px;margin-bottom:3px;width:'+btnWidth+';font-size:'+fontSize+';color:'+clfontColor+';padding-top:'+btnPadding+';padding-bottom:'+btnPadding+';text-align:center;'); closeBtn.innerHTML = '关闭'; closeBtn.onclick = 'this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode)'; closeBtn.addEventListener('mouseover',function(){btnMouseOver(this);},false); closeBtn.addEventListener('mouseout',function(){btnMouseOut(this);},false); footDiv.appendChild(closeBtn); if(footPos == 'bottom'){ faceDialog.appendChild(faceBody); faceDialog.appendChild(footDiv); } else if(footPos == 'top'){ faceDialog.appendChild(footDiv); faceDialog.appendChild(faceBody); } document.body.appendChild(faceDialog); dialogX = faceDialog.offsetLeft; dialogY = faceDialog.offsetTop; if(footPos == 'top'){ faceDialog.setAttribute('style','position:fixed;width:428px;background:'+bdColor+';border:'+bdBorder+';z-index:999;left:'+dialogX+'px;top:'+dialogY+'px;'); } function imgOver(obj){ obj.style.border = imgHoverBd; obj.style.opacity = 1; } function imgOut(obj){ obj.style.border = imgBorder; obj.style.opacity = imgOpacity; } function btnMouseOver(obj){ if(obj.style.background == btnSelected.toLowerCase()) return true; else{ oldColor = obj.style.background; obj.style.background = btnHover; } } function btnMouseOut(obj){ if(obj.style.background == btnSelected.toLowerCase()) return true; obj.style.background = oldColor; } function changePage(obj){ for(i=1;i<footPages.length;i++) footPages[i].style.background = btnColor; obj.style.background = btnSelected; imageList = ''; pageNum = obj.innerHTML.match(/\d+/); if(pageNum != pages){ begin = (pageNum-1)*max; end = pageNum*max - 1; } else{ begin = (pageNum-1)*max; end = imgLinks.length-1; } for(i=begin;i<=end;i++){ imageList += '<div style=\x22border:'+imgBorder+';opacity:'+imgOpacity+';margin:2px;cursor:pointer;width:'+imgWidth+';height:'+imgHeight+';float:left\x22 onmouseover=\x22imgOver(this);\x22 onmouseout=\x22imgOut(this)\x22><table style=\x22width:100%;height:100%\x22><tr><td valign=\x22center\x22 align=\x22center\x22><img style=\x22width:100%\x22 src=\x22' + imgLinks[i] + '\x22 onclick=\x22addFace(this);\x22/></td></tr></table></div>'; } oldDiv = document.getElementById('faceBody'); newDiv = document.createElement('div'); newDiv.id = 'faceBody'; newDiv.setAttribute('style','clear:both;margin-left:1px;margin-top:1px;'); newDiv.innerHTML = imageList; oldDiv.parentNode.replaceChild(newDiv,oldDiv); } function addFace(imgObj){ imgLink = imgObj.src; imgTag = '[img]' + imgLink + '[/img]'; textArea = document.getElementById('message');/*phpbb*/ if(textArea == null || textArea.tagName.toLowerCase() != 'textarea')/*dz7.0.0*/ textArea = document.getElementById('e_textarea'); if(textArea == null || textArea.tagName.toLowerCase() != 'textarea'){/*others*/ textArea = document.getElementsByTagName('textarea'); textArea = textArea[textArea.length-1]; } cursorStart = textArea.selectionStart; cursorEnd = textArea.selectionEnd; textArea.value = textArea.value.slice(0,cursorStart) + imgTag + textArea.value.slice(cursorEnd); textArea.focus(); textArea.selectionStart = cursorStart + imgTag.length; textArea.selectionEnd = cursorEnd + imgTag.length; } function getPageNumWitchZero(num, bit){ var num = '' + num; var zero = '', i = 0; if(num.length >= bit) return num; for(i = 0; i < (bit - num.length); i++){ zero += '0'; } return (zero + num); } window.addEventListener( 'click', function(e){ obj = e.target; while(obj){ if(obj.id && obj.id == 'faceDialog' || obj.nodeName.toLowerCase() == 'textarea') return false; else obj = obj.parentNode; } temp = document.getElementById('faceDialog'); if(temp) temp.parentNode.removeChild(temp); },false ); void(0);",1,,"Smiley Wink"
Item, "炮炮兵" = Go to page, "javascript: max=28; totalNum=85; begin=1; bit=2; url='http://comic.qq.com/images/comic/2007/12/28/april/ppb/'; format='.gif'; footPos='bottom'; bdColor='#FFFEE4'; bdBorder='1px solid black'; bodyWidth='400px'; bodyRight='5px'; bodyBottom='5px'; imgWidth='50px'; imgHeight='50px'; imgBorder='1px solid darkgray'; imgHoverBd='1px solid red'; imgOpacity = '1'; btnColor='#FFFEE4'; clBtnColor='#FFFEE4'; btnHover='#ffff99'; clsBtnHover='#ffff99'; btnSelected='#ffff00'; btnBorder='1px solid black'; clBtnBorder='1px solid black'; btnWidth='48px'; btnPadding='1px'; fontSize='12px'; fontColor='black'; clfontColor='black'; idx=0; pages=0; imageList = ''; imgLinks = new Array(); footPages = new Array(); temp = document.getElementById('faceDialog'); if(temp) temp.parentNode.removeChild(temp); faceDialog = document.createElement('div'); faceDialog.id = 'faceDialog'; faceDialog.setAttribute('style', 'position:fixed;right:'+bodyRight+';top:'+bodyBottom+';width:'+bodyWidth+';background:'+bdColor+';border:'+bdBorder+';z-index:999;'); for(i=0;i<totalNum;i++){ imgLinks[idx++]=url+getPageNumWitchZero((begin+i), bit)+format; } pages = imgLinks.length/max|0; if(imgLinks.length%max != 0) pages++; if(imgLinks.length >= max) first = max; else first = imgLinks.length; for(j=0;j<first;j++){ imageList += '<div style=\x22border:'+imgBorder+';opacity:'+imgOpacity+';margin:2px;cursor:pointer;width:'+imgWidth+';height:'+imgHeight+';float:left\x22 onmouseover=\x22imgOver(this);\x22 onmouseout=\x22imgOut(this)\x22><table style=\x22width:100%;height:100%\x22><tr><td valign=\x22center\x22 align=\x22center\x22><img style=\x22width:100%\x22 src=\x22' + imgLinks[j] + '\x22 onclick=\x22addFace(this);\x22/></td></tr></table></div>'; } faceBody = document.createElement('div'); faceBody.id = 'faceBody'; faceBody.setAttribute('style','clear:both;margin-left:1px;margin-top:1px;'); faceBody.innerHTML = imageList; footDiv = document.createElement('div'); footDiv.setAttribute('style','clear:both;margin-left:3px;'); for(i=1;i<=pages;i++){ footPages[i] = document.createElement('div'); footPages[i].name = 'foot'; footPages[i].setAttribute('style','background:'+btnColor+';border:'+btnBorder+';cursor:pointer;float:left;margin-right:6px;margin-top:3px;margin-bottom:3px;width:'+btnWidth+';font-size:'+fontSize+';color:'+fontColor+';padding-top:'+btnPadding+';padding-bottom:'+btnPadding+';text-align:center;'); footPages[i].innerHTML = '第' + i + '页'; footPages[i].addEventListener('click',function(){changePage(this);},false); footPages[i].addEventListener('mouseover',function(){btnMouseOver(this);},false); footPages[i].addEventListener('mouseout',function(){btnMouseOut(this);},false); footDiv.appendChild(footPages[i]); } footPages[1].style.background=btnSelected; closeBtn = document.createElement('div'); closeBtn.setAttribute('style','background:'+clBtnColor+';border:'+clBtnBorder+';cursor:pointer;float:left;margin-right:6px;margin-top:3px;margin-bottom:3px;width:'+btnWidth+';font-size:'+fontSize+';color:'+clfontColor+';padding-top:'+btnPadding+';padding-bottom:'+btnPadding+';text-align:center;'); closeBtn.innerHTML = '关闭'; closeBtn.onclick = 'this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode)'; closeBtn.addEventListener('mouseover',function(){btnMouseOver(this);},false); closeBtn.addEventListener('mouseout',function(){btnMouseOut(this);},false); footDiv.appendChild(closeBtn); if(footPos == 'bottom'){ faceDialog.appendChild(faceBody); faceDialog.appendChild(footDiv); } else if(footPos == 'top'){ faceDialog.appendChild(footDiv); faceDialog.appendChild(faceBody); } document.body.appendChild(faceDialog); dialogX = faceDialog.offsetLeft; dialogY = faceDialog.offsetTop; if(footPos == 'top'){ faceDialog.setAttribute('style','position:fixed;width:428px;background:'+bdColor+';border:'+bdBorder+';z-index:999;left:'+dialogX+'px;top:'+dialogY+'px;'); } function imgOver(obj){ obj.style.border = imgHoverBd; obj.style.opacity = 1; } function imgOut(obj){ obj.style.border = imgBorder; obj.style.opacity = imgOpacity; } function btnMouseOver(obj){ if(obj.style.background == btnSelected.toLowerCase()) return true; else{ oldColor = obj.style.background; obj.style.background = btnHover; } } function btnMouseOut(obj){ if(obj.style.background == btnSelected.toLowerCase()) return true; obj.style.background = oldColor; } function changePage(obj){ for(i=1;i<footPages.length;i++) footPages[i].style.background = btnColor; obj.style.background = btnSelected; imageList = ''; pageNum = obj.innerHTML.match(/\d+/); if(pageNum != pages){ begin = (pageNum-1)*max; end = pageNum*max - 1; } else{ begin = (pageNum-1)*max; end = imgLinks.length-1; } for(i=begin;i<=end;i++){ imageList += '<div style=\x22border:'+imgBorder+';opacity:'+imgOpacity+';margin:2px;cursor:pointer;width:'+imgWidth+';height:'+imgHeight+';float:left\x22 onmouseover=\x22imgOver(this);\x22 onmouseout=\x22imgOut(this)\x22><table style=\x22width:100%;height:100%\x22><tr><td valign=\x22center\x22 align=\x22center\x22><img style=\x22width:100%\x22 src=\x22' + imgLinks[i] + '\x22 onclick=\x22addFace(this);\x22/></td></tr></table></div>'; } oldDiv = document.getElementById('faceBody'); newDiv = document.createElement('div'); newDiv.id = 'faceBody'; newDiv.setAttribute('style','clear:both;margin-left:1px;margin-top:1px;'); newDiv.innerHTML = imageList; oldDiv.parentNode.replaceChild(newDiv,oldDiv); } function addFace(imgObj){ imgLink = imgObj.src; imgTag = '[img]'%20+%20imgLink%20+%20'[/img]'; textArea = document.getElementById('message');/*phpbb*/ if(textArea == null || textArea.tagName.toLowerCase() != 'textarea')/*dz7.0.0*/ textArea = document.getElementById('e_textarea'); if(textArea == null || textArea.tagName.toLowerCase() != 'textarea'){/*others*/ textArea = document.getElementsByTagName('textarea'); textArea = textArea[textArea.length-1]; } cursorStart = textArea.selectionStart; cursorEnd = textArea.selectionEnd; textArea.value = textArea.value.slice(0,cursorStart) + imgTag + textArea.value.slice(cursorEnd); textArea.focus(); textArea.selectionStart = cursorStart + imgTag.length; textArea.selectionEnd = cursorEnd + imgTag.length; } function getPageNumWitchZero(num, bit){ var num = '' + num; var zero = '', i = 0; if(num.length >= bit) return num; for(i = 0; i < (bit - num.length); i++){ zero += '0'; } return (zero + num); } window.addEventListener( 'click', function(e){ obj = e.target; while(obj){ if(obj.id && obj.id == 'faceDialog' || obj.nodeName.toLowerCase() == 'textarea') return false; else obj = obj.parentNode; } temp = document.getElementById('faceDialog'); if(temp) temp.parentNode.removeChild(temp); },false ); void(0);",1,,"Smiley Wink"
Item, "可爱猫" = Go to page, "javascript: max=28; totalNum=12; begin=1; bit=2; url='http://comic.qq.com/images/comic/2008/01/03/april/kam/'; format='.gif'; footPos='bottom'; bdColor='#FFFEE4'; bdBorder='1px solid black'; bodyWidth='340px'; bodyRight='5px'; bodyBottom='5px'; imgWidth='50px'; imgHeight='50px'; imgBorder='1px solid darkgray'; imgHoverBd='1px solid red'; imgOpacity = '1'; btnColor='#FFFEE4'; clBtnColor='#FFFEE4'; btnHover='#ffff99'; clsBtnHover='#ffff99'; btnSelected='#ffff00'; btnBorder='1px solid black'; clBtnBorder='1px solid black'; btnWidth='48px'; btnPadding='1px'; fontSize='12px'; fontColor='black'; clfontColor='black'; idx=0; pages=0; imageList = ''; imgLinks = new Array(); footPages = new Array(); temp = document.getElementById('faceDialog'); if(temp) temp.parentNode.removeChild(temp); faceDialog = document.createElement('div'); faceDialog.id = 'faceDialog'; faceDialog.setAttribute('style', 'position:fixed;right:'+bodyRight+';top:'+bodyBottom+';width:'+bodyWidth+';background:'+bdColor+';border:'+bdBorder+';z-index:999;'); for(i=0;i<totalNum;i++){ imgLinks[idx++]=url+getPageNumWitchZero((begin+i), bit)+format; } pages = imgLinks.length/max|0; if(imgLinks.length%max != 0) pages++; if(imgLinks.length >= max) first = max; else first = imgLinks.length; for(j=0;j<first;j++){ imageList += '<div style=\x22border:'+imgBorder+';opacity:'+imgOpacity+';margin:2px;cursor:pointer;width:'+imgWidth+';height:'+imgHeight+';float:left\x22 onmouseover=\x22imgOver(this);\x22 onmouseout=\x22imgOut(this)\x22><table style=\x22width:100%;height:100%\x22><tr><td valign=\x22center\x22 align=\x22center\x22><img style=\x22width:100%\x22 src=\x22' + imgLinks[j] + '\x22 onclick=\x22addFace(this);\x22/></td></tr></table></div>'; } faceBody = document.createElement('div'); faceBody.id = 'faceBody'; faceBody.setAttribute('style','clear:both;margin-left:1px;margin-top:1px;'); faceBody.innerHTML = imageList; footDiv = document.createElement('div'); footDiv.setAttribute('style','clear:both;margin-left:3px;'); for(i=1;i<=pages;i++){ footPages[i] = document.createElement('div'); footPages[i].name = 'foot'; footPages[i].setAttribute('style','background:'+btnColor+';border:'+btnBorder+';cursor:pointer;float:left;margin-right:6px;margin-top:3px;margin-bottom:3px;width:'+btnWidth+';font-size:'+fontSize+';color:'+fontColor+';padding-top:'+btnPadding+';padding-bottom:'+btnPadding+';text-align:center;'); footPages[i].innerHTML = '第' + i + '页'; footPages[i].addEventListener('click',function(){changePage(this);},false); footPages[i].addEventListener('mouseover',function(){btnMouseOver(this);},false); footPages[i].addEventListener('mouseout',function(){btnMouseOut(this);},false); footDiv.appendChild(footPages[i]); } footPages[1].style.background=btnSelected; closeBtn = document.createElement('div'); closeBtn.setAttribute('style','background:'+clBtnColor+';border:'+clBtnBorder+';cursor:pointer;float:left;margin-right:6px;margin-top:3px;margin-bottom:3px;width:'+btnWidth+';font-size:'+fontSize+';color:'+clfontColor+';padding-top:'+btnPadding+';padding-bottom:'+btnPadding+';text-align:center;'); closeBtn.innerHTML = '关闭'; closeBtn.onclick = 'this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode)'; closeBtn.addEventListener('mouseover',function(){btnMouseOver(this);},false); closeBtn.addEventListener('mouseout',function(){btnMouseOut(this);},false); footDiv.appendChild(closeBtn); if(footPos == 'bottom'){ faceDialog.appendChild(faceBody); faceDialog.appendChild(footDiv); } else if(footPos == 'top'){ faceDialog.appendChild(footDiv); faceDialog.appendChild(faceBody); } document.body.appendChild(faceDialog); dialogX = faceDialog.offsetLeft; dialogY = faceDialog.offsetTop; if(footPos == 'top'){ faceDialog.setAttribute('style','position:fixed;width:428px;background:'+bdColor+';border:'+bdBorder+';z-index:999;left:'+dialogX+'px;top:'+dialogY+'px;'); } function imgOver(obj){ obj.style.border = imgHoverBd; obj.style.opacity = 1; } function imgOut(obj){ obj.style.border = imgBorder; obj.style.opacity = imgOpacity; } function btnMouseOver(obj){ if(obj.style.background == btnSelected.toLowerCase()) return true; else{ oldColor = obj.style.background; obj.style.background = btnHover; } } function btnMouseOut(obj){ if(obj.style.background == btnSelected.toLowerCase()) return true; obj.style.background = oldColor; } function changePage(obj){ for(i=1;i<footPages.length;i++) footPages[i].style.background = btnColor; obj.style.background = btnSelected; imageList = ''; pageNum = obj.innerHTML.match(/\d+/); if(pageNum != pages){ begin = (pageNum-1)*max; end = pageNum*max - 1; } else{ begin = (pageNum-1)*max; end = imgLinks.length-1; } for(i=begin;i<=end;i++){ imageList += '<div style=\x22border:'+imgBorder+';opacity:'+imgOpacity+';margin:2px;cursor:pointer;width:'+imgWidth+';height:'+imgHeight+';float:left\x22 onmouseover=\x22imgOver(this);\x22 onmouseout=\x22imgOut(this)\x22><table style=\x22width:100%;height:100%\x22><tr><td valign=\x22center\x22 align=\x22center\x22><img style=\x22width:100%\x22 src=\x22' + imgLinks[i] + '\x22 onclick=\x22addFace(this);\x22/></td></tr></table></div>'; } oldDiv = document.getElementById('faceBody'); newDiv = document.createElement('div'); newDiv.id = 'faceBody'; newDiv.setAttribute('style','clear:both;margin-left:1px;margin-top:1px;'); newDiv.innerHTML = imageList; oldDiv.parentNode.replaceChild(newDiv,oldDiv); } function addFace(imgObj){ imgLink = imgObj.src; imgTag = '[img]' + imgLink + '[/img]'; textArea = document.getElementById('message');/*phpbb*/ if(textArea == null || textArea.tagName.toLowerCase() != 'textarea')/*dz7.0.0*/ textArea = document.getElementById('e_textarea'); if(textArea == null || textArea.tagName.toLowerCase() != 'textarea'){/*others*/ textArea = document.getElementsByTagName('textarea'); textArea = textArea[textArea.length-1]; } cursorStart = textArea.selectionStart; cursorEnd = textArea.selectionEnd; textArea.value = textArea.value.slice(0,cursorStart) + imgTag + textArea.value.slice(cursorEnd); textArea.focus(); textArea.selectionStart = cursorStart + imgTag.length; textArea.selectionEnd = cursorEnd + imgTag.length; } function getPageNumWitchZero(num, bit){ var num = '' + num; var zero = '', i = 0; if(num.length >= bit) return num; for(i = 0; i < (bit - num.length); i++){ zero += '0'; } return (zero + num); } window.addEventListener( 'click', function(e){ obj = e.target; while(obj){ if(obj.id && obj.id == 'faceDialog' || obj.nodeName.toLowerCase() == 'textarea') return false; else obj = obj.parentNode; } temp = document.getElementById('faceDialog'); if(temp) temp.parentNode.removeChild(temp); },false ); void(0);",1,,"Smiley Wink"
Item, "QQ表情" = Go to page, "javascript: max=40; totalNum=134; begin=0; bit=1; url='http://rescdn.qqmail.com/zh_CN/images/mo/DEFAULT2/'; format='.gif'; footPos='bottom'; bdColor='#FFFEE4'; bdBorder='1px solid black'; bodyWidth='305px'; bodyRight='5px'; bodyBottom='5px'; imgWidth='24px'; imgHeight='24px'; imgBorder='1px solid darkgray'; imgHoverBd='1px solid red'; imgOpacity = '1'; btnColor='#FFFEE4'; clBtnColor='#FFFEE4'; btnHover='#ffff99'; clsBtnHover='#ffff99'; btnSelected='#ffff00'; btnBorder='1px solid black'; clBtnBorder='1px solid black'; btnWidth='48px'; btnPadding='1px'; fontSize='12px'; fontColor='black'; clfontColor='black'; idx=0; pages=0; imageList = ''; imgLinks = new Array(); footPages = new Array(); temp = document.getElementById('faceDialog'); if(temp) temp.parentNode.removeChild(temp); faceDialog = document.createElement('div'); faceDialog.id = 'faceDialog'; faceDialog.setAttribute('style', 'position:fixed;right:'+bodyRight+';top:'+bodyBottom+';width:'+bodyWidth+';background:'+bdColor+';border:'+bdBorder+';z-index:999;'); for(i=0;i<totalNum;i++){ imgLinks[idx++]=url+getPageNumWitchZero((begin+i), bit)+format; } pages = imgLinks.length/max|0; if(imgLinks.length%max != 0) pages++; if(imgLinks.length >= max) first = max; else first = imgLinks.length; for(j=0;j<first;j++){ imageList += '<div style=\x22border:'+imgBorder+';opacity:'+imgOpacity+';margin:2px;cursor:pointer;width:'+imgWidth+';height:'+imgHeight+';float:left\x22 onmouseover=\x22imgOver(this);\x22 onmouseout=\x22imgOut(this)\x22><table style=\x22width:100%;height:100%\x22><tr><td valign=\x22\x22 align=\x22center\x22><img style=\x22width:100%\x22 src=\x22' + imgLinks[j] + '\x22 onclick=\x22addFace(this);\x22/></td></tr></table></div>'; } faceBody = document.createElement('div'); faceBody.id = 'faceBody'; faceBody.setAttribute('style','clear:both;margin-left:1px;margin-top:1px;'); faceBody.innerHTML = imageList; footDiv = document.createElement('div'); footDiv.setAttribute('style','clear:both;margin-left:3px;'); for(i=1;i<=pages;i++){ footPages[i] = document.createElement('div'); footPages[i].name = 'foot'; footPages[i].setAttribute('style','background:'+btnColor+';border:'+btnBorder+';cursor:pointer;float:left;margin-right:6px;margin-top:3px;margin-bottom:3px;width:'+btnWidth+';font-size:'+fontSize+';color:'+fontColor+';padding-top:'+btnPadding+';padding-bottom:'+btnPadding+';text-align:center;'); footPages[i].innerHTML = '第' + i + '页'; footPages[i].addEventListener('click',function(){changePage(this);},false); footPages[i].addEventListener('mouseover',function(){btnMouseOver(this);},false); footPages[i].addEventListener('mouseout',function(){btnMouseOut(this);},false); footDiv.appendChild(footPages[i]); } footPages[1].style.background=btnSelected; closeBtn = document.createElement('div'); closeBtn.setAttribute('style','background:'+clBtnColor+';border:'+clBtnBorder+';cursor:pointer;float:left;margin-right:6px;margin-top:3px;margin-bottom:3px;width:'+btnWidth+';font-size:'+fontSize+';color:'+clfontColor+';padding-top:'+btnPadding+';padding-bottom:'+btnPadding+';text-align:center;'); closeBtn.innerHTML = '关闭'; closeBtn.onclick = 'this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode)'; closeBtn.addEventListener('mouseover',function(){btnMouseOver(this);},false); closeBtn.addEventListener('mouseout',function(){btnMouseOut(this);},false); footDiv.appendChild(closeBtn); if(footPos == 'bottom'){ faceDialog.appendChild(faceBody); faceDialog.appendChild(footDiv); } else if(footPos == 'top'){ faceDialog.appendChild(footDiv); faceDialog.appendChild(faceBody); } document.body.appendChild(faceDialog); dialogX = faceDialog.offsetLeft; dialogY = faceDialog.offsetTop; if(footPos == 'top'){ faceDialog.setAttribute('style','position:fixed;width:428px;background:'+bdColor+';border:'+bdBorder+';z-index:999;left:'+dialogX+'px;top:'+dialogY+'px;'); } function imgOver(obj){ obj.style.border = imgHoverBd; obj.style.opacity = 1; } function imgOut(obj){ obj.style.border = imgBorder; obj.style.opacity = imgOpacity; } function btnMouseOver(obj){ if(obj.style.background == btnSelected.toLowerCase()) return true; else{ oldColor = obj.style.background; obj.style.background = btnHover; } } function btnMouseOut(obj){ if(obj.style.background == btnSelected.toLowerCase()) return true; obj.style.background = oldColor; } function changePage(obj){ for(i=1;i<footPages.length;i++) footPages[i].style.background = btnColor; obj.style.background = btnSelected; imageList = ''; pageNum = obj.innerHTML.match(/\d+/); if(pageNum != pages){ begin = (pageNum-1)*max; end = pageNum*max - 1; } else{ begin = (pageNum-1)*max; end = imgLinks.length-1; } for(i=begin;i<=end;i++){ imageList += '<div style=\x22border:'+imgBorder+';opacity:'+imgOpacity+';margin:2px;cursor:pointer;width:'+imgWidth+';height:'+imgHeight+';float:left\x22 onmouseover=\x22imgOver(this);\x22 onmouseout=\x22imgOut(this)\x22><table style=\x22width:100%;height:100%\x22><tr><td valign=\x22\x22 align=\x22center\x22><img style=\x22width:100%\x22 src=\x22' + imgLinks[i] + '\x22 onclick=\x22addFace(this);\x22/></td></tr></table></div>'; } oldDiv = document.getElementById('faceBody'); newDiv = document.createElement('div'); newDiv.id = 'faceBody'; newDiv.setAttribute('style','clear:both;margin-left:1px;margin-top:1px;'); newDiv.innerHTML = imageList; oldDiv.parentNode.replaceChild(newDiv,oldDiv); } function addFace(imgObj){ imgLink = imgObj.src; imgTag = '[img]' + imgLink + '[/img]'; textArea = document.getElementById('message');/*phpbb*/ if(textArea == null || textArea.tagName.toLowerCase() != 'textarea')/*dz7.0.0*/ textArea = document.getElementById('e_textarea'); if(textArea == null || textArea.tagName.toLowerCase() != 'textarea'){/*others*/ textArea = document.getElementsByTagName('textarea'); textArea = textArea[textArea.length-1]; } cursorStart = textArea.selectionStart; cursorEnd = textArea.selectionEnd; textArea.value = textArea.value.slice(0,cursorStart) + imgTag + textArea.value.slice(cursorEnd); textArea.focus(); textArea.selectionStart = cursorStart + imgTag.length; textArea.selectionEnd = cursorEnd + imgTag.length; } function getPageNumWitchZero(num, bit){ var num = '' + num; var zero = '', i = 0; if(num.length >= bit) return num; for(i = 0; i < (bit - num.length); i++){ zero += '0'; } return (zero + num); } window.addEventListener( 'click', function(e){ obj = e.target; while(obj){ if(obj.id && obj.id == 'faceDialog' || obj.nodeName.toLowerCase() == 'textarea') return false; else obj = obj.parentNode; } temp = document.getElementById('faceDialog'); if(temp) temp.parentNode.removeChild(temp); },false ); void(0);",1,,"Smiley Wink"

[Simple Share Menu]
Item, "分享到人人"=Go to page, "javascript:void((function(s,d,e){if(/renren\.com/.test(d.location))return;var f='http://share.renren.com/share/buttonshare.do?link=',u=d.location,l=d.title,p=[e(u),'&title=',e(l)].join('');function a(){if(!window.open([f,p].join(''),'xnshare',['toolbar=0,status=0,resizable=1,width=626,height=436,left=',(s.width-626)/2,',top=',(s.height-436)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent))setTimeout(a,0);else a();})(screen,document,encodeURIComponent));", 1, , "renren""
Item, "分享到新浪微博"=Go to page, "javascript:(function(){window.open('http://v.t.sina.com.cn/share/share.php?title='+encodeURIComponent(document.title)+'&url='+encodeURIComponent(location.href)+'&source=bookmark','_blank','width=450,height=400');})()", 1, , "sinaweibo""
Item, "转帖到开心"=Go to page, "javascript:function%20openPostWindow(url,data,name){var%20tempForm=document.createElement('form');tempForm.id='tempForm1';tempForm.method='post';tempForm.action=url;tempForm.target='kaixin001';var%20hideInput=document.createElement('input');hideInput.type='hidden';hideInput.name='rcontent';hideInput.value=data;tempForm.appendChild(hideInput);document.body.appendChild(tempForm);tempForm.submit();document.body.removeChild(tempForm)}function%20add2Kaixin001(){var%20u=document.location.href;var%20t=document.title;var%20c=''+(document.getSelection?document.getSelection():document.selection.createRange().text);var%20iframec='';var%20url='http://www.kaixin001.com/repaste/bshare.php?rtitle='+encodeURIComponent(t)+'&rurl='+encodeURIComponent(u)+'&from=maxthon';var%20data=encodeURIComponent(c);openPostWindow(url,c,'_blank')}add2Kaixin001();", 1, , "kaixin001""
Item, "推荐到豆瓣"=Go to page, "javascript:void(function(){var d=document,e=encodeURIComponent,s1=window.getSelection,s2=d.getSelection,s3=d.selection,s=s1?s1():s2?s2():s3?s3.createRange().text:'',r='http://www.douban.com/recommend/?url='+e(d.location.href)+'&title='+e(d.title)+'&sel='+e(s)+'&v=1',x=function(){if(!window.open(r,'douban','toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330'))location.href=r+'&r=1'};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})()", 1, , "douban""
Item, "分享到饭否"=Go to page, "javascript:var d=document,w=window,f='http://fanfou.com/share',l=d.location,e=encodeURIComponent,p='?u='+e(l.href)+'&t='+e(d.title)+'&d='+e(w.getSelection?w.getSelection().toString():d.getSelection?d.getSelection():d.selection.createRange().text)+'&s=bm';a=function(){if(!w.open(f+'r'+p,'sharer','toolbar=0,status=0,resizable=0,width=600,height=400'))l.href=f+'.new'+p};if(/Firefox/.test(navigator.userAgent))setTimeout(a,0);else{a()}void(0)", 1, , "fanfou""
Item, "分享到腾讯微博"=Go to page, "javascript:(function(){window.open('http://v.t.qq.com/share/share.php?title='+encodeURIComponent(document.title)+'&url='+encodeURIComponent(location.href)+'&source=bookmark','_blank','width=450,height=400');})()", 1, , "qqweibo""
Item, "分享到QQ空间"=Go to page, "javascript:(function(){window.open('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url='+ encodeURIComponent(location.href)+ '&title='+encodeURIComponent(document.title),'_blank');})()", 1, , "qzone""
Item, "添加到QQ书签"=Go to page, "javascript:window.open('http://shuqian.qq.com/post?from=3&title='+encodeURIComponent(document.title)+'&uri='+encodeURIComponent(document.location.href)+'&jumpback=2&noui=1','favit','width=930,height=470,left=50,top=50,toolbar=no,menubar=no,location=no,scrollbars=yes,status=yes,resizable=yes');void(0)", 1, , "qq""
Item, "发现啦"=Go to page, "javascript:void(function(g,d,m,s){g[m]?(g[m].c=1,g[m]()):!d[m]&&(d.getElementsByTagName('head')[0]||d.body).appendChild((d[m]=1,s=d.createElement('script'),s.setAttribute('charset','utf-8'),s.id='markit-script',s.src='http'+(window.location.protocol==='https:'?'s':'')+'://faxianla.com/m.js?'+Math.floor(+new Date/10000000),s))}(window,document,'__markit'))", 1, , "faxianla""
Item, "点点"="Go to page, "javascript:void((function()%7Bvar%20e=document.createElement('script');e.setAttribute('type','text/javascript');e.setAttribute('charset','UTF-8');e.setAttribute('src','http://s.libdd.com/js/app/bookmarklet/version.js?r='+Math.random()*99999999);document.body.appendChild(e)%7D)());",1,,"diandian""
Item, "花瓣"="Go to page, "javascript:void(function(d,a,c,b){a[c]&&typeof a[c].showValidImages=='function'?a[c].showValidImages():(b=a.createElement('script'),b.id='huaban_script',b.setAttribute('charset','utf-8'),b.src='http://huaban.com/js/pinmarklet.js?'+Math.floor(+new Date/1E7),a.body.appendChild(b))}(window,document,'__huaban'));",1,,"huaban""
Item, "有道云笔记"=Go to page, "javascript:(function(){CLIP_HOST='http://note.youdao.com/yws';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=CLIP_HOST+'/YNoteClipper.js?'+(new%20Date().getTime()/100000);x.charset='utf-8';document.getElementsByTagName('head')[0].appendChild(x);}catch(e){alert(e);}})();", 1, , "ydnote""
Item, "保存到WizKnowledge"="Execute program, "C:\Program Files\Wiz\Wiz.exe", "C:\PROGRA~1\Wiz\WIZKMC~1.DLL, WizKMURLDownloadToDocument /ShowProgress=1 /URL=%u /CacheFile=%s",,"News Read""
Item, MI_IDM_SELMAIL			= Send text in mail
breakitem
Item, "FaceBook"=Go to page, "javascript:var d=document,f='https://www.facebook.com/share',l=d.location,e=encodeURIComponent,p='.php?src=bm&v=4&i=1322668524&u='+e(l.href)+'&t='+e(d.title);1;try{if (!/^(.*\.)?facebook\.[^.]*$/.test(l.host))throw(0);share_internal_bookmarklet(p)}catch(z) {a=function() {if (!window.open(f+'r'+p,'sharer','toolbar=0,status=0,resizable=1,width=626,height=436'))l.href=f+p};if (/Firefox/.test(navigator.userAgent))setTimeout(a,0);else{a()}}void(0)", 1, , "facebook""
Item, "Twitter"=Go to page, "javascript:(function(){window.twttr=window.twttr||{};var D=550,A=450,C=screen.height,B=screen.width,H=Math.round((B/2)-(D/2)),G=0,F=document,E;if(C>A){G=Math.round((C/2)-(A/2))}window.twttr.shareWin=window.open('http://twitter.com/share','','left='+H+',top='+G+',width='+D+',height='+A+',personalbar=0,toolbar=0,scrollbars=1,resizable=1');E=F.createElement('script');E.src='http://platform.twitter.com/bookmarklets/share.js?v=1';F.getElementsByTagName('head')[0].appendChild(E)}());", 1, , "twitter""
Item, "Del.icio.us"=Go to page, "javascript:(function(){f='http://delicious.com/save?url='+encodeURIComponent(window.location.href)+'&title='+encodeURIComponent(document.title)+'&v=5&';a=function(){if(!window.open(f+'noui=1&jump=doclose','deliciousuiv5','location=yes,links=no,scrollbars=no,toolbar=no,width=550,height=550'))location.href=f+'jump=yes'};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})()", 1, , "delicious""
Item, "Digg.com"=Go to page, "javascript:location.href='http://digg.com/submit?phase=2&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)", 1, , "digg""
Item, "Blogger" ="Go to page,"javascript:popw='';Q='';x=document;y=window;if(x.selection) {Q=x.selection.createRange().text;} else if (y.getSelection) {Q=y.getSelection();} else if (x.getSelection) {Q=x.getSelection();}popw = y.open('http://www.blogger.com/blog_this.pyra?t=' + escape(Q) + '&u=' + escape(location.href) + '&n=' + escape(document.title),'bloggerForm','scrollbars=no,width=475,height=300,top=175,left=75,status=yes,resizable=yes');if (!document.all) T = setTimeout('popw.focus()',50);void(0);",,,"blogger""
Item, "GmailThis!"="Go to page, "javascript:popw='';Q='';x=document;y=window;if(x.selection) {Q=x.selection.createRange().text;} else if (y.getSelection) {Q=y.getSelection();} else if (x.getSelection) {Q=x.getSelection();}popw = y.open('https://mail.google.com/mail?view=cm&tf=0&to=&su=' + escape(document.title) + '&body=' + escape(Q) + escape('\n') + escape(location.href),'gmailForm','scrollbars=yes,width=680,height=510,top=175,left=75,status=no,resizable=yes');if (!document.all) T = setTimeout('popw.focus()',50);void(0);", 1, , "google""
Item, "GoogleFav"=Go to page, "javascript:(function(){var a=window,b=document,c=encodeURIComponent,d=a.open('http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk='+c(b.location)+'&title='+c(b.title),'bkmk_popup','left='+((a.screenX||a.screenLeft)+10)+',top='+((a.screenY||a.screenTop)+10)+',height=420px,width=550px,resizable=1,alwaysRaised=1');a.setTimeout(function(){d.focus()},300)})();", 1, , "google""
Item, "Evernote"=Go to page, "javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title);}})();", 1, , "Evernote""
Item, "添加到新浪ViVi"=Go to page, "javascript:d=document;t=d.selection?(d.selection.type!='None'?d.selection.createRange().text:''):(d.getSelection?d.getSelection():'');void(vivi=window.open('http://vivi.sina.com.cn/collect/icollect.php?pid=free9.net&title='+escape(d.title)+'&url='+escape(d.location.href)+'&desc='+escape(t),'vivi','scrollbars=no,width=480,height=480,left=75,top=20,status=no,resizable=yes'));vivi.focus();", 1, , "sinavivi""
Item, "添加到百度搜藏"=Go to page, "javascript:u=location.href;t=document.title;t=t.substr(0,76);c=%22%22+(window.getSelection?window.getSelection():document.getSelection?document.getSelection():document.selection.createRange().text);c=c.substr(0,180);var url=%22http://cang.baidu.com/do/add?it=%22+encodeURIComponent(t)+%22&iu=%22+encodeURIComponent(u)+%22&dc=%22+encodeURIComponent(c)+%22&fr=ien#nw=1%22;window.open(url,'_blank','scrollbars=no,width=600,height=450,left=75,top=20,status=no,resizable=yes');void 0", 1, , "baidu""
Item, "分享到i贴吧"=Go to page, "http://tieba.baidu.com/i/app/open_share_api?link=%u",,,"tieba"
Item, "添加到和讯转帖"=Go to page, "javascript:e=document.selection?(document.selection.type!='None'?document.selection.createRange().text:''):(document.getSelection?document.getSelection():'');location.href='http://bookmark.hexun.com/post.aspx?p=0&title='+escape(document.title)+'&url='+escape(location.href)+'&excerpt='+escape(e)", 1, , "hexun""
Item, "转发到方舟"="Go to page, "javascript:void(function(a,b,c,d){d=b.createElement('script');d.id='linju_script';d.setAttribute('charset','gb2312');d.src='http://q.xlpan.com/js/caijiall.js?'+new%20Date().getTime();b.body.appendChild(d)}(window,document,'__linju'));", 1, , "xlpan""
Item, "麦库网页剪辑器"=Go to page, "javascript:(function(){if(document.body&&!document.xmlVersion){var s=document.createElement('script');s.setAttribute('type','text/javascript');s.setAttribute('src','http://note.maiku-static.com/static/js/plugin/plugin.main.js');document.body.appendChild(s)}})();", 1, , "sdonote""

[Simple Proxy Menu]
Include, 11 Menu Proxy

[Simple WinTools Menu]
Item, "计算器"="Execute program, "calc.exe",,,"calc""
Item, "放大镜"="Execute program, "magnify", , , "Find""
Item, "Hosts工具"="Execute program, "HostsTool.bat", , , "cmd" 
Item, "编辑Hosts"="Go to page, "C:/WINDOWS/system32/drivers/etc/hosts" & Delay, 1 & View document source & Switch to previous page & Close page, 1,,"View threaded""
-----------------1
Item, Internet属性="Execute program, "inetcpl.cpl",,, "ie""
Item, "Nslookup"="External action, , , , "cmd" | Edit site preferences & Delay, 1 & Copy & Cancel & Delay, 1 & Execute program, "cmd", "/k nslookup %c""
Item, "DOS命令行"="Execute program,"cmd.exe",,,"cmd""
-----------------2
Item, "MsConfig"="Execute program, "msconfig.exe", , , "msconfig""
Item, "注册表编辑"="Execute program, "regedit.exe",,,"regedit""
item, "添加或删除程序"="Execute program, "appwiz.cpl", , , "appwiz""
Item, "计算机管理"="Execute program, "compmgmt.msc", , , "compmgmt""
item, "网络连接"="Execute program, "ncpa.cpl", , , "ncpa""
Item, "防火墙"="Execute program, "firewall.cpl", , , "firewall""
Item, 系统属性="Execute program, "sysdm.cpl", , , "system""
Item, "DirectX诊断工具"="Execute program, "dxdiag",,,"dxdiag""

[Simple ImageLike Menu]
Item, "Tineye搜索" = Copy image address,-2,,,"tineye" & New page & Go to page, "http://www.tineye.com/parse?url=%c" & Switch to previous page
Item, "搜狗搜图"=Copy image address,-2,,,"sogou" & New page & Go to page, "http://pic.sogou.com/ris?query=%c" & Switch to previous page
Item, "Google此图片"=Copy image address,-2,,,"google" & New page & Go to page, "http://images.google.com/searchbyimage?image_url=%c&hl=zh-CN&sourceid=opera&client=opera" & Switch to previous page
Item, "百度识图" = Copy image address,-2,,,"baidu" & New page & Go to page, "http://stu.baidu.com/i?rt=0&rn=10&ct=1&tn=baiduimage&objurl=%c" & Switch to previous page
Item, "Yande搜索" = Copy image address,-2,,,"imouto" & Delay,1 & Go to page, "javascript: var url = encodeURI('%c'); window.open('http://yande.re/post/similar?services=all&url=' + url).blur();"
Item, "IDQB搜索" = Copy image address,-2,,,"Search" & New page & Go to page, "http://iqdb.org/?url=%c" & Switch to previous page

[Quick Preferences Menu]
;快速参数修改
Item, MI_IDM_CONTROL_MENU_ACCEPT_POPUPS			= Enable popup windows
Item, MI_IDM_CONTROL_MENU_OPEN_POPUPS_IN_BACKGROUND	= Enable popup windows in background
Item, M_QUICKPREF_POPUP_MENU_REQUESTED_POPUP_ONLY	= Enable requested popup windows
Item, MI_IDM_CONTROL_MENU_REFUSE_POPUPS			= Disable popup windows
--------------------1
Item, MI_IDM_CONTROL_MENU_ENABLE_PLUGINS	= Enable plugins | Disable plugins
Item, MI_IDM_CONTROL_MENU_ENABLE_JAVASCRIPT	= Enable javascript | Disable javascript
Item, MI_IDM_CONTROL_MENU_ENABLE_COOKIES	= Enable cookies | Disable cookies
Item, MI_IDM_CONTROL_MENU_ENABLE_REFERRER	= Enable referrer logging| Disable referrer logging
Item, "自动重定向"=Set preference, "User Prefs|Client Pull=1" | Set preference, "User Prefs|Client Pull=0"
--------------------2
Item, 51099=Work offline | Work online
;Item, "Http开关"=Show preferences,22,,,"Unite Failed"& Delay,1& Show proxy servers& Delay,1& Focus next widget& Click button& OK& Delay,1& OK&Delay,1&Stop&Delay,1&Reload
Item, MI_IDM_CONTROL_MENU_ENABLE_PROXY		= Enable proxy servers | Disable proxy servers
Item, M_ENABLE_OPERA_TURBO			= Enable Web Turbo | Disable Web Turbo
--------------------4
Item, "在地址栏显示书签"= Set preference, "User Prefs|Show Bookmarks In Addressfield Autocompletion=1" | Set preference, "User Prefs|Show Bookmarks In Addressfield Autocompletion=0"
Item, "在地址栏显示历史记录"="Set preference, "User Prefs|Addressbar Content Search=1" | Set preference, "User Prefs|Addressbar Content Search=0"
Item, "记住访问网页的内容"= Set preference, "User Prefs|Visited Pages=1" | Set preference, "User Prefs|Visited Pages=0"
Item, "禁止自动导入书签"=Set preference, "User Prefs|Disable Bookmark Import=1" | Set preference, "User Prefs|Disable Bookmark Import=0"
--------------------5
Item, M_EDIT_SITE_PREFERENCES = Edit site preferences
Item, "皮肤调试模式"=Set preference, "User Prefs|Debug Skin=1" | Set preference, "User Prefs|Debug Skin=0"
Item, "刷新配置"= External action,,,,"Attachment Documents" | Show preferences, 25 & delay,1 & Next item & Ok

[Simple Download Menu]
Item, 启用内置BT下载 = Set preference, "BitTorrent|Enable=1" | Set preference, "BitTorrent|Enable=0"
Item, "UTF-8编码"="Set preference, "Network|UTF8 Escape URLs=1", , "UTF-8编码", "Checkbox skin.selected" > Set preference, "Network|UTF8 Escape URLs=0"
Item, "下载完成后通知"="Set preference, "User Prefs|Show Notification For Finished Transfers=1" > Set preference, "User Prefs|Show Notification For Finished Transfers=0"
Item, "下载器选择对话框"="Set preference, "User Prefs|Show Download Manager Selection Dialog=1" > Set preference, "User Prefs|Show Download Manager Selection Dialog=0"
Item, "显示新邮件通知"="Set preference, "User Prefs|Show Notification For New Messages=1" > Set preference, "User Prefs|Show Notification For New Messages=0"
--------------------0
Item, "配置eDown"=Execute program,"optools\edown.exe", , , "save""
Item, "HttpFileMonitor"=Execute program,"optools\HttpFileMonitor.exe", , , "Target Folder""
;Platform Windows, Item, "提取缓存"=External action,,,,"save" | Execute program,"profile\Cache.vbs"
Platform Windows, Item, "OperaCacheView"=External action,,,,"save" | Execute program,"optools\OperaCacheView.exe"
Item, "在缓存中查找"=go to page,"about:cache",,,"find"
Item, "Profile"="Execute program, "Profile",,,"Parent folder""
;Item, "Optools"="Execute program, "explorer.exe", "optools",,"Target Folder""

[Simple Background Menu]
Item, MI_IDM_CONTROL_MENU_ACCEPT_POPUPS			= Enable popup windows
Item, MI_IDM_CONTROL_MENU_OPEN_POPUPS_IN_BACKGROUND	= Enable popup windows in background
Item, M_QUICKPREF_POPUP_MENU_REQUESTED_POPUP_ONLY	= Enable requested popup windows
Item, MI_IDM_CONTROL_MENU_REFUSE_POPUPS			= Disable popup windows
--------------------0
;Item, "后台打开"="Set preference, "User Prefs|Target Destination=2" > Set preference, "User Prefs|Target Destination=0"
Item, "启用左键拖拽"=Set preference, "user prefs|Open Dragged Link In Background=1" > Set preference, "user prefs|Open Dragged Link In Background=0"
Item, "双击关闭标签"=Set preference, "user prefs|Doubleclick to Close Tab=1" > Set preference, "user prefs|Doubleclick to Close Tab=0"
Item, "系统托盘图标"=Set preference, "user prefs|Show Tray Icon=1" > Set preference, "user prefs|Show Tray Icon=0"
Item, "单键快捷键"=Set preference, "User Prefs|Enable Extended Keyboard Shortcuts=1" | Set preference, "User Prefs|Enable Extended Keyboard Shortcuts=0"
Item, "窗口式浏览"="Set preference, "User Prefs|SDI=1" > Set preference, "User Prefs|SDI=0"
Item, "地址栏下拉按钮"="Set preference, "User Prefs|Show Dropdown Button In Addressfield=1" > Set preference, "User Prefs|Show Dropdown Button In Addressfield=0"
Item, "允许检测右键菜单"=Set preference, "user prefs|Allow script to receive right clicks=1" > Set preference, "user prefs|Allow script to receive right clicks=0"
Item, "双击文本弹出菜单"="Set preference, "User Prefs|Automatic Select Menu=1" > Set preference, "User Prefs|Automatic Select Menu=0"
Item, "中键单击选项"=Manage middle click options
;Item, "伪装为Word"="Set preference, "User Prefs|Application Icon=profile/Word.ico" > Set preference, "User Prefs|Application Icon="
;Include, 12 Menu HWA

[Simple Plugin Menu]
Item, MI_IDM_CONTROL_MENU_ENABLE_PLUGINS	= Enable plugins | Disable plugins
Item, MI_IDM_CONTROL_MENU_ENABLE_ANIMATION	= Enable gif animation | Disable gif animation
;Item, MI_IDM_CONTROL_MENU_ENABLE_AUDIO		= Enable embedded audio | Disable embedded audio
Item, MI_IDM_CONTROL_MENU_ENABLE_JAVASCRIPT	= Enable javascript | Disable javascript
Item, MI_IDM_CONTROL_MENU_ENABLE_PLUGINS	= Enable plugins | Disable plugins
--------------------1
Item, "User JS"=Set preference, "user prefs|User JavaScript=1" > Set preference, "user prefs|User JavaScript=0"
Item, "启用用户CSS"=Set preference, "author display mode|user css=1" > Set preference, "author display mode|user css=0"
Item, "URL Filter"=Set preference, "Network|Enable Content Blocker=1" > Set preference, "Network|Enable Content Blocker=0"
Item, "插件按需加载"=Set preference, "User Prefs|Enable On Demand Plugin=1" > Set preference, "User Prefs|Enable On Demand Plugin=0"
--------------------2
Item, D_PREFS_BLOCKED_CONTENT	= Content block details, 1
Item, "JavaScript选项"=Manage script options
Item, "允许HTTPS加载JS"=Set preference, "user prefs|User JavaScript on HTTPS=1" > Set preference, "user prefs|User JavaScript on HTTPS=0"

[Simple Security Menu]
Item, "信任的网站"=Manage Whitelist
Item,  启用SSL证书验证 = Set preference, "Security Prefs|OCSP Validate Certificates=1" | Set preference, "Security Prefs|OCSP Validate Certificates=0"
Item, Opera证书管理=Manage Certificates
Platform Windows, Item, Windows证书管理="Execute program, "certmgr.msc",,, "userpass""
--------------------1
Item, "Wand自动登录"="Set preference, "User Prefs|Wand Autosubmit=1" > Set preference, "User Prefs|Wand Autosubmit=0"
Item, "查看Wand密码"="Wand, , , "查看wand密码" & Go to page, "javascript:(function(){var s,F,j,f,i; s=''; F=document.forms; for(j=0; j<F.length; ++j){f=F[j]; for(i=0; i<f.length; ++i){if(f[i].type.toLowerCase()=='password')s+=f[i].value+'\n';}}if(s)alert('Passwords in forms on this page:\n\n'+s);else alert('There are no passwords in forms on this page.');})();", 1, , "Wand""
Item, M_MANAGE_WAND_PASSWORDS = Manage wand
--------------------2
Item, MI_IDM_CONTROL_MENU_ENABLE_COOKIES	= Enable cookies | Disable cookies
Item, "删除本站Cookie(&C)"=External action,,,,"none" | go to page,"javascript:(function(){var C,d,s,p,i,c,k=document.cookie;if(k){C=k.split('; ');for(d='.'+location.host;d;d=(''+d).substr(1).match(/\..*$/))for(sl=0;sl<2;++sl)for(p='/'+location.pathname;p;p=p.substring(0,p.lastIndexOf('/')))for(i in C)if(c=C[i]){document.cookie=c+'; domain='+d.slice(sl)+'; path='+p.slice(1)+'/'+'; expires='+new Date((new Date).getTime()-1e11).toGMTString()}}})()" & delay,1 & delay,500 & Edit site preferences & delay,1 & Cycle to next page & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & cancel
Item, "删除本站相关Cookie(&X)"=External action,,,,"none" | go to page,"javascript:(function(){var h=location.hostname;var s=h.split('.');var l=s.length;if(/^(?:\d{1,3}\.){3}\d{1,3}$/.test(h)||l<3){}else if(/\.google\./.test(h)){h='google.'}else if(/\.yahoo\./.test(h)){h='yahoo.'}else if(/\.(co|com|net|org|edu|gov|mil|int)\.[^\.]+$/.test(h)){h=s[l-3]+'.'+s[l-2]}else{h=s[l-2]+'.'+s[l-1]};prompt('',h)})()" & delay,1 & delay,10 & copy & delay,1 & delay,10 & cancel & delay,1 & delay,500 & manage cookies & delay,1 & paste & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & Focus previous widget & delay,1 & Focus next widget & delay,1 & delete & delay,1 & cancel
--------------------3
Item, "启用地址栏内容搜索"="Set preference, "User Prefs|Addressbar Content Search=1" > Set preference, "User Prefs|Addressbar Content Search=0"
Item, "清除搜索历史(&S)"=Clear Previous Searches
Item, "删除私人数据"=External action,,,,"Mark as not spam" | Delete private data & Delay, 10 & Click button
Item, "清除所有历史内容"=External action,,,,"Mark as spam" | Clear disk cache & Clear visited history & Clear typed in history & Remove all finished transfers & Clear Previous Searches & Clear Search Field & Empty page trash & Delay , 100 & Empty trash

[Simple UA Menu]
Item, "SimpleU" = Set preference, "ISP|Id=SimpleU Edition"
Item, None = Set preference, "ISP|Id="
Item, "Baiduspider" = Set preference, "ISP|Id=Baiduspider"
Item, "Googlebot" = Set preference, "ISP|Id=Googlebot"
Item, "SymbianOS/9.2" = Set preference, "ISP|Id=SymbianOS/9.2"
Item, "---以上为ISP-UA(*)---"=Show popup menu
Item, "当前UA查询"=Go to page, "javascript:var x=navigator.userAgent; var y='%'; for (var i=0;i<x.length;i++)%7B y+=x.charCodeAt(i).toString(16)+'%'; %7D y=unescape(decodeURI(y.replace(/\%$/,''))); alert(x+'\n'+y); void(0);", 1, , "Menu Info""
Include, 12 Menu UA
BreakItem
Item, "---Opera Online---"=Show popup menu
Item, M_SYNC_ENABLE=Set up Sync | Sync login
Item, M_SYNC_CONFIGURE = Open Sync settings
Item, M_WEBSERVER_ENABLE = Set up Webserver | Opera Unite Enable
Item, S_WEBSERVER_DISCOVERY_ENABLE = Enable Application Discovery Notifications | Disable Application Discovery Notifications
Item, "---Opera Turbo---"=Show popup menu
Item, M_OPERA_TURBO_CONFIGURE = Open Web Turbo Dialog
;Item, M_ENABLE_OPERA_TURBO = Enable Web Turbo | Disable Web Turbo
Item, "选择美国服务器(&E)"=Set preference, "Proxy|Opera Turbo Config File={Resources}region\tw\turbosettings.xml"
Item, "选择中国服务器(&Z)"=Set preference, "Proxy|Opera Turbo Config File={Resources}region\cn\turbosettings.xml"

[11 Menu Proxy]
Item, "查看当前IP"="Go to page, "http://www.ip138.com/" & New page & Go to page, "http://get.youripfast.com/",,"Contact0""
Item, 例外站点不使用代理=Set preference, "Proxy|No Proxy Servers Check=1",,"部分网址不用代理" | Set preference, "Proxy|No Proxy Servers Check=0"
Item, 此站点添加到例外=External action,,,,Add widget|Duplicate page & Delay,1 & Go to page,"javascript:location.href='opera:config#'+location.hostname" & Delay,1 & Delay,350 & Go to page,"javascript:(function(){var hn=String(location.href).slice(13),allExc=opera.getPreference('Proxy','No Proxy Servers'),allExc_A=allExc.split(','),tempA=allExc.split(','),allExc_R=new RegExp(('^'+allExc+'$').replace(/\./g,'\\.').replace(/\*/g,'\.*').replace(/,/g,'$|^')),newExc;for(i=tempA.length-1;i>=0;i--){var temp1=new RegExp(('^'+tempA[i]+'$').replace(/\./g,'\\.').replace(/\*/g,'\.*'));if(!temp1.test(hn)){tempA.splice(i,1)}}newExc=(tempA.length>0)?prompt('可使用通配符『*』，例如 *.operachina.com 已经包括 bbs.operachina.com 和 http://www.operachina.com 。\n此站点已经在例外名单中╮(╯▽╰)╭但可修改域名再添加。\n\n以下是和此域名匹配的已有规则：\n\n'+tempA.join('\n'),hn):prompt('将此站点添加到例外名单中。访问例外名单中的站点时将忽略代理服务器设置。'+'\n\n'+'可使用通配符，例如 *.operachina.com 已经包括 bbs.operachina.com 和 http://www.operachina.com 。',hn);if(newExc!=null && /\S/.test(newExc)==true){if(!allExc_R.test(newExc)){var newExc_R=new RegExp(('^'+newExc+'$').replace(/\./g,'\\.').replace(/\*/g,'\.*')),old='\n',allExc_A=allExc.split(','),tempA=allExc_A;for(j=tempA.length-1;j>=0;j--){if(newExc_R.test(tempA[j])){old+=tempA[j]+'\n';tempA.splice(j,1)}} if(old=='\n'){allExc+=','+newExc}else{var left=confirm('以下旧规则已经被刚输入的新规则包含，是否仍然保留？\n'+old);allExc=(left)?allExc+','+newExc:tempA.join(',')+','+newExc}opera.setPreference('Proxy','No Proxy Servers',allExc);alert(newExc+' 添加完成')}else{var not2add=(newExc==hn)?'俺不是早说加过了嘛╮(╯﹏╰)╭':'哦...原来介个也已经加过了 ╮(╯▽╰)╭';alert(not2add)}}else{alert('添加已取消')}window.close()})()",1
Item,"关闭代理及程序=execute program,"cmd.exe","/c taskkill /im fgx.exe  /f /t || taskkill /im fg.exe || taskkill /im freeg.exe || taskkill /im freeu.exe || taskkill /im puff.exe || taskkill /im proxy.exe || taskkill /im u.exe /f" ,,"Expand Disabled"& Disable proxy servers
Item, 打开代理设置=Show preferences,22,,,Menu tools & Delay,1 & Show proxy servers
------0
Item, 编辑AutoPAC=Execute program,"notepad.exe", "profile\pac\Autoproxy.pac",,"Dom console"
;Item, 生成编辑PAC=External action,,,,Dom console|Focus address field & Copy & Delay,10 & Go to page,"javascript:var u=String('%c'),n=u.indexOf('://'),m=u.indexOf('/',n+3),u=u.slice(n+3,m);prompt('New PAC Rule for this Current Site','if(shExpMatch(host, %%22*'+u+'*%%22)) return proxy;\n');void(0)"&Execute program,"notepad.exe", "profile\pac\autoproxy.pac"
Item, AutoPr0xy=Disable proxy servers,,,,Restart transfer & Open url in new page,"opera:config" & Delay,10 & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+usePAC}else if(allExc.indexOf(useALL)!=-1){allExc=allExc.replace(useALL,usePAC)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',1);opera.setPreference('Proxy','Automatic Proxy Configuration URL',opera.getPreference('User Prefs','Opera Directory')+'pac\\Autoproxy.pac');window.close()"
Item, NO-ADS=Disable proxy servers,,,,Menu Info & Open url in new page,"opera:config" & Delay,10 & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+usePAC}else if(allExc.indexOf(useALL)!=-1){allExc=allExc.replace(useALL,usePAC)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',1);opera.setPreference('Proxy','Automatic Proxy Configuration URL',opera.getPreference('User Prefs','Opera Directory')+'pac\\no-ads.pac');window.close()"
Item, SwitchyPAC=Disable proxy servers,,,,Menu Info & Open url in new page,"opera:config" & Delay,10 & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+usePAC}else if(allExc.indexOf(useALL)!=-1){allExc=allExc.replace(useALL,usePAC)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',1);opera.setPreference('Proxy','Automatic Proxy Configuration URL',opera.getPreference('User Prefs','Opera Directory')+'pac\\SwitchyPac.pac');window.close()"
------1
Item, "Port>[8580]"=Execute program,"optools\Proxy\fgx.exe",,,"fg" & Disable proxy servers,,,,fg & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8580';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[9666]"=Execute program,"optools\Proxy\u.exe",,,"wj" & Disable proxy servers,,,,wj & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:9666';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[8087]"=Disable proxy servers,,,,goagent & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8087';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
BreakItem
Item, "Port>[1234]"=Disable proxy servers,,,,wito & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:1234';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[1984]"=Disable proxy servers,,,,puff & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:1984';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[1998]"=Disable proxy servers,,,,wcproxy & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:1998';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[48100]"=Disable proxy servers,,,,hyk & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:48100';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[5865]"=Disable proxy servers,,,,wapp & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:5865';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[8000]"=Disable proxy servers,,,,gapp & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8000';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[8080]"=Disable proxy servers,,,,proxo & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8080';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[8081]"=Disable proxy servers,,,,gtu & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8081';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[8082]"=Disable proxy servers,,,,gtu & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8082';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[8086]"=Disable proxy servers,,,,wapp & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8086';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[8118]"=Disable proxy servers,,,,p & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8118';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[9050]"=Disable proxy servers,,,,advor & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:9050';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[9051]"=Disable proxy servers,,,,tor & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:9051';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"

[12 Menu Proxy]
Item, "查看当前IP"="Go to page, "http://www.ip138.com/" & New page & Go to page, "http://get.youripfast.com/",,"Contact0""
Item, 例外站点不使用代理=Set preference, "Proxy|No Proxy Servers Check=1",,"部分网址不用代理" | Set preference, "Proxy|No Proxy Servers Check=0"
Item, 此站点添加到例外=External action,,,,Add widget|Duplicate page & Delay,1 & Go to page,"javascript:location.href='opera:config#'+location.hostname" & Delay,1 & Delay,350 & Go to page,"javascript:(function(){var hn=String(location.href).slice(13),allExc=opera.getPreference('Proxy','No Proxy Servers'),allExc_A=allExc.split(','),tempA=allExc.split(','),allExc_R=new RegExp(('^'+allExc+'$').replace(/\./g,'\\.').replace(/\*/g,'\.*').replace(/,/g,'$|^')),newExc;for(i=tempA.length-1;i>=0;i--){var temp1=new RegExp(('^'+tempA[i]+'$').replace(/\./g,'\\.').replace(/\*/g,'\.*'));if(!temp1.test(hn)){tempA.splice(i,1)}}newExc=(tempA.length>0)?prompt('可使用通配符『*』，例如 *.operachina.com 已经包括 bbs.operachina.com 和 http://www.operachina.com 。\n此站点已经在例外名单中╮(╯▽╰)╭但可修改域名再添加。\n\n以下是和此域名匹配的已有规则：\n\n'+tempA.join('\n'),hn):prompt('将此站点添加到例外名单中。访问例外名单中的站点时将忽略代理服务器设置。'+'\n\n'+'可使用通配符，例如 *.operachina.com 已经包括 bbs.operachina.com 和 http://www.operachina.com 。',hn);if(newExc!=null && /\S/.test(newExc)==true){if(!allExc_R.test(newExc)){var newExc_R=new RegExp(('^'+newExc+'$').replace(/\./g,'\\.').replace(/\*/g,'\.*')),old='\n',allExc_A=allExc.split(','),tempA=allExc_A;for(j=tempA.length-1;j>=0;j--){if(newExc_R.test(tempA[j])){old+=tempA[j]+'\n';tempA.splice(j,1)}} if(old=='\n'){allExc+=','+newExc}else{var left=confirm('以下旧规则已经被刚输入的新规则包含，是否仍然保留？\n'+old);allExc=(left)?allExc+','+newExc:tempA.join(',')+','+newExc}opera.setPreference('Proxy','No Proxy Servers',allExc);alert(newExc+' 添加完成')}else{var not2add=(newExc==hn)?'俺不是早说加过了嘛╮(╯﹏╰)╭':'哦...原来介个也已经加过了 ╮(╯▽╰)╭';alert(not2add)}}else{alert('添加已取消')}window.close()})()",1
Item,"关闭代理及程序=execute program,"cmd.exe","/c taskkill /im fgx.exe  /f /t || taskkill /im fg.exe || taskkill /im freeg.exe || taskkill /im freeu.exe || taskkill /im puff.exe || taskkill /im proxy.exe || taskkill /im u.exe /f" ,,"Expand Disabled"& Disable proxy servers
Item, 打开代理设置=Show preferences,22,,,Menu tools & Delay,1 & Show proxy servers
------0
Item, 编辑AutoPAC=Execute program,"notepad.exe", "profile\pac\Autoproxy.pac",,"Dom console"
;Item, 生成编辑PAC=External action,,,,Dom console|Focus address field & Copy & Delay,10 & Go to page,"javascript:var u=String('%c'),n=u.indexOf('://'),m=u.indexOf('/',n+3),u=u.slice(n+3,m);prompt('New PAC Rule for this Current Site','if(shExpMatch(host, %%22*'+u+'*%%22)) return proxy;\n');void(0)"&Execute program,"notepad.exe", "profile\pac\autoproxy.pac"
Item, AutoPr0xy=Disable proxy servers,,,,Restart transfer & Open url in new page,"opera:config" & Delay,10 & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+usePAC}else if(allExc.indexOf(useALL)!=-1){allExc=allExc.replace(useALL,usePAC)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',1);opera.setPreference('Proxy','Automatic Proxy Configuration URL',opera.getPreference('User Prefs','Opera Directory')+'pac\\Autoproxy.pac');window.close()" & Delay, 10 & Close page
Item, NO-ADS=Disable proxy servers,,,,Menu Info & Open url in new page,"opera:config" & Delay,10 & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+usePAC}else if(allExc.indexOf(useALL)!=-1){allExc=allExc.replace(useALL,usePAC)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',1);opera.setPreference('Proxy','Automatic Proxy Configuration URL',opera.getPreference('User Prefs','Opera Directory')+'pac\\no-ads.pac');window.close()" & Delay, 10 & Close page
Item, SwitchyPAC=Disable proxy servers,,,,Menu Info & Open url in new page,"opera:config" & Delay,10 & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+usePAC}else if(allExc.indexOf(useALL)!=-1){allExc=allExc.replace(useALL,usePAC)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',1);opera.setPreference('Proxy','Automatic Proxy Configuration URL',opera.getPreference('User Prefs','Opera Directory')+'pac\\SwitchyPac.pac');window.close()" & Delay, 10 & Close page
------1
Item, "Port>[8580]"=Execute program,"optools\Proxy\fgx.exe",,,"fg" & Disable proxy servers,,,,fg & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8580';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"& delay,50 & close page
Item, "Port>[9666]"=Execute program,"optools\Proxy\u.exe",,,"wj" & Disable proxy servers,,,,wj & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:9666';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & delay,50 & close page
Item, "Port>[8087]"=Disable proxy servers,,,,goagent & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8087';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & delay,50 & close page
BreakItem
Item, "Port>[1234]"=Disable proxy servers,,,,wito & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:1234';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & Delay, 50 & Close page
Item, "Port>[1984]"=Disable proxy servers,,,,puff & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:1984';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & Delay, 50 & Close page
Item, "Port>[1998]"=Disable proxy servers,,,,wcproxy & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:1998';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & Delay, 50 & Close page
Item, "Port>[48100]"=Disable proxy servers,,,,hyk & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:48100';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & Delay, 50 & Close page
Item, "Port>[5865]"=Disable proxy servers,,,,wapp & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:5865';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & Delay, 50 & Close page
Item, "Port>[8000]"=Disable proxy servers,,,,gapp & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8000';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & Delay, 50 & Close page
Item, "Port>[8080]"=Disable proxy servers,,,,proxo & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8080';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & Delay, 50 & Close page
;Item, "Port>[8081]"=Execute program,"optools\Proxy\GTunnel.exe",,,"gtu" & Disable proxy servers,,,,gtu & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8081';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
;Item, "Port>[8082]"=Execute program,"optools\Proxy\GTunnel.exe",,,"gtu" & Disable proxy servers,,,,gtu & Open url in new page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8082';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()"
Item, "Port>[8081]"=Disable proxy servers,,,,gtu & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8081';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & Delay, 50 & Close page
Item, "Port>[8082]"=Disable proxy servers,,,,gtu & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8082';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & Delay, 50 & Close page
Item, "Port>[8086]"=Disable proxy servers,,,,wapp & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8086';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & Delay, 50 & Close page
Item, "Port>[8118]"=Disable proxy servers,,,,p & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:8118';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & Delay, 50 & Close page
Item, "Port>[9050]"=Disable proxy servers,,,,advor & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:9050';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & Delay, 50 & Close page
Item, "Port>[9051]"=Disable proxy servers,,,,tor & New private page,"opera:config" & Delay,10 & Enable proxy servers & Go to page,"javascript:var allExc=opera.getPreference('Proxy','No Proxy Servers'),usePAC='proxy_type.pac',useALL='proxy_type.all',proxy_all='127.0.0.1:9051';if(allExc.indexOf(usePAC)==-1 && allExc.indexOf(useALL)==-1){allExc+=','+useALL}else if(allExc.indexOf(usePAC)!=-1){allExc=allExc.replace(usePAC,useALL)}opera.setPreference('Proxy','No Proxy Servers',allExc);opera.setPreference('Proxy','Use Automatic Proxy Configuration',0);opera.setPreference('Proxy','FTP server',proxy_all);opera.setPreference('Proxy','Gopher server',proxy_all);opera.setPreference('Proxy','HTTP server',proxy_all);opera.setPreference('Proxy','HTTPS server',proxy_all);opera.setPreference('Proxy','WAIS server',proxy_all);window.close()" & Delay, 50 & Close page


;--------------------菜单跨版本兼容性修复补充
[11 Menu UA]
;1160版本之前
;Item, 识别为 Opera=Edit site preferences,,,,"Opera Logo" & delay,1 & Cycle to previous page & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Go to start & delay,1 & ok
;Item, 识别为 Firefox=Edit site preferences,,,,"Contact37" & delay,1 & Cycle to previous page & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Go to start & delay,1 & next item & delay,1 & ok
;Item, 识别为 IE浏览器=Edit site preferences,,,,"Trust Information" & delay,1 & Cycle to previous page & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Go to start & delay,1 & next item & delay,1 & next item & delay,1 & ok
Item, 伪装为 Firefox=Edit site preferences,,,,"firefox" & delay,1 & Cycle to previous page & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Go to end & delay,1 & Previous item & delay,1 & ok
Item, 伪装为 IE浏览器=Edit site preferences,,,,"ie" & delay,1 & Cycle to previous page & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Go to end & delay,1 & ok

[12 Menu UA]
;1160版本之后
Item, 伪装为Firefox=Edit site preferences,,,,"firefox" & delay,1 & Cycle to previous page & delay,1 & Cycle to previous page & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Go to end & delay,1 & Previous item & delay,1 & ok
Item, 伪装为IE浏览器=Edit site preferences,,,,"ie" & delay,1 & Cycle to previous page & delay,1 & Cycle to previous page & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Focus previous widget & delay,1 & Go to end & delay,1 & ok

[Any Menu PRX]
;Any版本通用
Item, "Port>[1234]" = Disable proxy servers,,,,wito & Set preference, "Proxy|HTTP server=127.0.0.1:1234" & Set preference, "Proxy|HTTPS server=127.0.0.1:1234" & Set preference, "Proxy|FTP server=127.0.0.1:1234" &Enable proxy servers
Item, "Port>[1984]" = Disable proxy servers,,,,puff & Set preference, "Proxy|HTTP server=127.0.0.1:1984" & Set preference, "Proxy|HTTPS server=127.0.0.1:1984" & Set preference, "Proxy|FTP server=127.0.0.1:1984" &Enable proxy servers
Item, "Port>[1998]" = Disable proxy servers,,,,wcproxy & Set preference, "Proxy|HTTP server=127.0.0.1:1998" & Set preference, "Proxy|HTTPS server=127.0.0.1:1998" & Set preference, "Proxy|FTP server=127.0.0.1:1998" &Enable proxy servers
Item, "Port>[48100]" = Disable proxy servers,,,,hyk & Set preference, "Proxy|HTTP server=127.0.0.1:48100" & Set preference, "Proxy|HTTPS server=127.0.0.1:48100" & Set preference, "Proxy|FTP server=127.0.0.1:48100" &Enable proxy servers
Item, "Port>[5865]" = Disable proxy servers,,,,wapp & Set preference, "Proxy|HTTP server=127.0.0.1:5865" & Set preference, "Proxy|HTTPS server=127.0.0.1:5865" & Set preference, "Proxy|FTP server=127.0.0.1:5865" &Enable proxy servers
Item, "Port>[8000]" = Disable proxy servers,,,,gapp & Set preference, "Proxy|HTTP server=127.0.0.1:8000" & Set preference, "Proxy|HTTPS server=127.0.0.1:8000" & Set preference, "Proxy|FTP server=127.0.0.1:8000" &Enable proxy servers
Item, "Port>[8080]" = Disable proxy servers,,,,proxo & Set preference, "Proxy|HTTP server=127.0.0.1:8080" & Set preference, "Proxy|HTTPS server=127.0.0.1:8080" & Set preference, "Proxy|FTP server=127.0.0.1:8080" &Enable proxy servers
Item, "Port>[8081]" = Disable proxy servers,,,,gtu & Set preference, "Proxy|HTTP server=127.0.0.1:8081" & Set preference, "Proxy|HTTPS server=127.0.0.1:8081" & Set preference, "Proxy|FTP server=127.0.0.1:8081" &Enable proxy servers
Item, "Port>[8082]" = Disable proxy servers,,,,gtu & Set preference, "Proxy|HTTP server=127.0.0.1:8082" & Set preference, "Proxy|HTTPS server=127.0.0.1:8082" & Set preference, "Proxy|FTP server=127.0.0.1:8082" &Enable proxy servers
Item, "Port>[8086]" = Disable proxy servers,,,,wapp & Set preference, "Proxy|HTTP server=127.0.0.1:8086" & Set preference, "Proxy|HTTPS server=127.0.0.1:8086" & Set preference, "Proxy|FTP server=127.0.0.1:8086" &Enable proxy servers
Item, "Port>[8118]" = Disable proxy servers,,,,p & Set preference, "Proxy|HTTP server=127.0.0.1:8118" & Set preference, "Proxy|HTTPS server=127.0.0.1:8118" & Set preference, "Proxy|FTP server=127.0.0.1:8118" &Enable proxy servers
Item, "Port>[8580]" = Disable proxy servers,,,,fg & Set preference, "Proxy|HTTP server=127.0.0.1:8580" & Set preference, "Proxy|HTTPS server=127.0.0.1:8580" & Set preference, "Proxy|FTP server=127.0.0.1:8580" &Enable proxy servers
Item, "Port>[9050]" = Disable proxy servers,,,,advor & Set preference, "Proxy|HTTP server=127.0.0.1:9050" & Set preference, "Proxy|HTTPS server=127.0.0.1:9050" & Set preference, "Proxy|FTP server=127.0.0.1:9050" &Enable proxy servers
Item, "Port>[9051]" = Disable proxy servers,,,,tor & Set preference, "Proxy|HTTP server=127.0.0.1:9051" & Set preference, "Proxy|HTTPS server=127.0.0.1:9051" & Set preference, "Proxy|FTP server=127.0.0.1:9051" &Enable proxy servers
Item, "Port>[9666]" = Disable proxy servers,,,,wj & Set preference, "Proxy|HTTP server=127.0.0.1:9666" & Set preference, "Proxy|HTTPS server=127.0.0.1:9666" & Set preference, "Proxy|FTP server=127.0.0.1:9666" &Enable proxy servers
Item, "Port>[8087]" = Disable proxy servers,,,,goagent & Set preference, "Proxy|HTTP server=127.0.0.1:8087" & Set preference, "Proxy|HTTPS server=127.0.0.1:8087" & Set preference, "Proxy|FTP server=127.0.0.1:8087" &Enable proxy servers

[12 Menu HWA]
item,开启WebGL=Set preference, "User Prefs|Enable WebGL=1" | Set preference, "User Prefs|Enable WebGL=0"
item,开启硬件加速=Set preference, "User Prefs|Enable Hardware Acceleration=1" | Set preference, "User Prefs|Enable Hardware Acceleration=0"

;--------------------其他菜单补充
[AdBlock Menu]
Item, M_BLOCK_CONTENT = External action, , , M_BLOCK_CONTENT, Edit properties | Focus address field & Go to line start & Insert, "javascript::" & Go & Focus address field & Go to line start & Range next word & Delete & Go to page, "javascript:(function(){if(!document.domain&&/^javascript::/.test(location.href)&&!frames.length){var oIFrame=document.createElement('iframe');oIFrame.style.display='none';oIFrame.src=location.href.replace('javascript::','');document.body.appendChild(oIFrame);}})()" & Delay, 100 & Content block mode on
Include, AdBlock new Menu
;Platform Windows, Item, "ADBlock+.css" =Execute program,"profile\styles\user\Adblock+.css",,,"Set label""

[AdBlock new Menu]
Item, "过滤元素"="Go to page, "javascript:navigator.ujs_adblock.block(true)", , "Block element(s)", "Delete""
Item, "编辑阻止内容"="Go to page, "javascript:navigator.ujs_adblock.edit()", , "Edit styles", "Window Mail Compose Icon""

[AdBlock old Menu]
Item, "阻止页面元素"=Go to page, "javascript:(function(){if(window.navigator.ujs_AdBlock){return}else{window.navigator.ujs_AdBlock=true};var ele='',outline='',title='',bgColor='',frameBorder='';var doc=((window.document.body instanceof HTMLFrameSetElement)?window.frames[0]:window).document;var createStyle=function(css){var s=doc.createElement('style');s.setAttribute('type','text/css');s.appendChild(doc.createTextNode(css));return doc.documentElement.appendChild(s)};var getAtt=function(ele){var r='';for(var i=0,a;a=ele.attributes[i];i++){var n=a.nodeName.toLowerCase();if(/^(id|class|height|width|color|bgcolor|align|href|src)$/.test(n))r+='['+n+'=\x22'+a.nodeValue+'\x22]'};return r};var getNth=function(ele){if(/^(html|body|iframe|img|a)$/i.test(ele.nodeName)||!window.postMessage)return'';var nth,n=0;var p=ele.parentNode;for(var i=0,c;c=p.childNodes[i];i++){if(c.nodeType==1){n++;if(c==ele)nth=n}};return(!nth||n<2)?'':':nth-child('+nth+')'};var block=function(ele){var css='';if(ele.hasAttribute('src')){css=ele.nodeName.toLowerCase()+'[src=\x22'+ele.getAttribute('src')+'\x22]'}else{var rez=[];while(ele){if(ele.nodeType==1)rez.unshift(ele.nodeName.toLowerCase()+getAtt(ele)+getNth(ele));ele=ele.parentNode};css=rez.join(' > ')};var tmp=createStyle(css+'{background-color: #FF5555 !important; outline: 1px solid #FF1111 !important; opacity: 0.7 !important;}');css=prompt('阻止这个元素?',css);if(css){createStyle(css+'{display: none !important;}');location.href='data:text/adblock;charset=UTF-8,'+encodeURIComponent(css)};tmp.parentNode.removeChild(tmp)};var remove=function(){doc.removeEventListener('mouseover',over,false);doc.removeEventListener('mouseout',out,false);doc.removeEventListener('click',click,false);doc.removeEventListener('keyup',press,false);delete window.navigator.ujs_AdBlock};var over=function(ev){ele=ev.target;outline=ele.style.outline;title=ele.title;bgColor=ele.style.backgroundColor;frameBorder=ele.frameBorder;if(frameBorder)ele.frameBorder=1;ele.style.outline='1px solid #306EFF';ele.style.backgroundColor='#C6DEFF';ele.title='Tag: '+ele.tagName+(ele.id?', ID: '+ele.id:'')+(ele.className?', Class: '+ele.className:'')};var out=function(){if(ele){ele.style.outline=outline;ele.title=title;ele.style.backgroundColor=bgColor;if(frameBorder)ele.frameBorder=frameBorder}};var click=function(ev){if(ele){ev.preventDefault();out();remove();block(ele)}};var press=function(ev){if(ev.keyCode==27){out();remove()}};doc.addEventListener('mouseover',over,false);doc.addEventListener('mouseout',out,false);doc.addEventListener('click',click,false);doc.addEventListener('keyup',press,false)})()", , , "Expand Disabled"
Item, "撤销上次阻止"=Go to page, "javascript:(function(){var styles=document.getElementsByTagName('style');var s=styles[styles.length-1];if(s&&/{display: none !important;}$/.test(s.innerHTML))s.parentNode.removeChild(s);location.href='data:text/adblock;charset=UTF-8,/unblock='+location.hostname.replace(/^www\./,'')})()",,,"Label Mail Back"
Item, "保存更改并重载"=Go to page, "javascript:location.href='data:text/adblock;charset=UTF-8,/clear'",,,"Expand Enabled" & Reload stylesheets

[eDown Link Menu]
Item,"eDown默认下载(&D)" = Execute program,"optools\edown.exe","00%l","", "Save"

[eDown All Menu]
Item,"eDown全部图片" = "Go to page, "javascript:(function(){ var i,l;var urlstr='default\n'+document.location.href+'\n'+document.cookie;var sjg=' ';var senter='\n';var simg='';try{var o=document.getElementsByTagName('IMG');for(var i=0;i<o.length;i++){if(o[i].src.length>1&&simg.indexOf(o[i].src)==-1){simg+=senter+o[i].src+senter+sjg;}}}catch(e){}try{o=document.getElementsByTagName('*');for(var i=0;i<o.length;i++){if(o[i].style&&o[i].style.background){var rule=o[i].style.background.toLowerCase();var i_start=rule.indexOf('url(');if(i_start>-1){i_start=i_start+4;var i_end=rule.indexOf(')',i_start);var i_url=((i_end>i_start)?rule.substring(i_start,i_end):'');i_url=i_url.replace(/\u0022/g,'').replace(/\u0027/g,'');if(simg.indexOf(i_url)<0&&i_url.indexOf('base64')<0&&i_url!=''){simg+=senter+i_url+senter+sjg;}}}}}catch(e){}try{o=document.getElementsByTagName('*');for(var i=0;i<o.length;i++){if(o[i].getAttribute('background')){var i_url=o[i].getAttribute('background').toLowerCase();if(simg.indexOf(i_url)<0&&i_url!=''){simg+=senter+i_url+senter+sjg;}}}}catch(e){}try{o=document.getElementsByTagName('input');for(var i=0;i<o.length;i++){if(o[i].getAttribute('type').toLowerCase()=='image'){var i_url=o[i].getAttribute('src').toLowerCase();if(simg.indexOf(i_url)<0&&i_url!=''){simg+=senter+i_url+senter+sjg;}}}}catch(e){}try{o=(document.styleSheets)?document.styleSheets:'';for(i=0;i<o.length;i++){for(j=0;j<o[i].cssRules.length;j++){var rule=o[i].cssRules[j].cssText.toLowerCase();var i_start=rule.indexOf('url(');if(i_start>-1){i_start=i_start+4;var i_end=rule.indexOf(')',i_start);var i_url=((i_end>i_start)?rule.substring(i_start,i_end):'');i_url=i_url.replace(/\u0022/g,'').replace(/\u0027/g,'');if(simg.indexOf(i_url)<0&&i_url.indexOf('base64')<0&&i_url!=''){simg+=senter+i_url+senter+sjg;}}}}}catch(e){}urlstr=urlstr+simg;var fr=document.createElement('iframe'); fr.setAttribute('id', 'tr_dummy');fr.setAttribute('frameborder', '0');fr.setAttribute('style', 'width:0px;height:0px;visibility:hidden;position:absolute;left:-999em;');fr.setAttribute('src', 'data:text/edown;charset=UTF-8,'+encodeURIComponent(urlstr));document.documentElement.appendChild(fr); var tr=document.getElementById('tr_dummy');setTimeout('tr.parentNode.removeChild(tr)',1000);})();", , "下载全部图片", "Save""
Item,"eDown全部链接(&A)" = "Go to page, "javascript:(function(){ var i,l;var urlstr='default\n'+document.location.href+'\n'+document.cookie;var dl=document.links; for(i=0;i<dl.length;i++){l=dl[i];if(l.protocol!='javascript:'&&l.protocol!='mailto:')urlstr = urlstr+'\n'+l.href+'\n'+l.innerText.replace(/\s/g,' ');} var fr=document.createElement('iframe'); fr.setAttribute('id', 'tr_dummy');fr.setAttribute('frameborder', '0');fr.setAttribute('style', 'width:0px;height:0px;visibility:hidden;position:absolute;left:-999em;');fr.setAttribute('src', 'data:text/edown;charset=UTF-8,'+encodeURIComponent(urlstr));document.documentElement.appendChild(fr); var tr=document.getElementById('tr_dummy');setTimeout('tr.parentNode.removeChild(tr)',1000);})();", , "下载全部链接", "Save""

[FSCapture]
Item, "画图"="Execute program, "mspaint.exe",,,"Attachment Images""
Item, "Screener"="Execute program, "optools\screener.exe",,,"Mail Outbox""
Item, "截图(Win7)"="Execute program, "snippingtool.exe",,,"Mail Labels""
-----------------0
Item,"捕捉活动窗口"=Execute program, "optools\FSCapture\FSCLoader.exe","Alt+PrtSc",,"FS_ActiveWindow""
Item,"捕捉窗口/对象"=Execute program, "optools\FSCapture\FSCLoader.exe","Shift+PrtSc",,"FS_Object""
Item,"捕捉矩形区域"=Execute program, "optools\FSCapture\FSCLoader.exe","Ctrl+PrtSc",,"FS_Rectangular""
Item,"捕捉手绘区域"=Execute program, "optools\FSCapture\FSCLoader.exe","Ctrl+Shift+PrtSc",,"FS_Freehand""
Item,"捕捉整个全屏"=Execute program, "optools\FSCapture\FSCLoader.exe","PrtSc",,"FS_full""
Item,"捕捉滚动窗口"=Execute program, "optools\FSCapture\FSCLoader.exe","Ctrl+Alt+PrtSc",,"FS_Scroll""
--------------------1
Item, "屏幕放大镜"="Execute program,"optools\FSCapture\FSCLoader.exe","Ctrl+Alt+F",,"FS_magnifier""
Item, "屏幕取色器"="Execute program,"optools\FSCapture\FSCLoader.exe","Ctrl+Alt+P",,"FS_eyedropper""

[Picpick]
Item, "截取矩形区域"="Execute program,"optools\picpick\picpick.exe","/cr",,"prec""
Item, "截取全屏"="Execute program,"optools\picpick\picpick.exe","/cf",,"pfull""
Item, "截取活动窗口"="Execute program,"optools\picpick\picpick.exe","/ca",,"pactive""
Item, "截取手绘区域"="Execute program,"optools\picpick\picpick.exe","/ch",,"phand""
Item, "截取固定区域"="Execute program,"optools\picpick\picpick.exe","/cx",,"pfixed""
Item, "截取控件(可滚屏)"="Execute program,"optools\picpick\picpick.exe","/cc",,"pcontrol""
--------------------1
Item, "显示取色器"="Execute program,"optools\picpick\picpick.exe","/p",,"peyedrop""
Item, "显示调色板"="Execute program,"optools\picpick\picpick.exe","/a",,"pswatch""
Item, "显示放大镜"="Execute program,"optools\picpick\picpick.exe","/m",,"pmag""
Item, "显示标尺"="Execute program,"optools\picpick\picpick.exe","/r",,"prule""
Item, "显示量角器"="Execute program,"optools\picpick\picpick.exe","/t",,"pprotractor""
Item, "显示坐标抽"="Execute program,"optools\picpick\picpick.exe","/h",,"pcoordinate""
Item, "显示自由绘画白板"="Execute program,"optools\picpick\picpick.exe","/w",,"pwb""
--------------------2
Item, "打开picpick编辑器"="Execute program,"optools\picpick\picpick.exe",,,"picpick""

[Tianya List]
Item, "只看楼主"=Go to page, "javascript:V.lookByAuthor( V.author );", 1
Item, "高亮楼主"=Go to page, "javascript:V.redByAuthor( V.author );", 1
Item, "只看某人"=Go to page, "javascript:void(f=prompt('输入查看人ID:',''));V.lookByAuthor( f );", 1
Item, "高亮某人"=Go to page, "javascript:void(f=prompt('输入查看人ID:',''));V.redByAuthor( f );", 1
Item, "返回"=Go to page, "javascript:V.lookByAuthorBack();", 1
Item, "主板脱水" = Go to page,"http://www.tianyatool.com/cgi-bin/action.pl?url=%u"
Item, "副版脱水" = Go to page,"http://www.tianyatool.com/cgi-bin/techAction.pl?url=%u"
Item, "城市脱水" = Go to page,"http://www.tianyatool.com/cgi-bin/city.pl?url=%u"

[Select download Dir Menu]
Item,"快速下载文件夹"=New page,,,,Transfer Default & Go to page,"opera:config" & Delay,5 & Go to page,"javascript:opera.setPreference('Saved Settings','Save Dir',opera.getPreference('User Prefs','Download Directory'));window.close()" & Delay,1 & Delay,200 & Click default button
---------------------1
Item,"Profile 文件夹"=New page,,,,Folder & Go to page,"opera:config" & Delay,5 & Go to page,"javascript:opera.setPreference('Saved Settings','Save Dir','{LargePrefs}');window.close()" & Delay,1 & Delay,200 & Click default button
Item,"Opera 安装文件夹"=New page,,,,Folder & Go to page,"opera:config" & Delay,5 & Go to page,"javascript:opera.setPreference('Saved Settings','Save Dir','{Resources}');window.close()" & Delay,1 & Delay,200 & Click default button
Item,"User Javascript 文件夹"=New page,,,,Folder & Go to page,"opera:config" & Delay,5 & Go to page,"javascript:opera.setPreference('Saved Settings','Save Dir',opera.getPreference('User Prefs','User JavaScript File'));window.close()" & Delay,1 & Delay,200 & Click default button
Item,"User CSS 文件夹"=New page,,,,Folder & Go to page,"opera:config" & Delay,5 & Go to page,"javascript:opera.setPreference('Saved Settings','Save Dir','{SmallPreferences}styles');window.close()" & Delay,1 & Delay,200 & Click default button
Item,"插件文件夹"=New page,,,,Folder & Go to page,"opera:config" & Delay,5 & Go to page,"javascript:opera.setPreference('Saved Settings','Save Dir','{Resources}program\\plugins');window.close()" & Delay,1 & Delay,200 & Click default button
---------------------2
Item,"C:\Downloads\"=New page,,,,Unite Folder & Go to page,"opera:config" & Delay,5 & Go to page,"javascript:opera.setPreference('Saved Settings','Save Dir','C:\\Downloads');window.close()" & Delay,1 & Delay,200 & Click default button
Item,"D:\Downloads\"=New page,,,,Unite Folder & Go to page,"opera:config" & Delay,5 & Go to page,"javascript:opera.setPreference('Saved Settings','Save Dir','D:\\Downloads');window.close()" & Delay,1 & Delay,200 & Click default button
;Above is Download Dir List

[VIM Menu]
Item, "链接导航模式(&V)"="Go to page, "javascript:(function(_HaH){var originalTitle=document.title;var hintKeys=new String('1234567890');var choices=[];var choice='';var xpath='//a[@href]|//input[not(@type=\x22hidden\x22)]|//textarea|//select|//img[@onclick]|//button';xpath+='|'+xpath.replace(/\/\//g,'//xhtml:');var defaultType='HaHxlink';function defaultAction(e){e.focus();var ev=document.createEvent('MouseEvents');ev.initEvent('click',null,null);e.dispatchEvent(ev)}var HaHElements=[{accessor:function(e){var tag=e.tagName.toLowerCase();return((tag=='a'&&/^(#|javascript:void\(0\);?)$/.test(e.href))||/^(textarea|button|select|input|img)$/.test(tag));},type:defaultType,action:defaultAction},{accessor:function(e){return e.tagName.toLowerCase()=='a'},type:'HaHlink',action:(window.opera)?defaultAction:function(e){if(e.href)location.href = e.href;}}];if(_HaH&&_HaH.types){_HaH.types.forEach(function(item){if(item.xpath)xpath+='|'+item.xpath;HaHElements.unshift({accessor:item.accessor,type:item.type||defaultType,action:item.action||defaultAction,color:item.color,})})}function addCSS(){var style=document.getElementById('HaH-style-element');var d='#HaH-div-element';var cssText=[d,'span{font-size:10pt;padding:0pt\x20 1pt;margin:0;line-height:10pt;position:absolute;z-index:2147483647;opacity:.7;color:#000;}',d,'.HaHlink{background-color:#FF0;}',d,'.HaHxlink{background-color:#0FF;}',d,'.HaHselected{background-color:#F0F;}'].join('\x20');HaHElements.forEach(function(item){if(item.color)cssText+=d+'\x20.'+item.type+'{background-color:'+item.color+';}'});if(style){if(style.innerHTML!=cssText)style.innerHTML=cssText;}else{style=document.createElement('style');style.type='text/css';style.id='HaH-style-element';style.innerHTML=cssText;document.getElementsByTagName('head')[0].appendChild(style);}}hints=[];var df=document.createDocumentFragment();function castHint(_ele,_x,_y){for(var i=0;i<HaHElements.length;i++){if(HaHElements[i].accessor(_ele)){var _type=HaHElements[i].type;var _action=HaHElements[i].action;break;}}if(!_type)return;if(!hints.length)addCSS();var _text=createText(hints.length);var hint={element:_ele,type:_type,action:_action,text:_text,x:_x,y:_y};hint.hintNode=addHintNode(hint);hints[hints.length]=hint;}function addHintNode(hint){var span=document.createElement('span');span.className=hint.type;span.style.left=Math.max(0,hint.x-8)+'px';span.style.top=Math.max(0,hint.y-8)+'px';span.innerHTML=hint.text;df.appendChild(span);return span;}function getHintByText(txt){return hints[retrieveNumber(txt)];}function retrieveNumber(text){text+='';var num=0;for(var i=0,l=text.length;i<l;i++){var fix=(i==0)?0:1;var t=text.charAt(l-i-1);num+=(hintKeys.indexOf(t)+fix)*Math.pow(hintKeys.length,i);}return num;}function createText(num){var text='';var l=hintKeys.length;var iter=0;while(num>=0){var n=num;num-=Math.pow(l,1+iter++);}for(var i=0;i<iter;i++){r=n%l;n=Math.floor(n/l);text=hintKeys.charAt(r)+text;}return text;}function rectFixForOpera(e,s){if(!window.opera||e.tagName.toLowerCase()!='a'||s.cssFloat!='none')return null;var c=e.firstChild;var cIsAfterWhiteSpace=true;while(cIsAfterWhiteSpace){if(!c)return{left:0,right:0};cIsAfterWhiteSpace=(c.nodeName.toLowerCase()=='br'||c.nodeType==8||c.nodeType==3&&!/\S/.test(c.nodeValue));if(c instanceof HTMLImageElement||c.tagName&&c.tagName.toLowerCase()!='br'&&getComputedStyle(c,null).display=='block')return c.getBoundingClientRect();c=c.nextSibling;}return null;}function getAbsolutePosition(elem){var style=getComputedStyle(elem,null);var rect=rectFixForOpera(elem,style)||elem.getClientRects()[0];if(rect&&rect.right-rect.left&&style.visibility!='hidden'&&style.opacity!=0&&rect.left>=0&&rect.top>=-5&&rect.bottom<=window.innerHeight+5&&rect.right<=window.innerWidth){var html=document.documentElement;var body=document.body;return{top:(body.scrollTop||html.scrollTop)-html.clientTop+rect.top,left:(body.scrollLeft||html.scrollLeft)-html.clientLeft+rect.left}}return false;}function drawHints(){var div=document.getElementById('HaH-div-element');if(div)div.innerHTML='';function resolv(p){if(p=='xhtml')return'http://www.w3.org/1999/xhtml';}var result=document.evaluate(xpath,document,resolv,7,null);for(var i=0,l=result.snapshotLength;i<l;i++){var ele=result.snapshotItem(i);var pos=getAbsolutePosition(ele);if(!pos)continue;castHint(ele,pos.left,pos.top);}if(!hints.length)return;if(!div){div=document.createElement('div');div.id='HaH-div-element';}div.appendChild(df);document.body.appendChild(div);document.addEventListener('keypress',interpretHaHKeyStroke,true);document.title+='\x20-\x20';}function removeHints(){document.title=originalTitle;if(interpretHaHKeyStroke){document.removeEventListener('keypress',interpretHaHKeyStroke,true);}document.body.removeChild(document.getElementById('HaH-div-element'));delete hints,df,choices;}var baseFuncs={doNothing:function(){},pushChoice:function(mod){if(mod)return removeHints;if(choice!=''){choices.push(choice);getHintByText(choice).hintNode.className='HaHselected';choice='';document.title+=' ';}},popChoice:function(mod){if(mod)return removeHints;if(choice!=''){choice='';}else{if(choices.length){var lastchoice=getHintByText(choices.pop());lastchoice.hintNode.className=lastchoice.type;}}document.title=originalTitle+'\x20-\x20'+choices.join(' ');},pushLetter:function(mod,key){if(mod)return removeHints();choice+='';if(getHintByText(choice+key)){choice+=key;var lastHint=''+hints[hints.length-1].text;if(choice.length==lastHint.length||choice.length==lastHint.length-1&&retrieveNumber(choice)>retrieveNumber(lastHint.substr(0,choice.length))){getHintByText(choice).hintNode.className='HaHselected';choices.push(choice);choice='';document.title+=' ';}}var choicestring=(choices.length)?choices.join(' ')+' '+choice:choice;document.title=originalTitle+'\x20-\x20'+choicestring;}};var keyMap={'8':'Bkspc','32':'Space','16':'Shift','17':'Ctrl','18':'Alt'};var keyFuncMap={'Bkspc':baseFuncs.popChoice,'Space':baseFuncs.pushChoice,};hintKeys.split('').forEach(function(l){keyMap[l.charCodeAt(0)]=l});hintKeys.split('').forEach(function(k){keyFuncMap[k]=baseFuncs.pushLetter;});['Shift','Ctrl','Alt'].forEach(function(k){keyFuncMap[k]=baseFuncs.doNothing;});function defaultFuncTemplate(func){return function(mod){if(choice)choices.push(choice);var ary=[];choices.forEach(function(c,i){var hint=getHintByText(c);if(hint&&choices.indexOf(c)==i)ary.push(hint);});func(mod,ary);removeHints();}}function addExtraFunc(func,keyName,keyCode){keyMap[(keyCode||keyName.charCodeAt(0))]=keyName;keyFuncMap[keyName]=defaultFuncTemplate(func);}addExtraFunc(function(mod,ary){var windowname=(ary.length==1&&!mod)?'_top':'_blank';ary.forEach(function(e){if(e.type=='HaHlink'){var timer = null;timer = setInterval(open_ext, 100);function open_ext(){clearInterval(timer);window.open(e.element,windowname)}}});},'Enter',13);addExtraFunc(function(mod,ary){if(mod)return;var firstHint=ary[0];if(firstHint)firstHint.action(firstHint.element);},';',59);if(_HaH&&_HaH.keys){_HaH.keys.forEach(function(e){addExtraFunc(e.func,e.keyName,e.keyCode)});}function interpretHaHKeyStroke(e){var key=keyMap[(e.keyCode||e.which)];e.preventDefault();e.stopPropagation();if(!key)return removeHints();var modified=(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey);keyFuncMap[key](modified,key)&&removeHints();}drawHints();})(window.HitaHint);",1,"Navigation","none""
;回车：在本页打开；shift+回车：在新标签打开；ctrl+shift+回车：在新标签后台打开；空格：多选；退格：删除；ESC：退出；分号（;）：点击。
Item, "上一页(&Z)"=go to page, "javascript:superPrefetcher.back();",,,"none"
Item, "下一页(&X)"=go to page, "javascript:superPrefetcher.go();",,,"none"
Item, "在新标签打开(&G)"=External action,,,,"none" | Go to Page,"%t" & Go to Page, "javascript:void(inivar='%c')" & Go to Page, "javascript:void(inivar2='%t')" & Go to page, "javascript:(function(){var d=window.inivar;if(!d){d='http://www.google.com'};var getText=function(w){var u=w.document,v=u.getSelection(),t=u.querySelectorAll('textarea,input');if(!v)for(var i=0,e;e=t[i];i++){if(v=e.value.substring(e.selectionStart,e.selectionEnd))break}return v};var getSel=function(w){var rez=w?getText(w):'';if(rez==''){for(var i=0,f;f=w.frames[i];i++){try{if(rez=arguments.callee(f))break}catch(e){}}};return rez};var w=window;var q=getSel(w)||window.inivar2;if((q||d).match(/(http|ftp)s?:\/\/[\w]+(\.[\w]+)+([\w\-\.,@?^=%&:/~\+#]*[\w\-\@?^=%&/~\+#])?|^opera:.+/i)){var ql=q;var dl=d}else{var dt='http://www.google.com/search?q='+encodeURIComponent(q||d).replace(/ /g,'+')};if(location.hostname!=''){if(!q){if(dl){window.open(dl)}else{window.open(dt)}}else{if(document.getSelection()){return;}else{if(ql){window.open(ql)}else{window.open(dt)}}}}else{if(dl){location.href=dl}else{location.href=dt;}}})()"
Item, "在新标签后台打开(&B)"=External action,,,,"none" | Go to Page, "javascript:void(inivar='%c')" & Go to Page, "javascript:void(inivar2='%t')" & Go to page, "javascript:(function(){var d=window.inivar;if(!d){d='http://www.baidu.com'};var getText=function(w){var u=w.document,v=u.getSelection(),t=u.querySelectorAll('textarea,input');if(!v)for(var i=0,e;e=t[i];i++){if(v=e.value.substring(e.selectionStart,e.selectionEnd))break}return v};var getSel=function(w){var rez=w?getText(w):'';if(rez==''){for(var i=0,f;f=w.frames[i];i++){try{if(rez=arguments.callee(f))break}catch(e){}}};return rez};var w=window;var q=getSel(w)||window.inivar2;if((q||d).match(/(http|ftp)s?:\/\/[\w]+(\.[\w]+)+([\w\-\.,@?^=%&:/~\+#]*[\w\-\@?^=%&/~\+#])?|^opera:.+/i)){var ql=q;var dl=d}else{var dt='http://www.baidu.com/s?wd='+encodeURIComponent(q||d).replace(/ /g,'+')+'&ie=utf-8'};if(location.hostname!=''){if(!q){if(dl){window.open(dl).blur()}else{window.open(dt)}}else{if(ql){window.open(ql).blur()}else{window.open(dt).blur()}}}else{if(dl){location.href=dl}else{location.href=dt;}}})()"
--------------------------1
Item, "快速保存链接(&S)"=External action,,,,"none" | Copy & Manage, "transfers" & delay,1 & delay,100 & Focus address field & Paste and go & Close clicked page & Minimize page
Item, "打开限定的链接(&L)"=External action,,,,"none" | Copy & delay,1 & Manage links & delay,1 & paste & delay,1 & Focus next widget & delay,1 & Focus next widget & delay,1 & Range go to end & delay,1 & cancel & Open link in background page
Item, "关闭右侧标签(&R)"=External action,,,,"none" | Open URL in new page, "opera:blank_" & delay,1 & delay,100 & Switch to previous page & delay,1 & delay,100 & Manage, "windows" & delay,1 & delay,100 & Insert,"opera:blank_" & delay,1 & delay,100 & go & delay,1 & delay,100 & clear & delay,1 & delay,100 & Focus next widget & delay,1 & delay,100 & previous item & delay,1 & delay,100 & Range go to end & delay,1 & delay,100 & close page
Item, "关闭其他标签及窗口(&Q)"=External action,,,,"none" | Duplicate page & delay,1 & Detach page & delay,1 & manage,"windows" & delay,1 & Focus next widget & delay,1 & close all items & delay,1 & Range go to end & delay,1 & Range Previous item & delay,1 & Close window & delay,1 & delay,100 & Switch to previous page & close other & delay,1 & Detach page
--------------------------2
Item, "转到上级目录(&C)"=Go to parent directory
Item, "克隆标签(&N)"=Duplicate page
Item, "独立为窗口(&D)"=Detach page
Item, "标签全部最大化(&M)"		= Maximize all
Item, "标签垂直平铺(&T)"		= Tile vertically
Item, "标签水平平铺(&I)"		= Tile horizontally
Item, "框架最大化(&F)"=Maximize frame
;W
;A
;Y
;H
;U
;J
;K
;O
;P